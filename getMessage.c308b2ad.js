parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"QTcd":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];!function(t){"use strict";var r,e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",u="object"==typeof module,h=t.regeneratorRuntime;if(h)u&&(module.exports=h);else{(h=t.regeneratorRuntime=u?module.exports:{}).wrap=w;var f="suspendedStart",s="suspendedYield",l="executing",p="completed",y={},v={};v[i]=function(){return this};var d=Object.getPrototypeOf,g=d&&d(d(P([])));g&&g!==e&&n.call(g,i)&&(v=g);var m=b.prototype=x.prototype=Object.create(v);E.prototype=m.constructor=b,b.constructor=E,b[c]=E.displayName="GeneratorFunction",h.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===E||"GeneratorFunction"===(r.displayName||r.name))},h.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(m),t},h.awrap=function(t){return{__await:t}},_(j.prototype),j.prototype[a]=function(){return this},h.AsyncIterator=j,h.async=function(t,r,e,n){var o=new j(w(t,r,e,n));return h.isGeneratorFunction(r)?o:o.next().then(function(t){return t.done?t.value:o.next()})},_(m),m[c]="Generator",m[i]=function(){return this},m.toString=function(){return"[object Generator]"},h.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},h.values=P,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(G),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return c.type="throw",c.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),h=n.call(a,"finallyLoc");if(u&&h){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),y},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),G(e),y}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;G(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),y}}}function w(t,r,e,n){var o=r&&r.prototype instanceof x?r:x,i=Object.create(o.prototype),a=new N(n||[]);return i._invoke=function(t,r,e){var n=f;return function(o,i){if(n===l)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return F()}for(e.method=o,e.arg=i;;){var a=e.delegate;if(a){var c=O(a,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(n===f)throw n=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);n=l;var u=L(t,r,e);if("normal"===u.type){if(n=e.done?p:s,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(n=p,e.method="throw",e.arg=u.arg)}}}(t,e,a),i}function L(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}function x(){}function E(){}function b(){}function _(t){["next","throw","return"].forEach(function(r){t[r]=function(t){return this._invoke(r,t)}})}function j(t){var r;this._invoke=function(e,o){function i(){return new Promise(function(r,i){!function r(e,o,i,a){var c=L(t[e],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?Promise.resolve(h.__await).then(function(t){r("next",t,i,a)},function(t){r("throw",t,i,a)}):Promise.resolve(h).then(function(t){u.value=t,i(u)},function(t){return r("throw",t,i,a)})}a(c.arg)}(e,o,r,i)})}return r=r?r.then(i,i):i()}}function O(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,O(t,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=L(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function k(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function G(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}return{next:F}}function F(){return{value:r,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")());
},{}],"jsKO":[function(require,module,exports) {
var e=function(){return this||"object"==typeof self&&self}()||Function("return this")(),r=e.regeneratorRuntime&&Object.getOwnPropertyNames(e).indexOf("regeneratorRuntime")>=0,t=r&&e.regeneratorRuntime;if(e.regeneratorRuntime=void 0,module.exports=require("./runtime"),r)e.regeneratorRuntime=t;else try{delete e.regeneratorRuntime}catch(n){e.regeneratorRuntime=void 0}
},{"./runtime":"QTcd"}],"8m4e":[function(require,module,exports) {
module.exports=require("regenerator-runtime");
},{"regenerator-runtime":"jsKO"}],"xwXl":[function(require,module,exports) {
function e(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}module.exports=e;
},{}],"HEvq":[function(require,module,exports) {
var e=require("./defineProperty");function r(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){e(r,t,n[t])})}return r}module.exports=r;
},{"./defineProperty":"xwXl"}],"2fws":[function(require,module,exports) {
function n(n,t,o,r,e,i,u){try{var c=n[i](u),v=c.value}catch(a){return void o(a)}c.done?t(v):Promise.resolve(v).then(r,e)}function t(t){return function(){var o=this,r=arguments;return new Promise(function(e,i){var u=t.apply(o,r);function c(t){n(u,e,i,c,v,"next",t)}function v(t){n(u,e,i,c,v,"throw",t)}c(void 0)})}}module.exports=t;
},{}],"uOR/":[function(require,module,exports) {
"use strict";function r(r){return function(){var t=arguments.length;if(t){for(var n=[],e=-1;++e<t;)n[e]=arguments[e];return r.call(this,n)}return r.call(this,[])}}module.exports=r;
},{}],"EK2n":[function(require,module,exports) {
var global = arguments[3];
var e,t,n=arguments[3],a=n.MutationObserver||n.WebKitMutationObserver;if(a){var o=0,r=new a(u),s=n.document.createTextNode("");r.observe(s,{characterData:!0}),e=function(){s.data=o=++o%2}}else if(n.setImmediate||void 0===n.MessageChannel)e="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var e=n.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},n.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new n.MessageChannel;c.port1.onmessage=u,e=function(){c.port2.postMessage(0)}}var i=[];function u(){var e,n;t=!0;for(var a=i.length;a;){for(n=i,i=[],e=-1;++e<a;)n[e]();a=i.length}t=!1}function d(n){1!==i.push(n)||t||e()}module.exports=d;
},{}],"wIHY":[function(require,module,exports) {
function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function t(e){return"function"==typeof e}function s(e){return"number"==typeof e}function n(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}module.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},e.prototype.emit=function(e){var s,r,o,h,v,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if((s=arguments[1])instanceof Error)throw s;var u=new Error('Uncaught, unspecified "error" event. ('+s+")");throw u.context=s,u}if(i(r=this._events[e]))return!1;if(t(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),r.apply(this,h)}else if(n(r))for(h=Array.prototype.slice.call(arguments,1),o=(l=r.slice()).length,v=0;v<o;v++)l[v].apply(this,h);return!0},e.prototype.addListener=function(s,r){var o;if(!t(r))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,t(r.listener)?r.listener:r),this._events[s]?n(this._events[s])?this._events[s].push(r):this._events[s]=[this._events[s],r]:this._events[s]=r,n(this._events[s])&&!this._events[s].warned&&(o=i(this._maxListeners)?e.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[s].length>o&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),"function"==typeof console.trace&&console.trace()),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(e,s){if(!t(s))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,s.apply(this,arguments))}return i.listener=s,this.on(e,i),this},e.prototype.removeListener=function(e,s){var i,r,o,h;if(!t(s))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(i=this._events[e]).length,r=-1,i===s||t(i.listener)&&i.listener===s)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,s);else if(n(i)){for(h=o;h-- >0;)if(i[h]===s||i[h].listener&&i[h].listener===s){r=h;break}if(r<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,s)}return this},e.prototype.removeAllListeners=function(e){var s,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(s in this._events)"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events={},this}if(t(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},e.prototype.listeners=function(e){return this._events&&this._events[e]?t(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.prototype.listenerCount=function(e){if(this._events){var s=this._events[e];if(t(s))return 1;if(s)return s.length}return 0},e.listenerCount=function(e,t){return e.listenerCount(t)};
},{}],"oxw+":[function(require,module,exports) {
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};
},{}],"AoQO":[function(require,module,exports) {
var define;
var t;!function(r){if("object"==typeof exports)module.exports=r();else if("function"==typeof t&&t.amd)t(r);else{var e;try{e=window}catch(n){e=self}e.SparkMD5=r()}}(function(t){"use strict";var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,r){var e=t[0],n=t[1],f=t[2],i=t[3];n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[0]-680876936|0)<<7|e>>>25)+n|0)&n|~e&f)+r[1]-389564586|0)<<12|i>>>20)+e|0)&e|~i&n)+r[2]+606105819|0)<<17|f>>>15)+i|0)&i|~f&e)+r[3]-1044525330|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[4]-176418897|0)<<7|e>>>25)+n|0)&n|~e&f)+r[5]+1200080426|0)<<12|i>>>20)+e|0)&e|~i&n)+r[6]-1473231341|0)<<17|f>>>15)+i|0)&i|~f&e)+r[7]-45705983|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[8]+1770035416|0)<<7|e>>>25)+n|0)&n|~e&f)+r[9]-1958414417|0)<<12|i>>>20)+e|0)&e|~i&n)+r[10]-42063|0)<<17|f>>>15)+i|0)&i|~f&e)+r[11]-1990404162|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[12]+1804603682|0)<<7|e>>>25)+n|0)&n|~e&f)+r[13]-40341101|0)<<12|i>>>20)+e|0)&e|~i&n)+r[14]-1502002290|0)<<17|f>>>15)+i|0)&i|~f&e)+r[15]+1236535329|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[1]-165796510|0)<<5|e>>>27)+n|0)&f|n&~f)+r[6]-1069501632|0)<<9|i>>>23)+e|0)&n|e&~n)+r[11]+643717713|0)<<14|f>>>18)+i|0)&e|i&~e)+r[0]-373897302|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[5]-701558691|0)<<5|e>>>27)+n|0)&f|n&~f)+r[10]+38016083|0)<<9|i>>>23)+e|0)&n|e&~n)+r[15]-660478335|0)<<14|f>>>18)+i|0)&e|i&~e)+r[4]-405537848|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[9]+568446438|0)<<5|e>>>27)+n|0)&f|n&~f)+r[14]-1019803690|0)<<9|i>>>23)+e|0)&n|e&~n)+r[3]-187363961|0)<<14|f>>>18)+i|0)&e|i&~e)+r[8]+1163531501|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[13]-1444681467|0)<<5|e>>>27)+n|0)&f|n&~f)+r[2]-51403784|0)<<9|i>>>23)+e|0)&n|e&~n)+r[7]+1735328473|0)<<14|f>>>18)+i|0)&e|i&~e)+r[12]-1926607734|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[5]-378558|0)<<4|e>>>28)+n|0)^n^f)+r[8]-2022574463|0)<<11|i>>>21)+e|0)^e^n)+r[11]+1839030562|0)<<16|f>>>16)+i|0)^i^e)+r[14]-35309556|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[1]-1530992060|0)<<4|e>>>28)+n|0)^n^f)+r[4]+1272893353|0)<<11|i>>>21)+e|0)^e^n)+r[7]-155497632|0)<<16|f>>>16)+i|0)^i^e)+r[10]-1094730640|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[13]+681279174|0)<<4|e>>>28)+n|0)^n^f)+r[0]-358537222|0)<<11|i>>>21)+e|0)^e^n)+r[3]-722521979|0)<<16|f>>>16)+i|0)^i^e)+r[6]+76029189|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[9]-640364487|0)<<4|e>>>28)+n|0)^n^f)+r[12]-421815835|0)<<11|i>>>21)+e|0)^e^n)+r[15]+530742520|0)<<16|f>>>16)+i|0)^i^e)+r[2]-995338651|0)<<23|n>>>9)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[0]-198630844|0)<<6|e>>>26)+n|0)|~f))+r[7]+1126891415|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[14]-1416354905|0)<<15|f>>>17)+i|0)|~e))+r[5]-57434055|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[12]+1700485571|0)<<6|e>>>26)+n|0)|~f))+r[3]-1894986606|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[10]-1051523|0)<<15|f>>>17)+i|0)|~e))+r[1]-2054922799|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[8]+1873313359|0)<<6|e>>>26)+n|0)|~f))+r[15]-30611744|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[6]-1560198380|0)<<15|f>>>17)+i|0)|~e))+r[13]+1309151649|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[4]-145523070|0)<<6|e>>>26)+n|0)|~f))+r[11]-1120210379|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[2]+718787259|0)<<15|f>>>17)+i|0)|~e))+r[9]-343485551|0)<<21|n>>>11)+f|0,t[0]=e+t[0]|0,t[1]=n+t[1]|0,t[2]=f+t[2]|0,t[3]=i+t[3]|0}function n(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}function f(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return e}function i(t){var r,f,i,h,o,s,a=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=a;r+=64)e(u,n(t.substring(r-64,r)));for(f=(t=t.substring(r-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<f;r+=1)i[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*a).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),s=parseInt(h[1],16)||0,i[14]=o,i[15]=s,e(u,i),u}function h(t){var e,n="";for(e=0;e<4;e+=1)n+=r[t>>8*e+4&15]+r[t>>8*e&15];return n}function o(t){var r;for(r=0;r<t.length;r+=1)t[r]=h(t[r]);return t.join("")}function s(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function a(t){var r,e=[],n=t.length;for(r=0;r<n-1;r+=2)e.push(parseInt(t.substr(r,2),16));return String.fromCharCode.apply(String,e)}function u(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==o(i("hello"))&&function(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function r(t,r){return(t=0|t||0)<0?Math.max(t+r,0):Math.min(t,r)}ArrayBuffer.prototype.slice=function(e,n){var f,i,h,o,s=this.byteLength,a=r(e,s),u=s;return n!==t&&(u=r(n,s)),a>u?new ArrayBuffer(0):(f=u-a,i=new ArrayBuffer(f),h=new Uint8Array(i),o=new Uint8Array(this,a,f),h.set(o),i)}}(),u.prototype.append=function(t){return this.appendBinary(s(t)),this},u.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,f=this._buff.length;for(r=64;r<=f;r+=64)e(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},u.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n.charCodeAt(r)<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=a(e)),this.reset(),e},u.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},u.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},u.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},u.prototype._finish=function(t,r){var n,f,i,h=r;if(t[h>>2]|=128<<(h%4<<3),h>55)for(e(this._hash,t),h=0;h<16;h+=1)t[h]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(n[2],16),i=parseInt(n[1],16)||0,t[14]=f,t[15]=i,e(this._hash,t)},u.hash=function(t,r){return u.hashBinary(s(t),r)},u.hashBinary=function(t,r){var e=o(i(t));return r?a(e):e},u.ArrayBuffer=function(){this.reset()},u.ArrayBuffer.prototype.append=function(t){var r,n,i,h,o,s=(n=this._buff.buffer,i=t,h=!0,(o=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n)),o.set(new Uint8Array(i),n.byteLength),h?o:o.buffer),a=s.length;for(this._length+=t.byteLength,r=64;r<=a;r+=64)e(this._hash,f(s.subarray(r-64,r)));return this._buff=r-64<a?new Uint8Array(s.buffer.slice(r-64)):new Uint8Array(0),this},u.ArrayBuffer.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n[r]<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=a(e)),this.reset(),e},u.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.ArrayBuffer.prototype.getState=function(){var t,r=u.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},u.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var e,n=t.length,f=new ArrayBuffer(n),i=new Uint8Array(f);for(e=0;e<n;e+=1)i[e]=t.charCodeAt(e);return r?i:f}(t.buff,!0),u.prototype.setState.call(this,t)},u.ArrayBuffer.prototype.destroy=u.prototype.destroy,u.ArrayBuffer.prototype._finish=u.prototype._finish,u.ArrayBuffer.hash=function(t,r){var n=o(function(t){var r,n,i,h,o,s,a=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=a;r+=64)e(u,f(t.subarray(r-64,r)));for(n=(t=r-64<a?t.subarray(r-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)i[r>>2]|=t[r]<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*a).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),s=parseInt(h[1],16)||0,i[14]=o,i[15]=s,e(u,i),u}(new Uint8Array(t)));return r?a(n):n},u});
},{}],"Ukxk":[function(require,module,exports) {
var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var e=new Uint8Array(16);module.exports=function(){return r(e),e}}else{var n=new Array(16);module.exports=function(){for(var r,e=0;e<16;e++)0==(3&e)&&(r=4294967296*Math.random()),n[e]=r>>>((3&e)<<3)&255;return n}}
},{}],"Dtnm":[function(require,module,exports) {
for(var r=[],t=0;t<256;++t)r[t]=(t+256).toString(16).substr(1);function o(t,o){var n=o||0,u=r;return u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+"-"+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]+u[t[n++]]}module.exports=o;
},{}],"PP0B":[function(require,module,exports) {
var e,r,o=require("./lib/rng"),s=require("./lib/bytesToUuid"),i=0,n=0;function c(c,l,u){var v=l&&u||0,a=l||[],d=(c=c||{}).node||e,t=void 0!==c.clockseq?c.clockseq:r;if(null==d||null==t){var m=o();null==d&&(d=e=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==t&&(t=r=16383&(m[6]<<8|m[7]))}var q=void 0!==c.msecs?c.msecs:(new Date).getTime(),f=void 0!==c.nsecs?c.nsecs:n+1,b=q-i+(f-n)/1e4;if(b<0&&void 0===c.clockseq&&(t=t+1&16383),(b<0||q>i)&&void 0===c.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=q,n=f,r=t;var k=(1e4*(268435455&(q+=122192928e5))+f)%4294967296;a[v++]=k>>>24&255,a[v++]=k>>>16&255,a[v++]=k>>>8&255,a[v++]=255&k;var w=q/4294967296*1e4&268435455;a[v++]=w>>>8&255,a[v++]=255&w,a[v++]=w>>>24&15|16,a[v++]=w>>>16&255,a[v++]=t>>>8|128,a[v++]=255&t;for(var g=0;g<6;++g)a[v+g]=d[g];return l||s(a)}module.exports=c;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"/TkF":[function(require,module,exports) {
var r=require("./lib/rng"),n=require("./lib/bytesToUuid");function e(e,i,u){var a=i&&u||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,i)for(var o=0;o<16;++o)i[a+o]=l[o];return i||n(l)}module.exports=e;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"kXoK":[function(require,module,exports) {
var e=require("./v1"),r=require("./v4"),v=r;v.v1=e,v.v4=r,module.exports=v;
},{"./v1":"PP0B","./v4":"/TkF"}],"9d90":[function(require,module,exports) {
"use strict";function e(e,s,a){var r=a[a.length-1];e===r.element&&(a.pop(),r=a[a.length-1]);var n=r.element,t=r.index;if(Array.isArray(n))n.push(e);else if(t===s.length-2){n[s.pop()]=e}else s.push(e)}exports.stringify=function(e){var s=[];s.push({obj:e});for(var a,r,n,t,l,p,i,o,c,f,u="";a=s.pop();)if(r=a.obj,u+=a.prefix||"",n=a.val||"")u+=n;else if("object"!=typeof r)u+=void 0===r?null:JSON.stringify(r);else if(null===r)u+="null";else if(Array.isArray(r)){for(s.push({val:"]"}),t=r.length-1;t>=0;t--)l=0===t?"":",",s.push({obj:r[t],prefix:l});s.push({val:"["})}else{for(i in p=[],r)r.hasOwnProperty(i)&&p.push(i);for(s.push({val:"}"}),t=p.length-1;t>=0;t--)c=r[o=p[t]],f=t>0?",":"",f+=JSON.stringify(o)+":",s.push({obj:c,prefix:f});s.push({val:"{"})}return u},exports.parse=function(s){for(var a,r,n,t,l,p,i,o,c,f=[],u=[],h=0;;)if("}"!==(a=s[h++])&&"]"!==a&&void 0!==a)switch(a){case" ":case"\t":case"\n":case":":case",":break;case"n":h+=3,e(null,f,u);break;case"t":h+=3,e(!0,f,u);break;case"f":h+=4,e(!1,f,u);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(r="",h--;;){if(n=s[h++],!/[\d\.\-e\+]/.test(n)){h--;break}r+=n}e(parseFloat(r),f,u);break;case'"':for(t="",l=void 0,p=0;'"'!==(i=s[h++])||"\\"===l&&p%2==1;)t+=i,"\\"===(l=i)?p++:p=0;e(JSON.parse('"'+t+'"'),f,u);break;case"[":o={element:[],index:f.length},f.push(o.element),u.push(o);break;case"{":c={element:{},index:f.length},f.push(c.element),u.push(c);break;default:throw new Error("unexpectedly reached end of input: "+a)}else{if(1===f.length)return f.pop();e(f.pop(),f,u)}};
},{}],"g5I+":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"v5fJ":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var e=arguments[3],t=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=u(require("argsarray")),r=u(require("immediate")),i=require("events"),o=u(require("inherits")),a=u(require("spark-md5")),s=u(require("uuid")),c=u(require("vuvuzela"));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function l(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function d(e){if(e instanceof ArrayBuffer)return l(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}var h,p,v=Function.prototype.toString,_=v.call(Object);function g(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&v.call(n)==_}function y(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=y(e[n]);return t}if(e instanceof Date)return e.toISOString();if(f(e))return d(e);if(!g(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var i=y(e[n]);void 0!==i&&(t[n]=i)}return t}function m(e){var t=!1;return(0,n.default)(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function b(e){return(0,n.default)(function(t){t=y(t);var n=this,r="function"==typeof t[t.length-1]&&t.pop(),i=new Promise(function(r,i){var o;try{var a=m(function(e,t){e?i(e):r(t)});t.push(a),(o=e.apply(n,t))&&"function"==typeof o.then&&r(o)}catch(s){i(s)}});return r&&i.then(function(e){r(null,e)},r),i})}function w(e,t,n){if(e.constructor.listeners("debug").length){for(var r=["api",e.name,t],i=0;i<n.length-1;i++)r.push(n[i]);e.constructor.emit("debug",r);var o=n[n.length-1];n[n.length-1]=function(n,r){var i=["api",e.name,t];i=i.concat(n?["error",n]:["success",r]),e.constructor.emit("debug",i),o(n,r)}}}function k(e,t){return b((0,n.default)(function(n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return w(r,e,n),this.taskqueue.isReady?t.apply(this,n):new Promise(function(t,i){r.taskqueue.addTask(function(o){o?i(o):t(r[e].apply(r,n))})})}))}function q(e){return"$"+e}function j(e){return e.substring(1)}function O(){this._store={}}function S(e){if(this._store=new O,e&&Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.add(e[t])}function E(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}function A(e,t){for(var n={},r=0,i=t.length;r<i;r++){var o=t[r];o in e&&(n[o]=e[o])}return n}O.prototype.get=function(e){var t=q(e);return this._store[t]},O.prototype.set=function(e,t){var n=q(e);return this._store[n]=t,!0},O.prototype.has=function(e){return q(e)in this._store},O.prototype.delete=function(e){var t=q(e),n=t in this._store;return delete this._store[t],n},O.prototype.forEach=function(e){for(var t=Object.keys(this._store),n=0,r=t.length;n<r;n++){var i=t[n];e(this._store[i],i=j(i))}},Object.defineProperty(O.prototype,"size",{get:function(){return Object.keys(this._store).length}}),S.prototype.add=function(e){return this._store.set(e,!0)},S.prototype.has=function(e){return this._store.has(e)},S.prototype.forEach=function(e){this._store.forEach(function(t,n){e(n)})},Object.defineProperty(S.prototype,"size",{get:function(){return this._store.size}}),E()?(h=Set,p=Map):(h=S,p=O);var x,P,C=6;function $(e){return e}function D(e){return[{ok:e}]}function I(e,t,n){var r=t.docs,i=new p;r.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var o=i.size,a=0,s=new Array(o);function c(){var e;++a===o&&(e=[],s.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e}))}var u=[];i.forEach(function(e,t){u.push(t)});var f=0;function l(){if(!(f>=u.length)){var n=Math.min(f+C,u.length),r=u.slice(f,n);!function(n,r){n.forEach(function(n,o){var a=r+o,u=i.get(n),f=A(u[0],["atts_since","attachments"]);f.open_revs=u.map(function(e){return e.rev}),f.open_revs=f.open_revs.filter($);var d=$;0===f.open_revs.length&&(delete f.open_revs,d=D),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in t&&(f[e]=t[e])}),e.get(n,f,function(e,t){var r,i,o;r=e?[{error:e}]:d(t),i=n,o=r,s[a]={id:i,docs:o},c(),l()})})}(r,f),f+=r.length}}l()}try{localStorage.setItem("_pouch_check_localstorage",1),x=!!localStorage.getItem("_pouch_check_localstorage")}catch(go){x=!1}function L(){return x}function B(e){L()&&addEventListener("storage",function(t){e.emit(t.key)})}function R(){i.EventEmitter.call(this),this._listeners={},B(this)}function T(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function N(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function M(e){var t=0;return e||(t=2e3),N(e,t)}function K(e,t){T("info","The above "+e+" is totally normal. "+t)}(0,o.default)(R,i.EventEmitter),R.prototype.addListener=function(e,t,n,i){if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=s,this.on(e,s)}function s(){if(o._listeners[t])if(a)a="waiting";else{a=!0;var e=A(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>i.since&&!i.cancelled&&(i.since=e.seq,i.onChange(e))}).on("complete",function(){"waiting"===a&&(0,r.default)(s),a=!1}).on("error",function(){a=!1})}}},R.prototype.removeListener=function(e,t){t in this._listeners&&(i.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},R.prototype.notifyLocalWindows=function(e){L()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},R.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var J=P="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};function z(e,t,n){Error.call(this,n),this.status=e,this.name=t,this.message=n,this.error=!0}(0,o.default)(z,Error),z.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var F=new z(401,"unauthorized","Name or password is incorrect."),U=new z(400,"bad_request","Missing JSON list of 'docs'"),G=new z(404,"not_found","missing"),Q=new z(409,"conflict","Document update conflict"),V=new z(400,"bad_request","_id field must contain a string"),W=new z(412,"missing_id","_id is required for puts"),Y=new z(400,"bad_request","Only reserved document ids may start with underscore."),H=new z(412,"precondition_failed","Database not open"),X=new z(500,"unknown_error","Database encountered an unknown error"),Z=new z(500,"badarg","Some query argument is invalid"),ee=new z(400,"invalid_request","Request was invalid"),te=new z(400,"query_parse_error","Some query parameter is invalid"),ne=new z(500,"doc_validation","Bad special document member"),re=new z(400,"bad_request","Something wrong with the request"),ie=new z(400,"bad_request","Document must be a JSON object"),oe=new z(404,"not_found","Database not found"),ae=new z(500,"indexed_db_went_bad","unknown"),se=new z(500,"web_sql_went_bad","unknown"),ce=new z(500,"levelDB_went_went_bad","unknown"),ue=new z(403,"forbidden","Forbidden by design doc validate_doc_update function"),fe=new z(400,"bad_request","Invalid rev format"),le=new z(412,"file_exists","The database could not be created, the file already exists."),de=new z(412,"missing_stub","A pre-existing attachment stub wasn't found"),he=new z(413,"invalid_url","Provided URL is invalid");function pe(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=z.prototype,new n(t)}function ve(e){if("object"!=typeof e){var t=e;(e=X).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function _e(e,t,n){try{return!e(t,n)}catch(i){var r="Filter function threw: "+i.toString();return pe(re,r)}}function ge(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var i=n&&_e(e.filter,r.doc,t);if("object"==typeof i)return i;if(i)return!1;if(e.include_docs){if(!e.attachments)for(var o in r.doc._attachments)r.doc._attachments.hasOwnProperty(o)&&(r.doc._attachments[o].stub=!0)}else delete r.doc;return!0}}function ye(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function me(e){var t;if(e?"string"!=typeof e?t=pe(V):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=pe(Y)):t=pe(W),t)throw t}function be(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(T("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function we(e,t){return"listenerCount"in e?e.listenerCount(t):i.EventEmitter.listenerCount(e,t)}function ke(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function qe(e){var t=ke(e);return t?t.join("/"):null}var je=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Oe="queryKey",Se=/(?:^|&)([^&=]*)=?([^&]*)/g,Ee=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Ae(e){for(var t=Ee.exec(e),n={},r=14;r--;){var i=je[r],o=t[r]||"",a=-1!==["user","password"].indexOf(i);n[i]=a?decodeURIComponent(o):o}return n[Oe]={},n[je[12]].replace(Se,function(e,t,r){t&&(n[Oe][t]=r)}),n}function xe(e,t){var n=[],r=[];for(var i in t)t.hasOwnProperty(i)&&(n.push(i),r.push(t[i]));return n.push(e),Function.apply(null,n).apply(null,r)}function Pe(e,t,n){return new Promise(function(r,i){e.get(t,function(o,a){if(o){if(404!==o.status)return i(o);a={}}var s=a._rev,c=n(a);if(!c)return r({updated:!1,rev:s});c._id=t,c._rev=s,r(Ce(e,c,n))})})}function Ce(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return Pe(e,t._id,n)})}var $e=function(e){return atob(e)},De=function(e){return btoa(e)};function Ie(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(go){if("TypeError"!==go.name)throw go;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function Le(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function Be(e,t){return Ie([Le(e)],{type:t})}function Re(e,t){return Be($e(e),t)}function Te(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,i=0;i<r;i++)t+=String.fromCharCode(n[i]);return t}function Ne(e,t){var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(Te(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function Me(e,t){Ne(e,function(e){t(e)})}function Ke(e,t){Me(e,function(e){t(De(e))})}function Je(e,t){var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}var ze=e.setImmediate||e.setTimeout,Fe=32768;function Ue(e){return De(e)}function Ge(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function Qe(e,t,n,r,i){(n>0||r<t.size)&&(t=Ge(t,n,r)),Je(t,function(t){e.append(t),i()})}function Ve(e,t,n,r,i){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),i()}function We(e,t){var n="string"==typeof e,r=n?e.length:e.size,i=Math.min(Fe,r),o=Math.ceil(r/i),s=0,c=n?new a.default:new a.default.ArrayBuffer,u=n?Ve:Qe;function f(){ze(d)}function l(){var e=Ue(c.end(!0));t(e),c.destroy()}function d(){var t=s*i,n=t+i;u(c,e,t,n,++s<o?f:l)}d()}function Ye(e){return a.default.hash(e)}function He(e,t){var n=y(e);return t?(delete n._rev_tree,Ye(JSON.stringify(n))):s.default.v4().replace(/-/g,"").toLowerCase()}var Xe=s.default.v4;function Ze(e){for(var t,n,r,i,o=e.rev_tree.slice();i=o.pop();){var a=i.ids,s=a[2],c=i.pos;if(s.length)for(var u=0,f=s.length;u<f;u++)o.push({pos:c+1,ids:s[u]});else{var l=!!a[1].deleted,d=a[0];t&&!(r!==l?r:n!==c?n<c:t<d)||(t=d,n=c,r=l)}}return n+"-"+t}function et(e,t){for(var n,r=e.slice();n=r.pop();)for(var i=n.pos,o=n.ids,a=o[2],s=t(0===a.length,i,o[0],n.ctx,o[1]),c=0,u=a.length;c<u;c++)r.push({pos:i+1,ids:a[c],ctx:s})}function tt(e,t){return e.pos-t.pos}function nt(e){var t=[];et(e,function(e,n,r,i,o){e&&t.push({rev:n+"-"+r,pos:n,opts:o})}),t.sort(tt).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function rt(e){for(var t=Ze(e),n=nt(e.rev_tree),r=[],i=0,o=n.length;i<o;i++){var a=n[i];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function it(e){var t=[];return et(e.rev_tree,function(e,n,r,i,o){"available"!==o.status||e||(t.push(n+"-"+r),o.status="missing")}),t}function ot(e){for(var t,n=[],r=e.slice();t=r.pop();){var i=t.pos,o=t.ids,a=o[0],s=o[1],c=o[2],u=0===c.length,f=t.history?t.history.slice():[];f.push({id:a,opts:s}),u&&n.push({pos:i+1-f.length,ids:f});for(var l=0,d=c.length;l<d;l++)r.push({pos:i+1,ids:c[l],history:f})}return n.reverse()}function at(e,t){return e.pos-t.pos}function st(e,t,n){for(var r,i=0,o=e.length;i<o;)n(e[r=i+o>>>1],t)<0?i=r+1:o=r;return i}function ct(e,t,n){var r=st(e,t,n);e.splice(r,0,t)}function ut(e,t){for(var n,r,i=t,o=e.length;i<o;i++){var a=e[i],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function ft(e,t){return e[0]<t[0]?-1:1}function lt(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var i=n.pop(),o=i.tree1,a=i.tree2;(o[1].status||a[1].status)&&(o[1].status="available"===o[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(o[2][0]){for(var c=!1,u=0;u<o[2].length;u++)o[2][u][0]===a[2][s][0]&&(n.push({tree1:o[2][u],tree2:a[2][s]}),c=!0);c||(r="new_branch",ct(o[2],a[2][s],ft))}else r="new_leaf",o[2][0]=a[2][s]}return{conflicts:r,tree:e}}function dt(e,t,n){var r,i=[],o=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,c=e.length;s<c;s++){var u=e[s];if(u.pos===t.pos&&u.ids[0]===t.ids[0])r=lt(u.ids,t.ids),i.push({pos:u.pos,ids:r.tree}),o=o||r.conflicts,a=!0;else if(!0!==n){var f=u.pos<t.pos?u:t,l=u.pos<t.pos?t:u,d=l.pos-f.pos,h=[],p=[];for(p.push({ids:f.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var v=p.pop();if(0!==v.diff)for(var _=v.ids[2],g=0,y=_.length;g<y;g++)p.push({ids:_[g],diff:v.diff-1,parent:v.ids,parentIdx:g});else v.ids[0]===l.ids[0]&&h.push(v)}var m=h[0];m?(r=lt(m.ids,l.ids),m.parent[2][m.parentIdx]=r.tree,i.push({pos:f.pos,ids:f.ids}),o=o||r.conflicts,a=!0):i.push(u)}else i.push(u)}return a||i.push(t),i.sort(at),{tree:i,conflicts:o||"internal_node"}}function ht(e,t){for(var n,r,i=ot(e),o=0,a=i.length;o<a;o++){var s,c=i[o],u=c.ids;if(u.length>t){n||(n={});var f=u.length-t;s={pos:c.pos+f,ids:ut(u,f)};for(var l=0;l<f;l++){var d=c.pos+l+"-"+u[l].id;n[d]=!0}}else s={pos:c.pos,ids:ut(u,0)};r=r?dt(r,s,!0).tree:[s]}return n&&et(r,function(e,t,r){delete n[t+"-"+r]}),{tree:r,revs:n?Object.keys(n):[]}}function pt(e,t,n){var r=dt(e,t),i=ht(r.tree,n);return{tree:i.tree,stemmedRevs:i.revs,conflicts:r.conflicts}}function vt(e,t){for(var n,r=e.slice(),i=t.split("-"),o=parseInt(i[0],10),a=i[1];n=r.pop();){if(n.pos===o&&n.ids[0]===a)return!0;for(var s=n.ids[2],c=0,u=s.length;c<u;c++)r.push({pos:n.pos+1,ids:s[c]})}return!1}function _t(e){return e.ids}function gt(e,t){t||(t=Ze(e));for(var n,r=t.substring(t.indexOf("-")+1),i=e.rev_tree.map(_t);n=i.pop();){if(n[0]===r)return!!n[1].deleted;i=i.concat(n[2])}}function yt(e){return/^_local/.test(e)}function mt(e,t){for(var n,r=t.rev_tree.slice();n=r.pop();){var i=n.pos,o=n.ids,a=o[0],s=o[1],c=o[2],u=0===c.length,f=n.history?n.history.slice():[];if(f.push({id:a,pos:i,opts:s}),u)for(var l=0,d=f.length;l<d;l++){var h=f[l];if(h.pos+"-"+h.id===e)return i+"-"+a}for(var p=0,v=c.length;p<v;p++)r.push({pos:i+1,ids:c[p],history:f})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+e)}function bt(e,t,n,r){try{e.emit("change",t,n,r)}catch(go){T("error",'Error in .on("change", function):',go)}}function wt(e,t,n){i.EventEmitter.call(this);var r=this;this.db=e;var o=(t=t?y(t):{}).complete=m(function(t,n){t?we(r,"error")>0&&r.emit("error",t):r.emit("complete",n),r.removeAllListeners(),e.removeListener("destroyed",a)});function a(){r.cancel()}n&&(r.on("complete",function(e){n(null,e)}),r.on("error",n)),e.once("destroyed",a),t.onChange=function(e,t,n){r.isCancelled||bt(r,e,t,n)};var s=new Promise(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});r.once("cancel",function(){e.removeListener("destroyed",a),t.complete(null,{status:"cancelled"})}),this.then=s.then.bind(s),this.catch=s.catch.bind(s),this.then(function(e){o(null,e)},o),e.taskqueue.isReady?r.validateChanges(t):e.taskqueue.addTask(function(e){e?t.complete(e):r.isCancelled?r.emit("cancel"):r.validateChanges(t)})}function kt(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=nt(t.rev_tree).map(function(e){return{rev:e.rev}}));var i={id:t.id,changes:r,doc:e};return gt(t,e._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=rt(t),i.doc._conflicts.length||delete i.doc._conflicts),i}function qt(e,t){return e<t?-1:e>t?1:0}function jt(e,t){return function(n,r){n||r[0]&&r[0].error?((n=n||r[0]).docId=t,e(n)):e(null,r.length?r[0]:r)}}function Ot(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var o=r[i];n._attachments[o]=A(n._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}function St(e,t){var n=qt(e._id,t._id);return 0!==n?n:qt(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function Et(e){var t={},n=[];return et(e,function(e,r,i,o){var a=r+"-"+i;return e&&(t[a]=0),void 0!==o&&n.push({from:o,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function At(e){var t="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=t,e.skip=0,delete e.limit,e.descending&&(t.reverse(),e.descending=!1)}function xt(e){var t=e._compactionQueue[0],n=t.opts,i=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(n.last_seq=t.last_seq),e._compact(n,function(t,n){t?i(t):i(null,n),(0,r.default)(function(){e._compactionQueue.shift(),e._compactionQueue.length&&xt(e)})})})}function Pt(e){return"_"===e.charAt(0)&&e+" is not a valid attachment name, attachment names cannot start with '_'"}function Ct(){for(var e in i.EventEmitter.call(this),Ct.prototype)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}function $t(){this.isReady=!1,this.failed=!1,this.queue=[]}function Dt(e,t){var n=e.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=Lt.adapters,i=Lt.preferredAdapters,o=Lt.prefix,a=t.adapter;if(!a)for(var s=0;s<i.length&&("idb"===(a=i[s])&&"websql"in r&&L()&&localStorage["_pouch__websqldb_"+o+e]);++s)T("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var c=r[a];return{name:!(c&&"use_prefix"in c)||c.use_prefix?o+e:e,adapter:a}}function It(e){function t(t){e.removeListener("closed",n),t||e.constructor.emit("destroyed",e.name)}function n(){e.removeListener("destroyed",t),e.constructor.emit("unref",e)}e.once("destroyed",t),e.once("closed",n),e.constructor.emit("ref",e)}function Lt(e,t){if(!(this instanceof Lt))return new Lt(e,t);var n=this;if(t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),void 0===t.deterministic_revs&&(t.deterministic_revs=!0),this.__opts=t=y(t),n.auto_compaction=t.auto_compaction,n.prefix=Lt.prefix,"string"!=typeof e)throw new Error("Missing/invalid DB name");var r=Dt((t.prefix||"")+e,t);if(t.name=r.name,t.adapter=t.adapter||r.adapter,n.name=e,n._adapter=t.adapter,Lt.emit("debug",["adapter","Picked adapter: ",t.adapter]),!Lt.adapters[t.adapter]||!Lt.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);Ct.call(n),n.taskqueue=new $t,n.adapter=t.adapter,Lt.adapters[t.adapter].call(n,t,function(e){if(e)return n.taskqueue.fail(e);It(n),n.emit("created",n),Lt.emit("created",n.name),n.taskqueue.ready(n)})}(0,o.default)(wt,i.EventEmitter),wt.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},wt.prototype.validateChanges=function(e){var t=e.complete,n=this;Lt._changesFilterPlugin?Lt._changesFilterPlugin.validate(e,function(r){if(r)return t(r);n.doChanges(e)}):n.doChanges(e)},wt.prototype.doChanges=function(e){var t=this,r=e.complete;if("live"in(e=y(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=kt,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(Lt._changesFilterPlugin){if(Lt._changesFilterPlugin.normalize(e),Lt._changesFilterPlugin.shouldFilter(this,e))return Lt._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(t){t in e&&T("warn",'The "'+t+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=r;var i=this.db._changes(e);if(i&&"function"==typeof i.cancel){var o=t.cancel;t.cancel=(0,n.default)(function(e){i.cancel(),o.apply(this,e)})}}else this.db.info().then(function(n){t.isCancelled?r(null,{status:"cancelled"}):(e.since=n.update_seq,t.doChanges(e))},r)},(0,o.default)(Ct,i.EventEmitter),Ct.prototype.post=k("post",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(pe(ie));this.bulkDocs({docs:[e]},t,jt(n,e._id))}),Ct.prototype.put=k("put",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(pe(ie));if(me(e._id),yt(e._id)&&"function"==typeof this._putLocal)return e._deleted?this._removeLocal(e,n):this._putLocal(e,n);var r,i,o,a,s=this;function c(n){"function"==typeof s._put&&!1!==t.new_edits?s._put(e,t,n):s.bulkDocs({docs:[e]},t,jt(n,e._id))}t.force&&e._rev?(r=e._rev.split("-"),i=r[1],o=parseInt(r[0],10)+1,a=He(),e._revisions={start:o,ids:[a,i]},e._rev=o+"-"+a,t.new_edits=!1,c(function(t){var r=t?null:{ok:!0,id:e._id,rev:e._rev};n(t,r)})):c(n)}),Ct.prototype.putAttachment=k("putAttachment",function(e,t,n,r,i){var o=this;function a(e){var n="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:i,data:r,revpos:++n},o.put(e)}return"function"==typeof i&&(i=r,r=n,n=null),void 0===i&&(i=r,r=n,n=null),i||T("warn","Attachment",t,"on document",e,"is missing content_type"),o.get(e).then(function(e){if(e._rev!==n)throw pe(Q);return a(e)},function(t){if(t.reason===G.message)return a({_id:e});throw t})}),Ct.prototype.removeAttachment=k("removeAttachment",function(e,t,n,r){var i=this;i.get(e,function(e,o){if(e)r(e);else if(o._rev===n){if(!o._attachments)return r();delete o._attachments[t],0===Object.keys(o._attachments).length&&delete o._attachments,i.put(o,r)}else r(pe(Q))})}),Ct.prototype.remove=k("remove",function(e,t,n,r){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(i=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),(n=n||{}).was_delete=!0;var o={_id:i._id,_rev:i._rev||n.rev,_deleted:!0};if(yt(o._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,r);this.bulkDocs({docs:[o]},n,jt(r,o._id))}),Ct.prototype.revsDiff=k("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={});var r=Object.keys(e);if(!r.length)return n(null,{});var i=0,o=new p;function a(e,t){o.has(e)||o.set(e,{missing:[]}),o.get(e).missing.push(t)}r.map(function(t){this._getRevisionTree(t,function(s,c){if(s&&404===s.status&&"missing"===s.message)o.set(t,{missing:e[t]});else{if(s)return n(s);!function(t,n){var r=e[t].slice(0);et(n,function(e,n,i,o,s){var c=n+"-"+i,u=r.indexOf(c);-1!==u&&(r.splice(u,1),"available"!==s.status&&a(t,c))}),r.forEach(function(e){a(t,e)})}(t,c)}if(++i===r.length){var u={};return o.forEach(function(e,t){u[t]=e}),n(null,u)}})},this)}),Ct.prototype.bulkGet=k("bulkGet",function(e,t){I(this,e,t)}),Ct.prototype.compactDocument=k("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(i,o){if(i)return n(i);var a=Et(o),s=[],c=[];Object.keys(a).forEach(function(e){a[e]>t&&s.push(e)}),et(o,function(e,t,n,r,i){var o=t+"-"+n;"available"===i.status&&-1!==s.indexOf(o)&&c.push(o)}),r._doCompaction(e,c,n)})}),Ct.prototype.compact=k("compact",function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),1===this._compactionQueue.length&&xt(this)}),Ct.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},i=[];n.changes(r).on("change",function(e){i.push(n.compactDocument(e.id,0))}).on("complete",function(e){var r=e.last_seq;Promise.all(i).then(function(){return Pe(n,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<r)&&(e.last_seq=r,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},Ct.prototype.get=k("get",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(pe(V));if(yt(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var r=[],i=this;function o(){var o=[],a=r.length;if(!a)return n(null,o);r.forEach(function(r){i.get(e,{rev:r,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(e,t){if(e)o.push({missing:r});else{for(var i,s=0,c=o.length;s<c;s++)if(o[s].ok&&o[s].ok._rev===t._rev){i=!0;break}i||o.push({ok:t})}--a||n(null,o)})})}if(!t.open_revs)return this._get(e,t,function(r,o){if(r)return r.docId=e,n(r);var a=o.doc,s=o.metadata,c=o.ctx;if(t.conflicts){var u=rt(s);u.length&&(a._conflicts=u)}if(gt(s,a._rev)&&(a._deleted=!0),t.revs||t.revs_info){for(var f=a._rev.split("-"),l=parseInt(f[0],10),d=f[1],h=ot(s.rev_tree),p=null,v=0;v<h.length;v++){var _=h[v],g=_.ids.map(function(e){return e.id}).indexOf(d);(g===l-1||!p&&-1!==g)&&(p=_)}var y=p.ids.map(function(e){return e.id}).indexOf(a._rev.split("-")[1])+1,m=p.ids.length-y;if(p.ids.splice(y,m),p.ids.reverse(),t.revs&&(a._revisions={start:p.pos+p.ids.length-1,ids:p.ids.map(function(e){return e.id})}),t.revs_info){var b=p.pos+p.ids.length;a._revs_info=p.ids.map(function(e){return{rev:--b+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&a._attachments){var w=a._attachments,k=Object.keys(w).length;if(0===k)return n(null,a);Object.keys(w).forEach(function(e){this._getAttachment(a._id,e,w[e],{rev:a._rev,binary:t.binary,ctx:c},function(t,r){var i=a._attachments[e];i.data=r,delete i.stub,delete i.length,--k||n(null,a)})},i)}else{if(a._attachments)for(var q in a._attachments)a._attachments.hasOwnProperty(q)&&(a._attachments[q].stub=!0);n(null,a)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return n(e);r=nt(t).map(function(e){return e.rev}),o()});else{if(!Array.isArray(t.open_revs))return n(pe(X,"function_clause"));r=t.open_revs;for(var a=0;a<r.length;a++){var s=r[a];if("string"!=typeof s||!/^\d+-/.test(s))return n(pe(fe))}o()}}),Ct.prototype.getAttachment=k("getAttachment",function(e,t,n,r){var i=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(o,a){return o?r(o):a.doc._attachments&&a.doc._attachments[t]?(n.ctx=a.ctx,n.binary=!0,void i._getAttachment(e,t,a.doc._attachments[t],n,r)):r(pe(G))})}),Ct.prototype.allDocs=k("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(pe(te,"Query parameter `"+n+"` is not compatible with multi-get"));if(!be(this)&&(At(e),0===e.keys.length))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}),Ct.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),(e=e||{}).return_docs="return_docs"in e?e.return_docs:!e.live,new wt(this,e,t)},Ct.prototype.close=k("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),Ct.prototype.info=k("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t.name,r.auto_compaction=!(!t.auto_compaction||be(t)),r.adapter=t.adapter,e(null,r)})}),Ct.prototype.id=k("id",function(e){return this._id(e)}),Ct.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},Ct.prototype.bulkDocs=k("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(pe(U));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(pe(ie));var i;if(e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(t){i=i||Pt(t),e._attachments[t].content_type||T("warn","Attachment",t,"on document",e._id,"is missing content_type")})}),i)return n(pe(re,i));"new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits);var o=this;t.new_edits||be(o)||e.docs.sort(St),Ot(e.docs);var a=e.docs.map(function(e){return e._id});return this._bulkDocs(e,t,function(e,r){if(e)return n(e);if(t.new_edits||(r=r.filter(function(e){return e.error})),!be(o))for(var i=0,s=r.length;i<s;i++)r[i].id=r[i].id||a[i];n(null,r)})}),Ct.prototype.registerDependentDatabase=k("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);Pe(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:n})}).catch(t)}),Ct.prototype.destroy=k("destroy",function(e,t){"function"==typeof e&&(t=e,e={});var n=this,r=!("use_prefix"in n)||n.use_prefix;function i(){n._destroy(e,function(e,r){if(e)return t(e);n._destroyed=!0,n.emit("destroyed"),t(null,r||{ok:!0})})}if(be(n))return i();n.get("_local/_pouch_dependentDbs",function(e,o){if(e)return 404!==e.status?t(e):i();var a=o.dependentDbs,s=n.constructor,c=Object.keys(a).map(function(e){var t=r?e.replace(new RegExp("^"+s.prefix),""):e;return new s(t,n.__opts).destroy()});Promise.all(c).then(i,t)})}),$t.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},$t.prototype.fail=function(e){this.failed=e,this.execute()},$t.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},$t.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},(0,o.default)(Lt,Ct);var Bt="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},Rt=fetch,Tt=Headers;Lt.adapters={},Lt.preferredAdapters=[],Lt.prefix="_pouch_";var Nt=new i.EventEmitter;function Mt(e){Object.keys(i.EventEmitter.prototype).forEach(function(t){"function"==typeof i.EventEmitter.prototype[t]&&(e[t]=Nt[t].bind(Nt))});var t=e._destructionListeners=new p;e.on("ref",function(e){t.has(e.name)||t.set(e.name,[]),t.get(e.name).push(e)}),e.on("unref",function(e){if(t.has(e.name)){var n=t.get(e.name),r=n.indexOf(e);r<0||(n.splice(r,1),n.length>1?t.set(e.name,n):t.delete(e.name))}}),e.on("destroyed",function(e){if(t.has(e)){var n=t.get(e);t.delete(e),n.forEach(function(e){e.emit("destroyed",!0)})}})}Mt(Lt),Lt.adapter=function(e,t,n){t.valid()&&(Lt.adapters[e]=t,n&&Lt.preferredAdapters.push(e))},Lt.plugin=function(e){if("function"==typeof e)e(Lt);else{if("object"!=typeof e||0===Object.keys(e).length)throw new Error('Invalid plugin: got "'+e+'", expected an object or a function');Object.keys(e).forEach(function(t){Lt.prototype[t]=e[t]})}return this.__defaults&&(Lt.__defaults=J({},this.__defaults)),Lt},Lt.defaults=function(e){function t(e,n){if(!(this instanceof t))return new t(e,n);n=n||{},e&&"object"==typeof e&&(e=(n=e).name,delete n.name),n=J({},t.__defaults,n),Lt.call(this,e,n)}return(0,o.default)(t,Lt),t.preferredAdapters=Lt.preferredAdapters.slice(),Object.keys(Lt).forEach(function(e){e in t||(t[e]=Lt[e])}),t.__defaults=J({},this.__defaults,e),t},Lt.fetch=function(e,t){return Rt(e,t)};var Kt="7.0.0";function Jt(e,t){for(var n=e,r=0,i=t.length;r<i;r++){if(!(n=n[t[r]]))break}return n}function zt(e,t){return e<t?-1:e>t?1:0}function Ft(e){for(var t=[],n="",r=0,i=e.length;r<i;r++){var o=e[r];"."===o?r>0&&"\\"===e[r-1]?n=n.substring(0,n.length-1)+".":(t.push(n),n=""):n+=o}return t.push(n),t}var Ut=["$or","$nor","$not"];function Gt(e){return Ut.indexOf(e)>-1}function Qt(e){return Object.keys(e)[0]}function Vt(e){return e[Qt(e)]}function Wt(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(n){var r=e[n];if("object"!=typeof r&&(r={$eq:r}),Gt(n))r instanceof Array?t[n]=r.map(function(e){return Wt([e])}):t[n]=Wt([r]);else{var i=t[n]=t[n]||{};Object.keys(r).forEach(function(e){var t=r[e];return"$gt"===e||"$gte"===e?Yt(e,t,i):"$lt"===e||"$lte"===e?Ht(e,t,i):"$ne"===e?Xt(t,i):"$eq"===e?Zt(t,i):void(i[e]=t)})}})}),t}function Yt(e,t,n){void 0===n.$eq&&(void 0!==n.$gte?"$gte"===e?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):void 0!==n.$gt?"$gte"===e?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}function Ht(e,t,n){void 0===n.$eq&&(void 0!==n.$lte?"$lte"===e?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):void 0!==n.$lt?"$lte"===e?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}function Xt(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}function Zt(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function en(e){var t=y(e),n=!1;"$and"in t&&(t=Wt(t.$and),n=!0),["$or","$nor"].forEach(function(e){e in t&&t[e].forEach(function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n],i=e[r];"object"==typeof i&&null!==i||(e[r]={$eq:i})}})}),"$not"in t&&(t.$not=Wt([t.$not]));for(var r=Object.keys(t),i=0;i<r.length;i++){var o=r[i],a=t[o];"object"!=typeof a||null===a?a={$eq:a}:"$ne"in a&&!n&&(a.$ne=[a.$ne]),t[o]=a}return t}function tn(e,t,n){for(var r="",i=n-e.length;r.length<i;)r+=t;return r}function nn(e,t,n){return tn(e,t,n)+e}var rn=-324,on=3,an="";function sn(e,t){if(e===t)return 0;e=cn(e),t=cn(t);var n=gn(e),r=gn(t);if(n-r!=0)return n-r;switch(typeof e){case"number":return e-t;case"boolean":return e<t?-1:1;case"string":return vn(e,t)}return Array.isArray(e)?pn(e,t):_n(e,t)}function cn(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var r=0;r<n;r++)e[r]=cn(t[r])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var i in e={},t)if(t.hasOwnProperty(i)){var o=t[i];void 0!==o&&(e[i]=cn(o))}}}return e}function un(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return yn(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),n=t?e:Object.keys(e),r=-1,i=n.length,o="";if(t)for(;++r<i;)o+=fn(n[r]);else for(;++r<i;){var a=n[r];o+=fn(a)+fn(e[a])}return o}return""}function fn(e){return gn(e=cn(e))+an+un(e)+"\0"}function ln(e,t){var n,r=t;if("1"===e[t])n=0,t++;else{var i="0"===e[t];t++;var o="",a=e.substring(t,t+on),s=parseInt(a,10)+rn;for(i&&(s=-s),t+=on;;){var c=e[t];if("\0"===c)break;o+=c,t++}n=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(n-=10),0!==s&&(n=parseFloat(n+"e"+s))}return{num:n,length:t-r}}function dn(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var i=r.element,o=r.index;if(Array.isArray(i))i.push(n);else if(o===e.length-2){i[e.pop()]=n}else e.push(n)}}function hn(e){for(var t=[],n=[],r=0;;){var i=e[r++];if("\0"!==i)switch(i){case"1":t.push(null);break;case"2":t.push("1"===e[r]),r++;break;case"3":var o=ln(e,r);t.push(o.num),r+=o.length;break;case"4":for(var a="";;){var s=e[r];if("\0"===s)break;a+=s,r++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(a);break;case"5":var c={element:[],index:t.length};t.push(c.element),n.push(c);break;case"6":var u={element:{},index:t.length};t.push(u.element),n.push(u);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}else{if(1===t.length)return t.pop();dn(t,n)}}}function pn(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=sn(e[r],t[r]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function vn(e,t){return e===t?0:e>t?1:-1}function _n(e,t){for(var n=Object.keys(e),r=Object.keys(t),i=Math.min(n.length,r.length),o=0;o<i;o++){var a=sn(n[o],r[o]);if(0!==a)return a;if(0!==(a=sn(e[n[o]],t[r[o]])))return a}return n.length===r.length?0:n.length>r.length?1:-1}function gn(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}function yn(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,i=r?"0":"2",o=nn(((r?-n:n)-rn).toString(),"0",on);i+=an+o;var a=Math.abs(parseFloat(t[0]));r&&(a=10-a);var s=a.toFixed(20);return s=s.replace(/\.?0+$/,""),i+=an+s}function mn(e){function t(t){return e.map(function(e){var n=Ft(Qt(e));return Jt(t,n)})}return function(e,n){var r=sn(t(e.doc),t(n.doc));return 0!==r?r:zt(e.doc._id,n.doc._id)}}function bn(e,t,n){if(e=e.filter(function(e){return wn(e.doc,t.selector,n)}),t.sort){var r=mn(t.sort);e=e.sort(r),"string"!=typeof t.sort[0]&&"desc"===Vt(t.sort[0])&&(e=e.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,o=("limit"in t?t.limit:e.length)+i;e=e.slice(i,o)}return e}function wn(e,t,n){return n.every(function(n){var r=t[n],i=Ft(n),o=Jt(e,i);return Gt(n)?qn(n,r,e):kn(r,e,i,o)})}function kn(e,t,n,r){return!e||Object.keys(e).every(function(i){var o=e[i];return jn(i,t,o,n,r)})}function qn(e,t,n){return"$or"===e?t.some(function(e){return wn(n,e,Object.keys(e))}):"$not"===e?!wn(n,t,Object.keys(t)):!t.find(function(e){return wn(n,e,Object.keys(e))})}function jn(e,t,n,r,i){if(!Dn[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Dn[e](t,n,r,i)}function On(e){return null!=e}function Sn(e){return void 0!==e}function En(e,t){var n=t[0],r=t[1];if(0===n)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(n,10)!==n)throw new Error("Divisor is not an integer");if(parseInt(r,10)!==r)throw new Error("Modulus is not an integer");return parseInt(e,10)===e&&e%n===r}function An(e,t){return t.some(function(t){return e instanceof Array?e.indexOf(t)>-1:e===t})}function xn(e,t){return t.every(function(t){return e.indexOf(t)>-1})}function Pn(e,t){return e.length===t}function Cn(e,t){return new RegExp(t).test(e)}function $n(e,t){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}throw new Error(t+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var Dn={$elemMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.some(function(e){return wn(e,t,Object.keys(t))}):r.some(function(r){return kn(t,e,n,r)})))},$allMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.every(function(e){return wn(e,t,Object.keys(t))}):r.every(function(r){return kn(t,e,n,r)})))},$eq:function(e,t,n,r){return Sn(r)&&0===sn(r,t)},$gte:function(e,t,n,r){return Sn(r)&&sn(r,t)>=0},$gt:function(e,t,n,r){return Sn(r)&&sn(r,t)>0},$lte:function(e,t,n,r){return Sn(r)&&sn(r,t)<=0},$lt:function(e,t,n,r){return Sn(r)&&sn(r,t)<0},$exists:function(e,t,n,r){return t?Sn(r):!Sn(r)},$mod:function(e,t,n,r){return On(r)&&En(r,t)},$ne:function(e,t,n,r){return t.every(function(e){return 0!==sn(r,e)})},$in:function(e,t,n,r){return On(r)&&An(r,t)},$nin:function(e,t,n,r){return On(r)&&!An(r,t)},$size:function(e,t,n,r){return On(r)&&Pn(r,t)},$all:function(e,t,n,r){return Array.isArray(r)&&xn(r,t)},$regex:function(e,t,n,r){return On(r)&&Cn(r,t)},$type:function(e,t,n,r){return $n(r,t)}};function In(e,t){if("object"!=typeof t)throw new Error("Selector error: expected a JSON object");var n=bn([{doc:e}],{selector:t=en(t)},Object.keys(t));return n&&1===n.length}function Ln(e){return xe('"use strict";\nreturn '+e+";",{})}function Bn(e){return xe(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}function Rn(e,t){if(e.selector&&e.filter&&"_selector"!==e.filter){var n="string"==typeof e.filter?e.filter:"function";return t(new Error('selector invalid for filter "'+n+'"'))}t()}function Tn(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=qe(e.view):e.filter=qe(e.filter))}function Nn(e,t){return t.filter&&"string"==typeof t.filter&&!t.doc_ids&&!be(e.db)}function Mn(e,t){var n=t.complete;if("_view"===t.filter){if(!t.view||"string"!=typeof t.view){var r=pe(re,"`view` filter parameter not found or invalid.");return n(r)}var i=ke(t.view);e.db.get("_design/"+i[0],function(r,o){if(e.isCancelled)return n(null,{status:"cancelled"});if(r)return n(ve(r));var a=o&&o.views&&o.views[i[1]]&&o.views[i[1]].map;if(!a)return n(pe(G,o.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=Bn(a),e.doChanges(t)})}else if(t.selector)t.filter=function(e){return In(e,t.selector)},e.doChanges(t);else{var o=ke(t.filter);e.db.get("_design/"+o[0],function(r,i){if(e.isCancelled)return n(null,{status:"cancelled"});if(r)return n(ve(r));var a=i&&i.filters&&i.filters[o[1]];if(!a)return n(pe(G,i&&i.filters?"missing json key: "+o[1]:"missing json key: filters"));t.filter=Ln(a),e.doChanges(t)})}}function Kn(e){e._changesFilterPlugin={validate:Rn,normalize:Tn,shouldFilter:Nn,filter:Mn}}function Jn(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}Lt.plugin(Kn),Lt.version=Kt;var zn=Jn(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Fn=Jn(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function Un(e){if(!/^\d+-./.test(e))return pe(fe);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function Gn(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,i=[r[0],t,[]],o=1,a=r.length;o<a;o++)i=[r[o],{status:"missing"},[i]];return[{pos:n,ids:i}]}function Qn(e,t,n){var r,i,o;n||(n={deterministic_revs:!0});var a={status:"available"};if(e._deleted&&(a.deleted=!0),t)if(e._id||(e._id=Xe()),i=He(e,n.deterministic_revs),e._rev){if((o=Un(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[i,a,[]]]]}],r=o.prefix+1}else e._rev_tree=[{pos:1,ids:[i,a,[]]}],r=1;else if(e._revisions&&(e._rev_tree=Gn(e._revisions,a),r=e._revisions.start,i=e._revisions.ids[0]),!e._rev_tree){if((o=Un(e._rev)).error)return o;r=o.prefix,i=o.id,e._rev_tree=[{pos:r,ids:[i,a,[]]}]}me(e._id),e._rev=r+"-"+i;var s={metadata:{},data:{}};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var u="_"===c[0];if(u&&!zn[c]){var f=pe(ne,c);throw f.message=ne.message+": "+c,f}u&&!Fn[c]?s.metadata[c.slice(1)]=e[c]:s.data[c]=e[c]}return s}function Vn(e){try{return $e(e)}catch(go){return{error:pe(Z,"Attachment is not a valid base64 string")}}}function Wn(e,t,n){var r=Vn(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?Be(r,e.content_type):"base64"===t?De(r):r,We(r,function(t){e.digest="md5-"+t,n()})}function Yn(e,t,n){We(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?Me(e.data,function(t){e.data=t,n()}):"base64"===t?Ke(e.data,function(t){e.data=t,n()}):n()})}function Hn(e,t,n){if(e.stub)return n();"string"==typeof e.data?Wn(e,t,n):Yn(e,t,n)}function Xn(e,t,n){if(!e.length)return n();var r,i=0;function o(){i++,e.length===i&&(r?n(r):n())}e.forEach(function(e){var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],i=0;if(!n.length)return o();function a(e){r=e,++i===n.length&&o()}for(var s in e.data._attachments)e.data._attachments.hasOwnProperty(s)&&Hn(e.data._attachments[s],t,a)})}function Zn(e,t,n,r,i,o,a,s){if(vt(t.rev_tree,n.metadata.rev)&&!s)return r[i]=n,o();var c=t.winningRev||Ze(t),u="deleted"in t?t.deleted:gt(t,c),f="deleted"in n.metadata?n.metadata.deleted:gt(n.metadata),l=/^1-/.test(n.metadata.rev);if(u&&!f&&s&&l){var d=n.data;d._rev=c,d._id=n.metadata.id,n=Qn(d,s)}var h=pt(t.rev_tree,n.metadata.rev_tree[0],e);if(s&&(u&&f&&"new_leaf"!==h.conflicts||!u&&"new_leaf"!==h.conflicts||u&&!f&&"new_branch"===h.conflicts)){var p=pe(Q);return r[i]=p,o()}var v=n.metadata.rev;n.metadata.rev_tree=h.tree,n.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var _=Ze(n.metadata),g=gt(n.metadata,_),y=u===g?0:u<g?-1:1;a(n,_,g,v===_?g:gt(n.metadata,v),!0,y,i,o)}function er(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function tr(e,t,n,r,i,o,a,s,c){e=e||1e3;var u=s.new_edits,f=new p,l=0,d=t.length;function h(){++l===d&&c&&c()}t.forEach(function(e,t){if(e._id&&yt(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:i},function(e,n){o[t]=e||n,h()})}else{var a=e.metadata.id;f.has(a)?(d--,f.get(a).push([e,t])):f.set(a,[[e,t]])}}),f.forEach(function(t,n){var i=0;function c(){++i<t.length?f():h()}function f(){var f=t[i],l=f[0],d=f[1];if(r.has(n))Zn(e,r.get(n),l,o,d,c,a,u);else{var h=pt([],l.metadata.rev_tree[0],e);l.metadata.rev_tree=h.tree,l.stemmedRevs=h.stemmedRevs||[],function(e,t,n){var r=Ze(e.metadata),i=gt(e.metadata,r);if("was_delete"in s&&i)return o[t]=pe(G,"deleted"),n();if(u&&er(e)){var c=pe(Q);return o[t]=c,n()}a(e,r,i,i,!1,i?0:1,t,n)}(l,d,c)}}f()})}var nr=5,rr="document-store",ir="by-sequence",or="attach-store",ar="attach-seq-store",sr="meta-store",cr="local-store",ur="detect-blob-support";function fr(e){try{return JSON.parse(e)}catch(go){return c.default.parse(e)}}function lr(e){try{return JSON.stringify(e)}catch(go){return c.default.stringify(e)}}function dr(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(pe(ae,n,t.type))}}function hr(e,t,n){return{data:lr(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function pr(e){if(!e)return null;var t=fr(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function vr(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function _r(e,t,n,r){n?r(e?"string"!=typeof e?e:Re(e,t):Ie([""],{type:t})):e?"string"!=typeof e?Ne(e,function(e){r(De(e))}):r(e):r("")}function gr(e,t,n,r){var i=Object.keys(e._attachments||{});if(!i.length)return r&&r();var o=0;function a(){++o===i.length&&r&&r()}i.forEach(function(r){t.attachments&&t.include_docs?function(e,t){var r=e._attachments[t],i=r.digest;n.objectStore(or).get(i).onsuccess=function(e){r.body=e.target.result.body,a()}}(e,r):(e._attachments[r].stub=!0,a())})}function yr(e,t){return Promise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return Promise.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var i=r.body,o=r.content_type;return new Promise(function(a){_r(i,o,t,function(t){e.doc._attachments[n]=J(A(r,["digest","content_type"]),{data:t}),a()})})}}))}}))}function mr(e,t,n){var r=[],i=n.objectStore(ir),o=n.objectStore(or),a=n.objectStore(ar),s=e.length;function c(){--s||function(){if(!r.length)return;r.forEach(function(e){var t=a.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||o.delete(e)}})}()}e.forEach(function(e){var n=i.index("_doc_id_rev"),o=t+"::"+e;n.getKey(o).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return c();i.delete(t),a.index("seq").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];r.push(n),a.delete(t.primaryKey),t.continue()}else c()}}})}function br(e,t,n){try{return{txn:e.transaction(t,n)}}catch(r){return{error:r}}}var wr=new R;function kr(e,t,n,r,i,o){for(var a,s,c,u,f,l,d,h,v=t.docs,_=0,g=v.length;_<g;_++){var y=v[_];y._id&&yt(y._id)||(y=v[_]=Qn(y,n.new_edits,e)).error&&!d&&(d=y)}if(d)return o(d);var m=!1,b=0,w=new Array(v.length),k=new p,q=!1,j=r._meta.blobSupport?"blob":"base64";function O(){m=!0,S()}function S(){h&&m&&(h.docCount+=b,l.put(h))}function E(){q||(wr.notify(r._meta.name),o(null,w))}function A(e,t,n,r,i,o,a,s){e.metadata.winningRev=t,e.metadata.deleted=n;var c=e.data;if(c._id=e.metadata.id,c._rev=e.metadata.rev,r&&(c._deleted=!0),c._attachments&&Object.keys(c._attachments).length)return function(e,t,n,r,i,o){var a=e.data,s=0,c=Object.keys(a._attachments);function f(){s===c.length&&x(e,t,n,r,i,o)}function l(){s++,f()}c.forEach(function(n){var r=e.data._attachments[n];if(r.stub)s++,f();else{var i=r.data;delete r.data,r.revpos=parseInt(t,10);var o=r.digest;!function(e,t,n){u.count(e).onsuccess=function(r){var i=r.target.result;if(i)return n();var o={digest:e,body:t},a=u.put(o);a.onsuccess=n}}(o,i,l)}})}(e,t,n,i,a,s);b+=o,S(),x(e,t,n,i,a,s)}function x(e,t,n,i,o,u){var l=e.data,d=e.metadata;function h(o){var c=e.stemmedRevs||[];i&&r.auto_compaction&&(c=c.concat(it(e.metadata))),c&&c.length&&mr(c,e.metadata.id,a),d.seq=o.target.result;var u=hr(d,t,n);s.put(u).onsuccess=p}function p(){w[o]={ok:!0,id:d.id,rev:d.rev},k.set(e.metadata.id,e.metadata),function(e,t,n){var r=0,i=Object.keys(e.data._attachments||{});if(!i.length)return n();function o(){++r===i.length&&n()}function a(n){var r=e.data._attachments[n].digest,i=f.put({seq:t,digestSeq:r+"::"+t});i.onsuccess=o,i.onerror=function(e){e.preventDefault(),e.stopPropagation(),o()}}for(var s=0;s<i.length;s++)a(i[s])}(e,d.seq,u)}l._doc_id_rev=d.id+"::"+d.rev,delete l._id,delete l._rev;var v=c.put(l);v.onsuccess=h,v.onerror=function(e){e.preventDefault(),e.stopPropagation(),c.index("_doc_id_rev").getKey(l._doc_id_rev).onsuccess=function(e){c.put(l,e.target.result).onsuccess=h}}}Xn(v,j,function(t){if(t)return o(t);!function(){var t=br(i,[rr,ir,or,cr,ar,sr],"readwrite");if(t.error)return o(t.error);(a=t.txn).onabort=dr(o),a.ontimeout=dr(o),a.oncomplete=E,s=a.objectStore(rr),c=a.objectStore(ir),u=a.objectStore(or),f=a.objectStore(ar),(l=a.objectStore(sr)).get(sr).onsuccess=function(e){h=e.target.result,S()},function(e){var t=[];if(v.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(i){!function(e,t){u.get(e).onsuccess=function(n){if(n.target.result)t();else{var r=pe(de,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}(i,function(i){i&&!n&&(n=i),++r===t.length&&e(n)})})}(function(t){if(t)return q=!0,o(t);!function(){if(!v.length)return;var t=0;function i(){++t===v.length&&tr(e.revs_limit,v,r,k,a,w,A,n,O)}function o(e){var t=pr(e.target.result);t&&k.set(t.id,t),i()}for(var c=0,u=v.length;c<u;c++){var f=v[c];if(f._id&&yt(f._id))i();else{var l=s.get(f.metadata.id);l.onsuccess=o}}}()})}()})}function qr(e,t,n,r,i){var o,a,s;function c(e){a=e.target.result,o&&i(o,a,s)}function u(e){o=e.target.result,a&&i(o,a,s)}function f(e){var t=e.target.result;if(!t)return i();i([t.key],[t.value],t)}-1===r&&(r=1e3),"function"==typeof e.getAll&&"function"==typeof e.getAllKeys&&r>1&&!n?(s={continue:function(){if(!o.length)return i();var n,s=o[o.length-1];if(t&&t.upper)try{n=IDBKeyRange.bound(s,t.upper,!0,t.upperOpen)}catch(go){if("DataError"===go.name&&0===go.code)return i()}else n=IDBKeyRange.lowerBound(s,!0);t=n,o=null,a=null,e.getAll(t,r).onsuccess=c,e.getAllKeys(t,r).onsuccess=u}},e.getAll(t,r).onsuccess=c,e.getAllKeys(t,r).onsuccess=u):n?e.openCursor(t,"prev").onsuccess=f:e.openCursor(t).onsuccess=f}function jr(e,t,n){if("function"!=typeof e.getAll){var r=[];e.openCursor(t).onsuccess=function(e){var t=e.target.result;t?(r.push(t.value),t.continue()):n({target:{result:r}})}}else e.getAll(t).onsuccess=n}function Or(e,t,n){var r=new Array(e.length),i=0;e.forEach(function(o,a){t.get(o).onsuccess=function(t){t.target.result?r[a]=t.target.result:r[a]={key:o,error:"not_found"},++i===e.length&&n(e,r,{})}})}function Sr(e,t,n,r,i){try{if(e&&t)return i?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return i?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(go){return{error:go}}return null}function Er(e,t,n){var r,i,o="startkey"in e&&e.startkey,a="endkey"in e&&e.endkey,s="key"in e&&e.key,c="keys"in e&&e.keys,u=e.skip||0,f="number"==typeof e.limit?e.limit:-1,l=!1!==e.inclusive_end;if(!c&&(i=(r=Sr(o,a,l,s,e.descending))&&r.error)&&("DataError"!==i.name||0!==i.code))return n(pe(ae,i.name,i.message));var d=[rr,ir,sr];e.attachments&&d.push(or);var h=br(t,d,"readonly");if(h.error)return n(h.error);var p=h.txn;p.oncomplete=function(){e.attachments?yr(w,e.binary).then(O):O()},p.onabort=dr(n);var v,_,g=p.objectStore(rr),y=p.objectStore(ir),m=p.objectStore(sr),b=y.index("_doc_id_rev"),w=[];function k(t,n){var r={id:n.id,key:n.id,value:{rev:t}};n.deleted?c&&(w.push(r),r.value.deleted=!0,r.doc=null):u--<=0&&(w.push(r),e.include_docs&&function(t,n,r){var i=t.id+"::"+r;b.get(i).onsuccess=function(r){if(n.doc=vr(r.target.result)||{},e.conflicts){var i=rt(t);i.length&&(n.doc._conflicts=i)}gr(n.doc,e,p)}}(n,r,t))}function q(e){for(var t=0,n=e.length;t<n&&w.length!==f;t++){var r=e[t];if(r.error&&c)w.push(r);else{var i=pr(r);k(i.winningRev,i)}}}function j(e,t,n){n&&(q(t),w.length<f&&n.continue())}function O(){var t={total_rows:v,offset:e.skip,rows:w};e.update_seq&&void 0!==_&&(t.update_seq=_),n(null,t)}return m.get(sr).onsuccess=function(e){v=e.target.result.docCount},e.update_seq&&function(e,t){e.openCursor(null,"prev").onsuccess=function(e){var n=e.target.result,r=void 0;n&&n.key&&(r=n.key);return t({target:{result:[r]}})}}(y,function(e){e.target.result&&e.target.result.length>0&&(_=e.target.result[0])}),i||0===f?void 0:c?Or(e.keys,g,j):-1===f?jr(g,r,function(t){var n=t.target.result;e.descending&&(n=n.reverse()),q(n)}):void qr(g,r,e.descending,f+u,j)}function Ar(e){return new Promise(function(t){var n=Ie([""]),r=e.objectStore(ur).put(n,"key");r.onsuccess=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)},r.onerror=e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)}}).catch(function(){return!1})}function xr(e,t){e.objectStore(rr).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){t(e.target.result)}}var Pr=!1,Cr=[];function $r(e,t,n,r){try{e(t,n)}catch(t){r.emit("error",t)}}function Dr(){!Pr&&Cr.length&&(Pr=!0,Cr.shift()())}function Ir(e,t,n){Cr.push(function(){e(function(e,i){$r(t,e,i,n),Pr=!1,(0,r.default)(function(){Dr(n)})})}),Dr()}function Lr(e,t,n,r){if((e=y(e)).continuous){var i=n+":"+Xe();return wr.addListener(n,i,t,e),wr.notify(n),{cancel:function(){wr.removeListener(n,i)}}}var o=e.doc_ids&&new h(e.doc_ids);e.since=e.since||0;var a=e.since,s="limit"in e?e.limit:-1;0===s&&(s=1);var c,u,f,l,d=[],v=0,_=ge(e),g=new p;function m(e,t,n,r){if(n.seq!==t)return r();if(n.winningRev===e._rev)return r(n,e);var i=e._id+"::"+n.winningRev;l.get(i).onsuccess=function(e){r(n,vr(e.target.result))}}function b(){e.complete(null,{results:d,last_seq:a})}var w=[rr,ir];e.attachments&&w.push(or);var k=br(r,w,"readonly");if(k.error)return e.complete(k.error);(c=k.txn).onabort=dr(e.complete),c.oncomplete=function(){!e.continuous&&e.attachments?yr(d).then(b):b()},u=c.objectStore(ir),f=c.objectStore(rr),l=u.index("_doc_id_rev"),qr(u,e.since&&!e.descending?IDBKeyRange.lowerBound(e.since,!0):null,e.descending,s,function(t,n,r){if(r&&t.length){var i=new Array(t.length),u=new Array(t.length),l=0;n.forEach(function(n,a){!function(e,t,n){if(o&&!o.has(e._id))return n();var r=g.get(e._id);if(r)return m(e,t,r,n);f.get(e._id).onsuccess=function(i){r=pr(i.target.result),g.set(e._id,r),m(e,t,r,n)}}(vr(n),t[a],function(n,o){u[a]=n,i[a]=o,++l===t.length&&function(){for(var t=[],n=0,o=i.length;n<o&&v!==s;n++){var a=i[n];if(a){var c=u[n];t.push(h(c,a))}}Promise.all(t).then(function(t){for(var n=0,r=t.length;n<r;n++)t[n]&&e.onChange(t[n])}).catch(e.complete),v!==s&&r.continue()}()})})}function h(t,n){var r=e.processChange(n,t,e);a=r.seq=t.seq;var i=_(r);return"object"==typeof i?Promise.reject(i):i?(v++,e.return_docs&&d.push(r),e.attachments&&e.include_docs?new Promise(function(t){gr(n,e,c,function(){yr([r],e.binary).then(function(){t(r)})})}):Promise.resolve(r)):Promise.resolve()}})}var Br,Rr=new p,Tr=new p;function Nr(e,t){var n=this;Ir(function(t){Mr(n,e,t)},t,n.constructor)}function Mr(e,t,n){var i=t.name,o=null;function a(e,t){var n=e.objectStore(rr);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var i=r.value,o=gt(i);i.deletedOrLocal=o?"1":"0",n.put(i),r.continue()}else t()}}function s(e,t){var n=e.objectStore(cr),r=e.objectStore(rr),i=e.objectStore(ir);r.openCursor().onsuccess=function(e){var o=e.target.result;if(o){var a=o.value,s=a.id,c=yt(s),u=Ze(a);if(c){var f=s+"::"+u,l=s+"::",d=s+"::~",h=i.index("_doc_id_rev"),p=IDBKeyRange.bound(l,d,!1,!1),v=h.openCursor(p);v.onsuccess=function(e){if(v=e.target.result){var t=v.value;t._doc_id_rev===f&&n.put(t),i.delete(v.primaryKey),v.continue()}else r.delete(o.primaryKey),o.continue()}}else o.continue()}else t&&t()}}function c(e,t){var n=e.objectStore(ir),r=e.objectStore(or),i=e.objectStore(ar);r.count().onsuccess=function(e){if(!e.target.result)return t();n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,o=n.primaryKey,a=Object.keys(r._attachments||{}),s={},c=0;c<a.length;c++){s[r._attachments[a[c]].digest]=!0}var u=Object.keys(s);for(c=0;c<u.length;c++){var f=u[c];i.put({seq:o,digestSeq:f+"::"+o})}n.continue()}}}function u(e){var t=e.objectStore(ir),n=e.objectStore(rr);n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var i,o,a,s,c,u=(i=r.value).data?pr(i):(i.deleted="1"===i.deletedOrLocal,i);if(u.winningRev=u.winningRev||Ze(u),u.seq)return f();o=u.id+"::",a=u.id+"::",s=t.index("_doc_id_rev").openCursor(IDBKeyRange.bound(o,a)),c=0,s.onsuccess=function(e){var t=e.target.result;if(!t)return u.seq=c,f();var n=t.primaryKey;n>c&&(c=n),t.continue()}}function f(){var e=hr(u,u.winningRev,u.deleted);n.put(e).onsuccess=function(){r.continue()}}}}e._meta=null,e._remote=!1,e.type=function(){return"idb"},e._id=b(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,i){kr(t,n,r,e,o,i)},e._get=function(e,t,n){var r,i,a,s=t.ctx;if(!s){var c=br(o,[rr,ir,or],"readonly");if(c.error)return n(c.error);s=c.txn}function u(){n(a,{doc:r,metadata:i,ctx:s})}s.objectStore(rr).get(e).onsuccess=function(e){if(!(i=pr(e.target.result)))return a=pe(G,"missing"),u();var n;if(t.rev)n=t.latest?mt(t.rev,i):t.rev;else if(n=i.winningRev,gt(i))return a=pe(G,"deleted"),u();var o=s.objectStore(ir),c=i.id+"::"+n;o.index("_doc_id_rev").get(c).onsuccess=function(e){if((r=e.target.result)&&(r=vr(r)),!r)return a=pe(G,"missing"),u();u()}}},e._getAttachment=function(e,t,n,r,i){var a;if(r.ctx)a=r.ctx;else{var s=br(o,[rr,ir,or],"readonly");if(s.error)return i(s.error);a=s.txn}var c=n.digest,u=n.content_type;a.objectStore(or).get(c).onsuccess=function(e){_r(e.target.result.body,u,r.binary,function(e){i(null,e)})}},e._info=function(t){var n,r,i=br(o,[sr,ir],"readonly");if(i.error)return t(i.error);var a=i.txn;a.objectStore(sr).get(sr).onsuccess=function(e){r=e.target.result.docCount},a.objectStore(ir).openCursor(null,"prev").onsuccess=function(e){var t=e.target.result;n=t?t.key:0},a.oncomplete=function(){t(null,{doc_count:r,update_seq:n,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(e,t){Er(e,o,t)},e._changes=function(t){return Lr(t,e,i,o)},e._close=function(e){o.close(),Rr.delete(i),e()},e._getRevisionTree=function(e,t){var n=br(o,[rr],"readonly");if(n.error)return t(n.error);n.txn.objectStore(rr).get(e).onsuccess=function(e){var n=pr(e.target.result);n?t(null,n.rev_tree):t(pe(G))}},e._doCompaction=function(e,t,n){var r=br(o,[rr,ir,or,ar],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(rr).get(e).onsuccess=function(n){var r=pr(n.target.result);et(r.rev_tree,function(e,n,r,i,o){var a=n+"-"+r;-1!==t.indexOf(a)&&(o.status="missing")}),mr(t,e,i);var o=r.winningRev,a=r.deleted;i.objectStore(rr).put(hr(r,o,a))},i.onabort=dr(n),i.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=br(o,[cr],"readonly");if(n.error)return t(n.error);var r=n.txn.objectStore(cr).get(e);r.onerror=dr(t),r.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(pe(G))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,i=e._id;e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var a,s=t.ctx;if(!s){var c=br(o,[cr],"readwrite");if(c.error)return n(c.error);(s=c.txn).onerror=dr(n),s.oncomplete=function(){a&&n(null,a)}}var u,f=s.objectStore(cr);r?(u=f.get(i)).onsuccess=function(i){var o=i.target.result;o&&o._rev===r?f.put(e).onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)}:n(pe(Q))}:((u=f.add(e)).onerror=function(e){n(pe(Q)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)})},e._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={});var r,i=t.ctx;if(!i){var a=br(o,[cr],"readwrite");if(a.error)return n(a.error);(i=a.txn).oncomplete=function(){r&&n(null,r)}}var s=e._id,c=i.objectStore(cr),u=c.get(s);u.onerror=dr(n),u.onsuccess=function(i){var o=i.target.result;o&&o._rev===e._rev?(c.delete(s),r={ok:!0,id:s,rev:"0-0"},t.ctx&&n(null,r)):n(pe(G))}},e._destroy=function(e,t){wr.removeAllListeners(i);var n=Tr.get(i);n&&n.result&&(n.result.close(),Rr.delete(i));var r=indexedDB.deleteDatabase(i);r.onsuccess=function(){Tr.delete(i),L()&&i in localStorage&&delete localStorage[i],t(null,{ok:!0})},r.onerror=dr(t)};var f=Rr.get(i);if(f)return o=f.idb,e._meta=f.global,(0,r.default)(function(){n(null,e)});var l=indexedDB.open(i,nr);Tr.set(i,l),l.onupgradeneeded=function(e){var t=e.target.result;if(e.oldVersion<1)return function(e){var t=e.createObjectStore(rr,{keyPath:"id"});e.createObjectStore(ir,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(or,{keyPath:"digest"}),e.createObjectStore(sr,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(ur),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(cr,{keyPath:"_id"});var n=e.createObjectStore(ar,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var n=e.currentTarget.transaction;e.oldVersion<3&&function(e){e.createObjectStore(cr,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(t),e.oldVersion<4&&function(e){var t=e.createObjectStore(ar,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var r=[a,s,c,u],i=e.oldVersion;!function e(){var t=r[i-1];i++,t&&t(n,e)}()},l.onsuccess=function(t){(o=t.target.result).onversionchange=function(){o.close(),Rr.delete(i)},o.onabort=function(e){T("error","Database has a global failure",e.target.error),o.close(),Rr.delete(i)};var r,a,s,c,u=o.transaction([sr,ur,rr],"readwrite"),f=!1;function l(){void 0!==s&&f&&(e._meta={name:i,instanceId:c,blobSupport:s},Rr.set(i,{idb:o,global:e._meta}),n(null,e))}function d(){if(void 0!==a&&void 0!==r){var e=i+"_id";e in r?c=r[e]:r[e]=c=Xe(),r.docCount=a,u.objectStore(sr).put(r)}}u.objectStore(sr).get(sr).onsuccess=function(e){r=e.target.result||{id:sr},d()},xr(u,function(e){a=e,d()}),Br||(Br=Ar(u)),Br.then(function(e){s=e,l()}),u.oncomplete=function(){f=!0,l()},u.onabort=dr(n)},l.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";T("error",e),n(pe(ae,e))}}function Kr(e){e.adapter("idb",Nr,!0)}function Jr(e,t){return new Promise(function(n,r){var i,o=0,a=0,s=0,c=e.length;function u(){++s===c?i?r(i):n():d()}function f(){o--,u()}function l(e){o--,i=i||e,u()}function d(){for(;o<t&&a<c;)o++,e[a++]().then(f,l)}d()})}Nr.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(go){return!1}};var zr=25,Fr=50,Ur=5e3,Gr=1e4,Qr={};function Vr(e){var t=(e.doc||e.ok)._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];n.data=Re(n.data,n.content_type)})}function Wr(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Yr(e){return e._attachments&&Object.keys(e._attachments)?Promise.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new Promise(function(e){Ke(n.data,e)}).then(function(e){n.data=e})})):Promise.resolve()}function Hr(e){if(!e.prefix)return!1;var t=Ae(e.prefix).protocol;return"http"===t||"https"===t}function Xr(e,t){if(Hr(t)){var n=t.name.substr(t.prefix.length);e=t.prefix.replace(/\/?$/,"/")+encodeURIComponent(n)}var r=Ae(e);(r.user||r.password)&&(r.auth={username:r.user,password:r.password});var i=r.path.replace(/(^\/|\/$)/g,"").split("/");return r.db=i.pop(),-1===r.db.indexOf("%")&&(r.db=encodeURIComponent(r.db)),r.path=i.join("/"),r}function Zr(e,t){return ei(e,e.db+"/"+t)}function ei(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function ti(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function ni(e){var t="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",n=-1!==t.indexOf("msie"),r=-1!==t.indexOf("trident"),i=-1!==t.indexOf("edge"),o=!("method"in e)||"GET"===e.method;return(n||r||i)&&o}function ri(e,i){var o=this,a=Xr(e.name,e),s=Zr(a,"");e=y(e);var c,u=function(t,n){if((n=n||{}).headers=n.headers||new Tt,e.auth||a.auth){var r=e.auth||a.auth,i=r.username+":"+r.password,o=De(unescape(encodeURIComponent(i)));n.headers.set("Authorization","Basic "+o)}var s=e.headers||{};return Object.keys(s).forEach(function(e){n.headers.append(e,s[e])}),ni(n)&&(t+=(-1===t.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(e.fetch||Rt)(t,n)};function f(e,t){return k(e,(0,n.default)(function(e){d().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})})).bind(o)}function l(e,t,n){var r={};return(t=t||{}).headers=t.headers||new Tt,t.headers.get("Content-Type")||t.headers.set("Content-Type","application/json"),t.headers.get("Accept")||t.headers.set("Accept","application/json"),u(e,t).then(function(e){return r.ok=e.ok,r.status=e.status,e.json()}).then(function(e){if(r.data=e,!r.ok){r.data.status=r.status;var t=ve(r.data);if(n)return n(t);throw t}if(Array.isArray(r.data)&&(r.data=r.data.map(function(e){return e.error||e.missing?ve(e):e})),!n)return r;n(null,r.data)})}function d(){return e.skip_setup?Promise.resolve():c||((c=l(s).catch(function(e){return e&&e.status&&404===e.status?(K(404,"PouchDB is just detecting if the remote exists."),l(s,{method:"PUT"})):Promise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Promise.reject(e)})).catch(function(){c=null}),c)}function h(e){return e.split("/").map(encodeURIComponent).join("/")}(0,r.default)(function(){i(null,o)}),o._remote=!0,o.type=function(){return"http"},o.id=f("id",function(e){u(ei(a,"")).then(function(e){return e.json()}).then(function(t){var n=t&&t.uuid?t.uuid+a.db:Zr(a,"");e(null,n)}).catch(function(t){e(t)})}),o.compact=f("compact",function(e,t){"function"==typeof e&&(t=e,e={}),e=y(e),l(Zr(a,"_compact"),{method:"POST"}).then(function(){!function n(){o.info(function(r,i){i&&!i.compact_running?t(null,{ok:!0}):setTimeout(n,e.interval||200)})}()})}),o.bulkGet=k("bulkGet",function(e,t){var n=this;function r(t){var n={};e.revs&&(n.revs=!0),e.attachments&&(n.attachments=!0),e.latest&&(n.latest=!0),l(Zr(a,"_bulk_get"+ti(n)),{method:"POST",body:JSON.stringify({docs:e.docs})}).then(function(n){e.attachments&&e.binary&&n.data.results.forEach(function(e){e.docs.forEach(Vr)}),t(null,n.data)}).catch(t)}function i(){var r=Fr,i=Math.ceil(e.docs.length/r),o=0,a=new Array(i);function s(e){return function(n,r){a[e]=r.results,++o===i&&t(null,{results:ye(a)})}}for(var c=0;c<i;c++){var u=A(e,["revs","attachments","binary","latest"]);u.docs=e.docs.slice(c*r,Math.min(e.docs.length,(c+1)*r)),I(n,u,s(c))}}var o=ei(a,""),s=Qr[o];"boolean"!=typeof s?r(function(e,n){e?(Qr[o]=!1,K(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),i()):(Qr[o]=!0,t(null,n))}):s?r(t):i()}),o._info=function(e){d().then(function(){return u(Zr(a,""))}).then(function(e){return e.json()}).then(function(t){t.host=Zr(a,""),e(null,t)}).catch(e)},o.fetch=function(e,t){return d().then(function(){return u(Zr(a,e),t)})},o.get=f("get",function(e,n,r){"function"==typeof n&&(r=n,n={});var i={};function o(e){var r=e._attachments,i=r&&Object.keys(r);if(r&&i.length)return Jr(i.map(function(i){return function(){return function(i){var o=r[i],s=Wr(e._id)+"/"+h(i)+"?rev="+e._rev;return u(Zr(a,s)).then(function(e){return void 0===t||t.browser?e.blob():e.buffer()}).then(function(e){return n.binary?(void 0===t||t.browser||(e.type=o.content_type),e):new Promise(function(t){Ke(e,t)})}).then(function(e){delete o.stub,delete o.length,o.data=e})}(i)}}),5)}(n=y(n)).revs&&(i.revs=!0),n.revs_info&&(i.revs_info=!0),n.latest&&(i.latest=!0),n.open_revs&&("all"!==n.open_revs&&(n.open_revs=JSON.stringify(n.open_revs)),i.open_revs=n.open_revs),n.rev&&(i.rev=n.rev),n.conflicts&&(i.conflicts=n.conflicts),n.update_seq&&(i.update_seq=n.update_seq),e=Wr(e),l(Zr(a,e+ti(i))).then(function(e){return Promise.resolve().then(function(){if(n.attachments)return t=e.data,Array.isArray(t)?Promise.all(t.map(function(e){if(e.ok)return o(e.ok)})):o(t);var t}).then(function(){r(null,e.data)})}).catch(function(t){t.docId=e,r(t)})}),o.remove=f("remove",function(e,t,n,r){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(i=e,"function"==typeof t?(r=t,n={}):(r=n,n=t));var o=i._rev||n.rev;l(Zr(a,Wr(i._id))+"?rev="+o,{method:"DELETE"},r).catch(r)}),o.getAttachment=f("getAttachment",function(e,n,r,i){"function"==typeof r&&(i=r,r={});var o,s=r.rev?"?rev="+r.rev:"",c=Zr(a,Wr(e))+"/"+h(n)+s;u(c,{method:"GET"}).then(function(e){if(o=e.headers.get("content-type"),e.ok)return void 0===t||t.browser?e.blob():e.buffer();throw e}).then(function(e){void 0===t||t.browser||(e.type=o),i(null,e)}).catch(function(e){i(e)})}),o.removeAttachment=f("removeAttachment",function(e,t,n,r){l(Zr(a,Wr(e)+"/"+h(t))+"?rev="+n,{method:"DELETE"},r).catch(r)}),o.putAttachment=f("putAttachment",function(e,t,n,r,i,o){"function"==typeof i&&(o=i,i=r,r=n,n=null);var s=Wr(e)+"/"+h(t),c=Zr(a,s);if(n&&(c+="?rev="+n),"string"==typeof r){var u;try{u=$e(r)}catch(f){return o(pe(Z,"Attachment is not a valid base64 string"))}r=u?Be(u,i):""}l(c,{headers:new Tt({"Content-Type":i}),method:"PUT",body:r},o).catch(o)}),o._bulkDocs=function(e,t,n){e.new_edits=t.new_edits,d().then(function(){return Promise.all(e.docs.map(Yr))}).then(function(){return l(Zr(a,"_bulk_docs"),{method:"POST",body:JSON.stringify(e)},n)}).catch(n)},o._put=function(e,t,n){d().then(function(){return Yr(e)}).then(function(){return l(Zr(a,Wr(e._id)),{method:"PUT",body:JSON.stringify(e)})}).then(function(e){n(null,e.data)}).catch(function(t){t.docId=e&&e._id,n(t)})},o.allDocs=f("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var n,r={},i="GET";(e=y(e)).conflicts&&(r.conflicts=!0),e.update_seq&&(r.update_seq=!0),e.descending&&(r.descending=!0),e.include_docs&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.key&&(r.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(r.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(r.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(r.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(r.limit=e.limit),void 0!==e.skip&&(r.skip=e.skip);var o=ti(r);void 0!==e.keys&&(i="POST",n={keys:e.keys}),l(Zr(a,"_all_docs"+o),{method:i,body:JSON.stringify(n)}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.data.rows.forEach(Vr),t(null,n.data)}).catch(t)}),o._changes=function(e){var t="batch_size"in e?e.batch_size:zr;!(e=y(e)).continuous||"heartbeat"in e||(e.heartbeat=Gr);var n="timeout"in e?e.timeout:3e4;"timeout"in e&&e.timeout&&n-e.timeout<Ur&&(n=e.timeout+Ur),"heartbeat"in e&&e.heartbeat&&n-e.heartbeat<Ur&&(n=e.heartbeat+Ur);var i={};"timeout"in e&&e.timeout&&(i.timeout=e.timeout);var o=void 0!==e.limit&&e.limit,s=o;if(e.style&&(i.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(i.include_docs=!0),e.attachments&&(i.attachments=!0),e.continuous&&(i.feed="longpoll"),e.seq_interval&&(i.seq_interval=e.seq_interval),e.conflicts&&(i.conflicts=!0),e.descending&&(i.descending=!0),e.update_seq&&(i.update_seq=!0),"heartbeat"in e&&e.heartbeat&&(i.heartbeat=e.heartbeat),e.filter&&"string"==typeof e.filter&&(i.filter=e.filter),e.view&&"string"==typeof e.view&&(i.filter="_view",i.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(i[c]=e.query_params[c]);var u,f="GET";e.doc_ids?(i.filter="_doc_ids",f="POST",u={doc_ids:e.doc_ids}):e.selector&&(i.filter="_selector",f="POST",u={selector:e.selector});var h,p=new Bt,v=function(n,r){if(!e.aborted){i.since=n,"object"==typeof i.since&&(i.since=JSON.stringify(i.since)),e.descending?o&&(i.limit=s):i.limit=!o||s>t?t:s;var c=Zr(a,"_changes"+ti(i)),v={signal:p.signal,method:f,body:JSON.stringify(u)};h=n,e.aborted||d().then(function(){return l(c,v,r)}).catch(r)}},_={results:[]},g=function(n,i){if(!e.aborted){var a=0;if(i&&i.results){a=i.results.length,_.last_seq=i.last_seq;var c=null,u=null;"number"==typeof i.pending&&(c=i.pending),"string"!=typeof _.last_seq&&"number"!=typeof _.last_seq||(u=_.last_seq);e.query_params,i.results=i.results.filter(function(t){s--;var n=ge(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&Vr(t),e.return_docs&&_.results.push(t),e.onChange(t,c,u)),n})}else if(n)return e.aborted=!0,void e.complete(n);i&&i.last_seq&&(h=i.last_seq);var f=o&&s<=0||i&&a<t||e.descending;(!e.continuous||o&&s<=0)&&f?e.complete(null,_):(0,r.default)(function(){v(h,g)})}};return v(e.since||0,g),{cancel:function(){e.aborted=!0,p.abort()}}},o.revsDiff=f("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={}),l(Zr(a,"_revs_diff"),{method:"POST",body:JSON.stringify(e)},n).catch(n)}),o._close=function(e){e()},o._destroy=function(e,t){l(Zr(a,""),{method:"DELETE"}).then(function(e){t(null,e)}).catch(function(e){404===e.status?t(null,{ok:!0}):t(e)})}}function ii(e){e.adapter("http",ri,!1),e.adapter("https",ri,!1)}function oi(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,oi)}catch(go){}}function ai(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,ai)}catch(go){}}function si(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,si)}catch(go){}}function ci(e,t){return t&&e.then(function(e){(0,r.default)(function(){t(null,e)})},function(e){(0,r.default)(function(){t(e)})}),e}function ui(e){return(0,n.default)(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&ci(r,n),r})}function fi(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})}function li(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}}function di(e){var t=new h(e),n=new Array(t.size),r=-1;return t.forEach(function(e){n[++r]=e}),n}function hi(e){var t=new Array(e.size),n=-1;return e.forEach(function(e,r){t[++n]=r}),t}function pi(e){return new si("builtin "+e+" function requires map values to be numbers or number arrays")}function vi(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];if("number"!=typeof i){if(!Array.isArray(i))throw pi("_sum");t="number"==typeof t?[t]:t;for(var o=0,a=i.length;o<a;o++){var s=i[o];if("number"!=typeof s)throw pi("_sum");void 0===t[o]?t.push(s):t[o]+=s}}else"number"==typeof t?t+=i:t[0]+=i}return t}ri.valid=function(){return!0},(0,o.default)(oi,Error),(0,o.default)(ai,Error),(0,o.default)(si,Error);var _i=T.bind(null,"log"),gi=Array.isArray,yi=JSON.parse;function mi(e,t){return xe("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:vi,log:_i,isArray:gi,toJSON:yi})}function bi(){this.promise=new Promise(function(e){e()})}function wi(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function ki(e,t){return wi(e)+wi(t)+"undefined"}function qi(e,t,n,r,i,o){var a,s=ki(n,r);if(!i&&(a=e._cachedViews=e._cachedViews||{})[s])return a[s];var c=e.info().then(function(c){var u=c.db_name+"-mrview-"+(i?"temp":Ye(s));return Pe(e,"_local/"+o,function(e){e.views=e.views||{};var n=t;-1===n.indexOf("/")&&(n=t+"/"+t);var r=e.views[n]=e.views[n]||{};if(!r[u])return r[u]=!0,e}).then(function(){return e.registerDependentDatabase(u).then(function(t){var i=t.db;i.auto_compaction=!0;var o={name:u,db:i,sourceDB:e,adapter:e.adapter,mapFun:n,reduceFun:r};return o.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return o.seq=e?e.seq:0,a&&o.db.once("destroyed",function(){delete a[s]}),o})})})});return a&&(a[s]=c),c}bi.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},bi.prototype.finish=function(){return this.promise};var ji={},Oi=new bi,Si=50;function Ei(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function Ai(e){return 1===e.length&&/^1-/.test(e[0].rev)}function xi(e,t){try{e.emit("error",t)}catch(n){T("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),T("error",t)}}function Pi(e,t,n,i){function o(e,t,n){try{t(n)}catch(go){xi(e,go)}}function a(e,t,n,r,i){try{return{output:t(n,r,i)}}catch(go){return xi(e,go),{error:go}}}function s(e,t){var n=sn(e.key,t.key);return 0!==n?n:sn(e.value,t.value)}function c(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function u(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&function(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=Re(n.data,n.content_type)})})}(t),t}}function f(e,t,n,r){var i=t[e];void 0!==i&&(r&&(i=encodeURIComponent(JSON.stringify(i))),n.push(e+"="+i))}function l(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function d(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&sn(e[n],e[r])>0)throw new oi("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new oi("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new oi("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var n=function(e){if(e){if("number"!=typeof e)return new oi('Invalid value for integer: "'+e+'"');if(e<0)return new oi('Invalid value for positive integer: "'+e+'"')}}(e[t]);if(n)throw n})}function v(e){return function(t){if(404===t.status)return e;throw t}}function _(e,t,n){var r="_local/doc_"+e,i={_id:r,keys:[]},o=n.get(e),a=o[0];return(Ai(o[1])?Promise.resolve(i):t.db.get(r).catch(v(i))).then(function(e){return function(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):Promise.resolve({rows:[]})}(e).then(function(t){return function(e,t){for(var n=[],r=new h,i=0,o=t.rows.length;i<o;i++){var s=t.rows[i].doc;if(s&&(n.push(s),r.add(s._id),s._deleted=!a.has(s._id),!s._deleted)){var c=a.get(s._id);"value"in c&&(s.value=c.value)}}var u=hi(a);return u.forEach(function(e){if(!r.has(e)){var t={_id:e},i=a.get(e);"value"in i&&(t.value=i.value),n.push(t)}}),e.keys=di(u.concat(e.keys)),n.push(e),n}(e,t)})})}function g(e){var t="string"==typeof e?e:e.name,n=ji[t];return n||(n=ji[t]=new bi),n}function y(e){return li(g(e),function(){return function(e){var n,r;var i=t(e.mapFun,function(e,t){var i={id:r._id,key:cn(e)};null!=t&&(i.value=cn(t));n.push(i)}),a=e.seq||0;function c(t,n){return function(){return function(e,t,n){return e.db.get("_local/lastSeq").catch(v({_id:"_local/lastSeq",seq:0})).then(function(r){var i=hi(t);return Promise.all(i.map(function(n){return _(n,e,t)})).then(function(t){var i=ye(t);return r.seq=n,i.push(r),e.db.bulkDocs({docs:i})})})}(e,t,n)}}var u=new bi;function f(){return e.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:a,limit:Si}).then(l)}function l(t){var l=t.results;if(l.length){var h=function(t){for(var c=new p,u=0,f=t.length;u<f;u++){var l=t[u];if("_"!==l.doc._id[0]){n=[],(r=l.doc)._deleted||o(e.sourceDB,i,r),n.sort(s);var h=d(n);c.set(l.doc._id,[h,l.changes])}a=l.seq}return c}(l);if(u.add(c(h,a)),!(l.length<Si))return f()}}function d(e){for(var t,n=new p,r=0,i=e.length;r<i;r++){var o=e[r],a=[o.key,o.id];r>0&&0===sn(o.key,t)&&a.push(r),n.set(fn(a),o),t=o.key}return n}return f().then(function(){return u.finish()}).then(function(){e.seq=a})}(e)})()}function m(e,t){return li(g(e),function(){return function(e,t){var r,i=e.reduceFun&&!1!==t.reduce,o=t.skip||0;void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys);function s(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return r=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=hn(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function u(s){var u;if(u=i?function(e,t,r){0===r.group_level&&delete r.group_level;var i=r.group||r.group_level,o=n(e.reduceFun),s=[],c=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;t.forEach(function(e){var t=s[s.length-1],n=i?e.key:null;if(i&&Array.isArray(n)&&(n=n.slice(0,c)),t&&0===sn(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);s.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var u=0,f=s.length;u<f;u++){var l=s[u],d=a(e.sourceDB,o,l.keys,l.values,!1);if(d.error&&d.error instanceof si)throw d.error;t.push({value:d.error?null:d.output,key:l.groupKey})}return{rows:function(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}(t,r.limit,r.skip)}}(e,s,t):{total_rows:r,offset:o,rows:s},t.update_seq&&(u.update_seq=e.seq),t.include_docs){var f=di(s.map(c));return e.sourceDB.allDocs({keys:f,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t=new p;return e.rows.forEach(function(e){t.set(e.id,e.doc)}),s.forEach(function(e){var n=c(e),r=t.get(n);r&&(e.doc=r)}),u})}return u}if(void 0!==t.keys){var f=t.keys,l=f.map(function(e){var n={startkey:fn([e]),endkey:fn([e,{}])};return t.update_seq&&(n.update_seq=!0),s(n)});return Promise.all(l).then(ye).then(u)}var d,h,v={descending:t.descending};if(t.update_seq&&(v.update_seq=!0),"start_key"in t&&(d=t.start_key),"startkey"in t&&(d=t.startkey),"end_key"in t&&(h=t.end_key),"endkey"in t&&(h=t.endkey),void 0!==d&&(v.startkey=t.descending?fn([d,{}]):fn([d])),void 0!==h){var _=!1!==t.inclusive_end;t.descending&&(_=!_),v.endkey=fn(_?[h,{}]:[h])}if(void 0!==t.key){var g=fn([t.key]),y=fn([t.key,{}]);v.descending?(v.endkey=g,v.startkey=y):(v.startkey=g,v.endkey=y)}return i||("number"==typeof t.limit&&(v.limit=t.limit),v.skip=o),s(v).then(u)}(e,t)})()}function b(t,n,o){if("function"==typeof t._query)return function(e,t,n){return new Promise(function(r,i){e._query(t,n,function(e,t){if(e)return i(e);r(t)})})}(t,n,o);if(be(t))return function(e,t,n){var r,i,o,a=[],s="GET";if(f("reduce",n,a),f("include_docs",n,a),f("attachments",n,a),f("limit",n,a),f("descending",n,a),f("group",n,a),f("group_level",n,a),f("skip",n,a),f("stale",n,a),f("conflicts",n,a),f("startkey",n,a,!0),f("start_key",n,a,!0),f("endkey",n,a,!0),f("end_key",n,a,!0),f("inclusive_end",n,a),f("key",n,a,!0),f("update_seq",n,a),a=""===(a=a.join("&"))?"":"?"+a,void 0!==n.keys){var c="keys="+encodeURIComponent(JSON.stringify(n.keys));c.length+a.length+1<=2e3?a+=("?"===a[0]?"&":"?")+c:(s="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){var l=Ei(t);return e.fetch("_design/"+l[0]+"/_view/"+l[1]+a,{headers:new Tt({"Content-Type":"application/json"}),method:s,body:JSON.stringify(r)}).then(function(e){return i=e.ok,o=e.status,e.json()}).then(function(e){if(!i)throw e.status=o,ve(e);return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(u(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.fetch("_temp_view"+a,{headers:new Tt({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(r)}).then(function(e){return i=e.ok,o=e.status,e.json()}).then(function(e){if(!i)throw e.status=o,ve(e);return e}).then(u(n))}(t,n,o);if("string"!=typeof n)return d(o,n),Oi.add(function(){return qi(t,"temp_view/temp_view",n.map,n.reduce,!0,e).then(function(e){return fi(y(e).then(function(){return m(e,o)}),function(){return e.db.destroy()})})}),Oi.finish();var a=n,s=Ei(a),c=s[0],l=s[1];return t.get("_design/"+c).then(function(n){var s=n.views&&n.views[l];if(!s)throw new ai("ddoc "+n._id+" has no view named "+l);return i(n,l),d(o,s),qi(t,a,s.map,s.reduce,!1,e).then(function(e){return"ok"===o.stale||"update_after"===o.stale?("update_after"===o.stale&&(0,r.default)(function(){y(e)}),m(e,o)):y(e).then(function(){return m(e,o)})})})}return{query:function(e,t,n){var r=this;"function"==typeof t&&(n=t,t={}),t=t?function(e){return e.group_level=l(e.group_level),e.limit=l(e.limit),e.skip=l(e.skip),e}(t):{},"function"==typeof e&&(e={map:e});var i=Promise.resolve().then(function(){return b(r,e,t)});return ci(i,n),i},viewCleanup:ui(function(){var t=this;return"function"==typeof t._viewCleanup?function(e){return new Promise(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}(t):be(t)?function(e){return e.fetch("_view_cleanup",{headers:new Tt({"Content-Type":"application/json"}),method:"POST"}).then(function(e){return e.json()})}(t):function(t){return t.get("_local/"+e).then(function(e){var n=new p;Object.keys(e.views).forEach(function(e){var t=Ei(e),r="_design/"+t[0],i=t[1],o=n.get(r);o||(o=new h,n.set(r,o)),o.add(i)});var r={keys:hi(n),include_docs:!0};return t.allDocs(r).then(function(r){var i={};r.rows.forEach(function(t){var r=t.key.substring(8);n.get(t.key).forEach(function(n){var o=r+"/"+n;e.views[o]||(o=n);var a=Object.keys(e.views[o]),s=t.doc&&t.doc.views&&t.doc.views[n];a.forEach(function(e){i[e]=i[e]||s})})});var o=Object.keys(i).filter(function(e){return!i[e]}).map(function(e){return li(g(e),function(){return new t.constructor(e,t.__opts).destroy()})()});return Promise.all(o).then(function(){return{ok:!0}})})},v({ok:!0}))}(t)})}}var Ci={_sum:function(e,t){return vi(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:vi(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,n=0,r=e.length;n<r;n++){var i=e[n];t+=i*i}return t}(t)}}};function $i(e){if(/^_sum/.test(e))return Ci._sum;if(/^_count/.test(e))return Ci._count;if(/^_stats/.test(e))return Ci._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}function Di(e,t){if("function"==typeof e&&2===e.length){var n=e;return function(e){return n(e,t)}}return mi(e.toString(),t)}function Ii(e){var t=e.toString(),n=$i(t);return n||mi(t)}function Li(e,t){var n=e.views&&e.views[t];if("string"!=typeof n.map)throw new ai("ddoc "+e._id+" has no string view named "+t+", instead found object of type: "+typeof n.map)}var Bi="mrviews",Ri=Pi(Bi,Di,Ii,Li);function Ti(e,t,n){return Ri.query.call(this,e,t,n)}function Ni(e){return Ri.viewCleanup.call(this,e)}var Mi={query:Ti,viewCleanup:Ni};function Ki(e){return/^1-/.test(e)}function Ji(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function zi(e,t){var n=Object.keys(t._attachments);return Promise.all(n.map(function(n){return e.getAttachment(t._id,n,{rev:t._rev})}))}function Fi(e,t,n){var r=be(t)&&!be(e),i=Object.keys(n._attachments);return r?e.get(n._id).then(function(r){return Promise.all(i.map(function(i){return Ji(r,n,i)?t.getAttachment(n._id,i):e.getAttachment(r._id,i)}))}).catch(function(e){if(404!==e.status)throw e;return zi(t,n)}):zi(t,n)}function Ui(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0,latest:!0}}function Gi(e,t,n,r){n=y(n);var i=[],o=!0;function a(t){return e.allDocs({keys:t,include_docs:!0,conflicts:!0}).then(function(e){if(r.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t;e.deleted||!e.doc||!Ki(e.value.rev)||(t=e.doc,t._attachments&&Object.keys(t._attachments).length>0)||function(e){return e._conflicts&&e._conflicts.length>0}(e.doc)||(e.doc._conflicts&&delete e.doc._conflicts,i.push(e.doc),delete n[e.id])})})}return Promise.resolve().then(function(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&Ki(t[0])});if(e.length>0)return a(e)}).then(function(){var a=Ui(n);if(a.docs.length)return e.bulkGet(a).then(function(n){if(r.cancelled)throw new Error("cancelled");return Promise.all(n.results.map(function(n){return Promise.all(n.docs.map(function(n){var r=n.ok;return n.error&&(o=!1),r&&r._attachments?Fi(t,e,r).then(function(e){var t=Object.keys(r._attachments);return e.forEach(function(e,n){var i=r._attachments[t[n]];delete i.stub,delete i.length,i.data=e}),r}):r}))})).then(function(e){i=i.concat(ye(e).filter(Boolean))})})}).then(function(){return{ok:o,docs:i}})}var Qi=1,Vi="pouchdb",Wi=5,Yi=0;function Hi(e,t,n,r,i){return e.get(t).catch(function(n){if(404===n.status)return"http"!==e.adapter&&"https"!==e.adapter||K(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:Vi,version:Qi};throw n}).then(function(o){if(!i.cancelled&&o.last_seq!==n)return o.history=(o.history||[]).filter(function(e){return e.session_id!==r}),o.history.unshift({last_seq:n,session_id:r}),o.history=o.history.slice(0,Wi),o.version=Qi,o.replicator=Vi,o.session_id=r,o.last_seq=n,e.put(o).catch(function(o){if(409===o.status)return Hi(e,t,n,r,i);throw o})})}function Xi(e,t,n,r,i){this.src=e,this.target=t,this.id=n,this.returnValue=r,this.opts=i||{}}Xi.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},Xi.prototype.updateTarget=function(e,t){return this.opts.writeTargetCheckpoint?Hi(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)},Xi.prototype.updateSource=function(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return Hi(this.src,this.id,e,t,this.returnValue).catch(function(e){if(ro(e))return n.opts.writeSourceCheckpoint=!1,!0;throw e})}return Promise.resolve(!0)};var Zi={undefined:function(e,t){return 0===sn(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return eo(t,e).last_seq}};function eo(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:to(e.history,t.history)}function to(e,t){var n=e[0],r=e.slice(1),i=t[0],o=t.slice(1);return n&&0!==t.length?no(n.session_id,t)?{last_seq:n.last_seq,history:e}:no(i.session_id,r)?{last_seq:i.last_seq,history:o}:to(r,o):{last_seq:Yi,history:[]}}function no(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||no(e,r))}function ro(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}Xi.prototype.getCheckpoint=function(){var e=this;return e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(e){return e.last_seq||Yi}).catch(function(e){if(404!==e.status)throw e;return Yi}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||Yi:e.src.get(e.id).then(function(e){return t.version!==e.version?Yi:(n=t.version?t.version.toString():"undefined")in Zi?Zi[n](t,e):Yi;var n},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:Yi}).then(function(){return Yi},function(n){return ro(n)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):Yi});throw n})}).catch(function(e){if(404!==e.status)throw e;return Yi})};var io=0;function oo(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=M),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var i=function(){e.current_back_off=io};t.once("paused",function(){t.removeListener("active",i)}),t.once("active",i)}e.current_back_off=e.current_back_off||io,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function ao(e){return Object.keys(e).sort(sn).reduce(function(t,n){return t[n]=e[n],t},{})}function so(e,t,n){var r=n.doc_ids?n.doc_ids.sort(sn):"",i=n.filter?n.filter.toString():"",o="",a="",s="";return n.selector&&(s=JSON.stringify(n.selector)),n.filter&&n.query_params&&(o=JSON.stringify(ao(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),Promise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+i+a+o+r+s;return new Promise(function(e){We(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function co(e,t,n,i,o){var a,s,c,u=[],f={seq:0,changes:[],docs:[]},l=!1,d=!1,h=!1,p=0,v=n.continuous||n.live||!1,_=n.batch_size||100,g=n.batches_limit||10,m=!1,b=n.doc_ids,w=n.selector,k=[],q=Xe();o=o||{ok:!0,start_time:(new Date).toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var j={};function O(){return c?Promise.resolve():so(e,t,n).then(function(r){s=r;var o={};o=!1===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===n.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===n.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},c=new Xi(e,t,s,i,o)})}function S(){if(k=[],0!==a.docs.length){var e=a.docs,r={timeout:n.timeout};return t.bulkDocs({docs:e,new_edits:!1},r).then(function(t){if(i.cancelled)throw $(),new Error("cancelled");var n=Object.create(null);t.forEach(function(e){e.error&&(n[e.id]=e)});var r=Object.keys(n).length;o.doc_write_failures+=r,o.docs_written+=e.length-r,e.forEach(function(e){var t=n[e._id];if(t){o.errors.push(t);var r=(t.name||"").toLowerCase();if("unauthorized"!==r&&"forbidden"!==r)throw t;i.emit("denied",y(t))}else k.push(e)})},function(t){throw o.doc_write_failures+=e.length,t})}}function E(){if(a.error)throw new Error("There was a problem getting docs.");o.last_seq=p=a.seq;var e=y(o);return k.length&&(e.docs=k,"number"==typeof a.pending&&(e.pending=a.pending,delete a.pending),i.emit("change",e)),l=!0,c.writeCheckpoint(a.seq,q).then(function(){if(l=!1,i.cancelled)throw $(),new Error("cancelled");a=void 0,B()}).catch(function(e){throw T(e),e})}function A(){return Gi(e,t,a.diffs,i).then(function(e){a.error=!e.ok,e.docs.forEach(function(e){delete a.diffs[e._id],o.docs_read++,a.docs.push(e)})})}function x(){var e;i.cancelled||a||(0!==u.length?(a=u.shift(),(e={},a.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(i.cancelled)throw $(),new Error("cancelled");a.diffs=e})).then(A).then(S).then(E).then(x).catch(function(e){C("batch processing terminated with error",e)})):P(!0))}function P(e){0!==f.changes.length?(e||d||f.changes.length>=_)&&(u.push(f),f={seq:0,changes:[],docs:[]},"pending"!==i.state&&"stopped"!==i.state||(i.state="active",i.emit("active")),x()):0!==u.length||a||((v&&j.live||d)&&(i.state="pending",i.emit("paused")),d&&$())}function C(e,t){h||(t.message||(t.message=e),o.ok=!1,o.status="aborting",u=[],f={seq:0,changes:[],docs:[]},$(t))}function $(r){if(!(h||i.cancelled&&(o.status="cancelled",l)))if(o.status=o.status||"complete",o.end_time=(new Date).toISOString(),o.last_seq=p,h=!0,r){(r=pe(r)).result=o;var a=(r.name||"").toLowerCase();"unauthorized"===a||"forbidden"===a?(i.emit("error",r),i.removeAllListeners()):oo(n,i,r,function(){co(e,t,n,i)})}else i.emit("complete",o),i.removeAllListeners()}function D(e,t,o){if(i.cancelled)return $();"number"==typeof t&&(f.pending=t),ge(n)(e)&&(f.seq=e.seq||o,f.changes.push(e),(0,r.default)(function(){P(0===u.length&&j.live)}))}function I(e){if(m=!1,i.cancelled)return $();if(e.results.length>0)j.since=e.results[e.results.length-1].seq,B(),P(!0);else{var t=function(){v?(j.live=!0,B()):d=!0,P(!0)};a||0!==e.results.length?t():(l=!0,c.writeCheckpoint(e.last_seq,q).then(function(){l=!1,o.last_seq=p=e.last_seq,t()}).catch(T))}}function L(e){if(m=!1,i.cancelled)return $();C("changes rejected",e)}function B(){if(!m&&!d&&u.length<g){m=!0,i._changes&&(i.removeListener("cancel",i._abortChanges),i._changes.cancel()),i.once("cancel",r);var t=e.changes(j).on("change",D);t.then(o,o),t.then(I).catch(L),n.retry&&(i._changes=t,i._abortChanges=r)}function r(){t.cancel()}function o(){i.removeListener("cancel",r)}}function R(){O().then(function(){if(!i.cancelled)return c.getCheckpoint().then(function(e){j={since:p=e,limit:_,batch_size:_,style:"all_docs",doc_ids:b,selector:w,return_docs:!0},n.filter&&("string"!=typeof n.filter?j.include_docs=!0:j.filter=n.filter),"heartbeat"in n&&(j.heartbeat=n.heartbeat),"timeout"in n&&(j.timeout=n.timeout),n.query_params&&(j.query_params=n.query_params),n.view&&(j.view=n.view),B()});$()}).catch(function(e){C("getCheckpoint rejected with ",e)})}function T(e){l=!1,C("writeCheckpoint completed with error",e)}i.ready(e,t),i.cancelled?$():(i._addedListeners||(i.once("cancel",$),"function"==typeof n.complete&&(i.once("error",n.complete),i.once("complete",function(e){n.complete(null,e)})),i._addedListeners=!0),void 0===n.since?R():O().then(function(){return l=!0,c.writeCheckpoint(n.since,q)}).then(function(){l=!1,i.cancelled?$():(p=n.since,R())}).catch(T))}function uo(){i.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new Promise(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function fo(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function lo(e,t,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw pe(re,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=y(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var i=new uo(n);return co(fo(e,n),fo(t,n),n,i),i}function ho(e,t,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),(n=y(n)).PouchConstructor=n.PouchConstructor||this,new po(e=fo(e,n),t=fo(t,n),n,r)}function po(e,t,n,r){var i=this;this.canceled=!1;var o=n.push?J({},n,n.push):n,a=n.pull?J({},n,n.pull):n;function s(e){i.emit("change",{direction:"pull",change:e})}function c(e){i.emit("change",{direction:"push",change:e})}function u(e){i.emit("denied",{direction:"push",doc:e})}function f(e){i.emit("denied",{direction:"pull",doc:e})}function l(){i.pushPaused=!0,i.pullPaused&&i.emit("paused")}function d(){i.pullPaused=!0,i.pushPaused&&i.emit("paused")}function h(){i.pushPaused=!1,i.pullPaused&&i.emit("active",{direction:"push"})}function p(){i.pullPaused=!1,i.pushPaused&&i.emit("active",{direction:"pull"})}this.push=lo(e,t,o),this.pull=lo(t,e,a),this.pushPaused=!0,this.pullPaused=!0;var v={};function _(e){return function(t,n){("change"===t&&(n===s||n===c)||"denied"===t&&(n===f||n===u)||"paused"===t&&(n===d||n===l)||"active"===t&&(n===p||n===h))&&(t in v||(v[t]={}),v[t][e]=!0,2===Object.keys(v[t]).length&&i.removeAllListeners(t))}}function g(e,t,n){-1==e.listeners(t).indexOf(n)&&e.on(t,n)}n.live&&(this.push.on("complete",i.pull.cancel.bind(i.pull)),this.pull.on("complete",i.push.cancel.bind(i.push))),this.on("newListener",function(e){"change"===e?(g(i.pull,"change",s),g(i.push,"change",c)):"denied"===e?(g(i.pull,"denied",f),g(i.push,"denied",u)):"active"===e?(g(i.pull,"active",p),g(i.push,"active",h)):"paused"===e&&(g(i.pull,"paused",d),g(i.push,"paused",l))}),this.on("removeListener",function(e){"change"===e?(i.pull.removeListener("change",s),i.push.removeListener("change",c)):"denied"===e?(i.pull.removeListener("denied",f),i.push.removeListener("denied",u)):"active"===e?(i.pull.removeListener("active",p),i.push.removeListener("active",h)):"paused"===e&&(i.pull.removeListener("paused",d),i.push.removeListener("paused",l))}),this.pull.on("removeListener",_("pull")),this.push.on("removeListener",_("push"));var y=Promise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return i.emit("complete",t),r&&r(null,t),i.removeAllListeners(),t},function(e){if(i.cancel(),r?r(e):i.emit("error",e),i.removeAllListeners(),r)throw e});this.then=function(e,t){return y.then(e,t)},this.catch=function(e){return y.catch(e)}}function vo(e){e.replicate=lo,e.sync=ho,Object.defineProperty(e.prototype,"replicate",{get:function(){var e=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(t,n,r){return e.constructor.replicate(t,e,n,r)},to:function(t,n,r){return e.constructor.replicate(e,t,n,r)}}),this.replicateMethods}}),e.prototype.sync=function(e,t,n){return this.constructor.sync(this,e,t,n)}}(0,o.default)(uo,i.EventEmitter),uo.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},uo.prototype.ready=function(e,t){var n=this;function r(){n.cancel()}n._readyCalled||(n._readyCalled=!0,e.once("destroyed",r),t.once("destroyed",r),n.once("complete",function(){e.removeListener("destroyed",r),t.removeListener("destroyed",r)}))},(0,o.default)(po,i.EventEmitter),po.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},Lt.plugin(Kr).plugin(ii).plugin(Mi).plugin(vo);var _o=Lt;exports.default=_o;
},{"argsarray":"uOR/","immediate":"EK2n","events":"wIHY","inherits":"oxw+","spark-md5":"AoQO","uuid":"kXoK","vuvuzela":"9d90","process":"g5I+"}],"vXuq":[function(require,module,exports) {
"use strict";function t(t){return"$"+t}function e(t){return t.substring(1)}function r(){this._store={}}function o(t){if(this._store=new r,t&&Array.isArray(t))for(var e=0,o=t.length;e<o;e++)this.add(t[e])}function n(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}var s,i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.Map=exports.Set=void 0,r.prototype.get=function(e){var r=t(e);return this._store[r]},r.prototype.set=function(e,r){var o=t(e);return this._store[o]=r,!0},r.prototype.has=function(e){return t(e)in this._store},r.prototype.delete=function(e){var r=t(e),o=r in this._store;return delete this._store[r],o},r.prototype.forEach=function(t){for(var r=Object.keys(this._store),o=0,n=r.length;o<n;o++){var s=r[o];t(this._store[s],s=e(s))}},Object.defineProperty(r.prototype,"size",{get:function(){return Object.keys(this._store).length}}),o.prototype.add=function(t){return this._store.set(t,!0)},o.prototype.has=function(t){return this._store.has(t)},o.prototype.forEach=function(t){this._store.forEach(function(e,r){t(r)})},Object.defineProperty(o.prototype,"size",{get:function(){return this._store.size}}),exports.Set=s,exports.Map=i,n()?(exports.Set=s=Set,exports.Map=i=Map):(exports.Set=s=o,exports.Map=i=r);
},{}],"eFvv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createError=A,exports.generateErrorFromResponse=L,exports.INVALID_URL=exports.IDB_ERROR=exports.MISSING_STUB=exports.FILE_EXISTS=exports.INVALID_REV=exports.FORBIDDEN=exports.LDB_ERROR=exports.WSQ_ERROR=exports.DB_MISSING=exports.NOT_AN_OBJECT=exports.BAD_REQUEST=exports.DOC_VALIDATION=exports.QUERY_PARSE_ERROR=exports.INVALID_REQUEST=exports.BAD_ARG=exports.UNKNOWN_ERROR=exports.NOT_OPEN=exports.RESERVED_ID=exports.MISSING_ID=exports.INVALID_ID=exports.REV_CONFLICT=exports.MISSING_DOC=exports.MISSING_BULK_DOCS=exports.UNAUTHORIZED=void 0;var e=r(require("inherits"));function r(e){return e&&e.__esModule?e:{default:e}}function t(e,r,t){Error.call(this,t),this.status=e,this.name=r,this.message=t,this.error=!0}(0,e.default)(t,Error),t.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var s=new t(401,"unauthorized","Name or password is incorrect.");exports.UNAUTHORIZED=s;var o=new t(400,"bad_request","Missing JSON list of 'docs'");exports.MISSING_BULK_DOCS=o;var n=new t(404,"not_found","missing");exports.MISSING_DOC=n;var a=new t(409,"conflict","Document update conflict");exports.REV_CONFLICT=a;var i=new t(400,"bad_request","_id field must contain a string");exports.INVALID_ID=i;var _=new t(412,"missing_id","_id is required for puts");exports.MISSING_ID=_;var p=new t(400,"bad_request","Only reserved document ids may start with underscore.");exports.RESERVED_ID=p;var d=new t(412,"precondition_failed","Database not open");exports.NOT_OPEN=d;var u=new t(500,"unknown_error","Database encountered an unknown error");exports.UNKNOWN_ERROR=u;var I=new t(500,"badarg","Some query argument is invalid");exports.BAD_ARG=I;var R=new t(400,"invalid_request","Request was invalid");exports.INVALID_REQUEST=R;var x=new t(400,"query_parse_error","Some query parameter is invalid");exports.QUERY_PARSE_ERROR=x;var E=new t(500,"doc_validation","Bad special document member");exports.DOC_VALIDATION=E;var D=new t(400,"bad_request","Something wrong with the request");exports.BAD_REQUEST=D;var S=new t(400,"bad_request","Document must be a JSON object");exports.NOT_AN_OBJECT=S;var N=new t(404,"not_found","Database not found");exports.DB_MISSING=N;var v=new t(500,"indexed_db_went_bad","unknown");exports.IDB_ERROR=v;var w=new t(500,"web_sql_went_bad","unknown");exports.WSQ_ERROR=w;var c=new t(500,"levelDB_went_went_bad","unknown");exports.LDB_ERROR=c;var O=new t(403,"forbidden","Forbidden by design doc validate_doc_update function");exports.FORBIDDEN=O;var l=new t(400,"bad_request","Invalid rev format");exports.INVALID_REV=l;var m=new t(412,"file_exists","The database could not be created, the file already exists.");exports.FILE_EXISTS=m;var f=new t(412,"missing_stub","A pre-existing attachment stub wasn't found");exports.MISSING_STUB=f;var b=new t(413,"invalid_url","Provided URL is invalid");function A(e,r){function s(r){for(var t in e)"function"!=typeof e[t]&&(this[t]=e[t]);void 0!==r&&(this.reason=r)}return s.prototype=t.prototype,new s(r)}function L(e){if("object"!=typeof e){var r=e;(e=u).data=r}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}exports.INVALID_URL=b;
},{"inherits":"oxw+"}],"1zQ3":[function(require,module,exports) {
var e,r,o=require("./lib/rng"),s=require("./lib/bytesToUuid"),i=0,n=0;function c(c,l,u){var v=l&&u||0,a=l||[],d=(c=c||{}).node||e,t=void 0!==c.clockseq?c.clockseq:r;if(null==d||null==t){var m=o();null==d&&(d=e=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==t&&(t=r=16383&(m[6]<<8|m[7]))}var q=void 0!==c.msecs?c.msecs:(new Date).getTime(),f=void 0!==c.nsecs?c.nsecs:n+1,b=q-i+(f-n)/1e4;if(b<0&&void 0===c.clockseq&&(t=t+1&16383),(b<0||q>i)&&void 0===c.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=q,n=f,r=t;var k=(1e4*(268435455&(q+=122192928e5))+f)%4294967296;a[v++]=k>>>24&255,a[v++]=k>>>16&255,a[v++]=k>>>8&255,a[v++]=255&k;var w=q/4294967296*1e4&268435455;a[v++]=w>>>8&255,a[v++]=255&w,a[v++]=w>>>24&15|16,a[v++]=w>>>16&255,a[v++]=t>>>8|128,a[v++]=255&t;for(var g=0;g<6;++g)a[v+g]=d[g];return l||s(a)}module.exports=c;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"ZAp3":[function(require,module,exports) {
var r=require("./lib/rng"),n=require("./lib/bytesToUuid");function e(e,i,u){var a=i&&u||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,i)for(var o=0;o<16;++o)i[a+o]=l[o];return i||n(l)}module.exports=e;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"myOz":[function(require,module,exports) {
var e=require("./v1"),r=require("./v4"),v=r;v.v1=e,v.v4=r,module.exports=v;
},{"./v1":"1zQ3","./v4":"ZAp3"}],"84bl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.base64StringToBlobOrBuffer=f,exports.binaryStringToArrayBuffer=t,exports.binaryStringToBlobOrBuffer=o,exports.blob=n,exports.blobOrBufferToBase64=B,exports.blobOrBufferToBinaryString=a,exports.readAsArrayBuffer=d,exports.readAsBinaryString=i,exports.typedBuffer=l,exports.btoa=exports.atob=void 0;var r=function(r){return atob(r)};exports.atob=r;var e=function(r){return btoa(r)};function n(r,e){r=r||[],e=e||{};try{return new Blob(r,e)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),t=0;t<r.length;t+=1)n.append(r[t]);return n.getBlob(e.type)}}function t(r){for(var e=r.length,n=new ArrayBuffer(e),t=new Uint8Array(n),o=0;o<e;o++)t[o]=r.charCodeAt(o);return n}function o(r,e){return n([t(r)],{type:e})}function f(e,n){return o(r(e),n)}function u(r){for(var e="",n=new Uint8Array(r),t=n.byteLength,o=0;o<t;o++)e+=String.fromCharCode(n[o]);return e}function i(r,e){var n=new FileReader,t="function"==typeof n.readAsBinaryString;n.onloadend=function(r){var n=r.target.result||"";if(t)return e(n);e(u(n))},t?n.readAsBinaryString(r):n.readAsArrayBuffer(r)}function a(r,e){i(r,function(r){e(r)})}function B(r,n){a(r,function(r){n(e(r))})}function d(r,e){var n=new FileReader;n.onloadend=function(r){var n=r.target.result||new ArrayBuffer(0);e(n)},n.readAsArrayBuffer(r)}function l(){}exports.btoa=e;
},{}],"Xfmb":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.binaryMd5=c,exports.stringMd5=d;var n=require("pouchdb-binary-utils"),t=r(require("spark-md5"));function r(e){return e&&e.__esModule?e:{default:e}}var i=e.setImmediate||e.setTimeout,u=32768;function a(e){return(0,n.btoa)(e)}function o(e,n,t){return e.webkitSlice?e.webkitSlice(n,t):e.slice(n,t)}function f(e,t,r,i,u){(r>0||i<t.size)&&(t=o(t,r,i)),(0,n.readAsArrayBuffer)(t,function(n){e.append(n),u()})}function s(e,n,t,r,i){(t>0||r<n.length)&&(n=n.substring(t,r)),e.appendBinary(n),i()}function c(e,n){var r="string"==typeof e,o=r?e.length:e.size,c=Math.min(u,o),d=Math.ceil(o/c),l=0,p=r?new t.default:new t.default.ArrayBuffer,b=r?s:f;function y(){i(v)}function h(){var e=a(p.end(!0));n(e),p.destroy()}function v(){var n=l*c,t=n+c;b(p,e,n,t,++l<d?y:h)}v()}function d(e){return t.default.hash(e)}
},{"pouchdb-binary-utils":"84bl","spark-md5":"AoQO"}],"alES":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.adapterFun=x,exports.bulkGetShim=j,exports.changesHandler=k,exports.clone=y,exports.defaultBackOff=L,exports.explainError=B,exports.filterChange=N,exports.flatten=F,exports.guardedConsole=A,exports.hasLocalStorage=I,exports.invalidIdError=G,exports.isRemote=V,exports.listenerCount=W,exports.normalizeDdocFunctionName=J,exports.once=g,exports.parseDdocFunctionName=H,exports.parseUri=Y,exports.pick=b,exports.rev=re,exports.scopeEval=Z,exports.toPromise=m,exports.upsert=ee,Object.defineProperty(exports,"nextTick",{enumerable:!0,get:function(){return r.default}}),exports.uuid=exports.functionName=exports.assign=void 0;var e=s(require("argsarray")),t=require("pouchdb-collections"),r=s(require("immediate")),n=require("events"),o=s(require("inherits")),i=require("pouchdb-errors"),u=s(require("uuid")),a=require("pouchdb-md5"),c=require("pouchdb-utils");function s(e){return e&&e.__esModule?e:{default:e}}function f(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function l(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}function p(e){if(e instanceof ArrayBuffer)return l(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}var d=Function.prototype.toString,h=d.call(Object);function v(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&d.call(r)==h}function y(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=y(e[r]);return t}if(e instanceof Date)return e.toISOString();if(f(e))return p(e);if(!v(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=y(e[r]);void 0!==o&&(t[r]=o)}return t}function g(t){var r=!1;return(0,e.default)(function(e){if(r)throw new Error("once called more than once");r=!0,t.apply(this,e)})}function m(t){return(0,e.default)(function(e){e=y(e);var r=this,n="function"==typeof e[e.length-1]&&e.pop(),o=new Promise(function(n,o){var i;try{var u=g(function(e,t){e?o(e):n(t)});e.push(u),(i=t.apply(r,e))&&"function"==typeof i.then&&n(i)}catch(a){o(a)}});return n&&o.then(function(e){n(null,e)},n),o})}function _(e,t,r){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,t],o=0;o<r.length-1;o++)n.push(r[o]);e.constructor.emit("debug",n);var i=r[r.length-1];r[r.length-1]=function(r,n){var o=["api",e.name,t];o=o.concat(r?["error",r]:["success",n]),e.constructor.emit("debug",o),i(r,n)}}}function x(t,r){return m((0,e.default)(function(e){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return _(n,t,e),this.taskqueue.isReady?r.apply(this,e):new Promise(function(r,o){n.taskqueue.addTask(function(i){i?o(i):r(n[t].apply(n,e))})})}))}function b(e,t){for(var r={},n=0,o=t.length;n<o;n++){var i=t[n];i in e&&(r[i]=e[i])}return r}var w,E,q=6;function O(e){return e}function S(e){return[{ok:e}]}function j(e,r,n){var o=r.docs,i=new t.Map;o.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var u=i.size,a=0,c=new Array(u);function s(){var e;++a===u&&(e=[],c.forEach(function(t){t.docs.forEach(function(r){e.push({id:t.id,docs:[r]})})}),n(null,{results:e}))}var f=[];i.forEach(function(e,t){f.push(t)});var l=0;function p(){if(!(l>=f.length)){var t=Math.min(l+q,f.length),n=f.slice(l,t);!function(t,n){t.forEach(function(t,o){var u=n+o,a=i.get(t),f=b(a[0],["atts_since","attachments"]);f.open_revs=a.map(function(e){return e.rev}),f.open_revs=f.open_revs.filter(O);var l=O;0===f.open_revs.length&&(delete f.open_revs,l=S),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in r&&(f[e]=r[e])}),e.get(t,f,function(e,r){var n,o,i;n=e?[{error:e}]:l(r),o=t,i=n,c[u]={id:o,docs:i},s(),p()})})}(n,l),l+=n.length}}p()}try{localStorage.setItem("_pouch_check_localstorage",1),w=!!localStorage.getItem("_pouch_check_localstorage")}catch(oe){w=!1}function I(){return w}function P(e){I()&&addEventListener("storage",function(t){e.emit(t.key)})}function k(){n.EventEmitter.call(this),this._listeners={},P(this)}function A(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function D(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function L(e){var t=0;return e||(t=2e3),D(e,t)}function B(e,t){A("info","The above "+e+" is totally normal. "+t)}(0,o.default)(k,n.EventEmitter),k.prototype.addListener=function(e,t,n,o){if(!this._listeners[t]){var i=this,u=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(i._listeners[t])if(u)u="waiting";else{u=!0;var e=b(o,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>o.since&&!o.cancelled&&(o.since=e.seq,o.onChange(e))}).on("complete",function(){"waiting"===u&&(0,r.default)(a),u=!1}).on("error",function(){u=!1})}}},k.prototype.removeListener=function(e,t){t in this._listeners&&(n.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},k.prototype.notifyLocalWindows=function(e){I()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},k.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var C=E="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function M(e,t,r){try{return!e(t,r)}catch(o){var n="Filter function threw: "+o.toString();return(0,i.createError)(i.BAD_REQUEST,n)}}function N(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&M(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in n.doc._attachments)n.doc._attachments.hasOwnProperty(i)&&(n.doc._attachments[i].stub=!0)}else delete n.doc;return!0}}function F(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t}function R(){}exports.assign=C;var U,T=R.name,z=U=T?function(e){return e.name}:function(e){var t=e.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""};function G(e){var t;if(e?"string"!=typeof e?t=(0,i.createError)(i.INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=(0,i.createError)(i.RESERVED_ID)):t=(0,i.createError)(i.MISSING_ID),t)throw t}function V(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(A("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function W(e,t){return"listenerCount"in e?e.listenerCount(t):n.EventEmitter.listenerCount(e,t)}function H(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function J(e){var t=H(e);return t?t.join("/"):null}exports.functionName=z;var K=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Q="queryKey",$=/(?:^|&)([^&=]*)=?([^&]*)/g,X=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Y(e){for(var t=X.exec(e),r={},n=14;n--;){var o=K[n],i=t[n]||"",u=-1!==["user","password"].indexOf(o);r[o]=u?decodeURIComponent(i):i}return r[Q]={},r[K[12]].replace($,function(e,t,n){t&&(r[Q][t]=n)}),r}function Z(e,t){var r=[],n=[];for(var o in t)t.hasOwnProperty(o)&&(r.push(o),n.push(t[o]));return r.push(e),Function.apply(null,r).apply(null,n)}function ee(e,t,r){return new Promise(function(n,o){e.get(t,function(i,u){if(i){if(404!==i.status)return o(i);u={}}var a=u._rev,c=r(u);if(!c)return n({updated:!1,rev:a});c._id=t,c._rev=a,n(te(e,c,r))})})}function te(e,t,r){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return ee(e,t._id,r)})}function re(e,t){var r=(0,c.clone)(e);return t?(delete r._rev_tree,(0,a.stringMd5)(JSON.stringify(r))):u.default.v4().replace(/-/g,"").toLowerCase()}var ne=u.default.v4;exports.uuid=ne;
},{"argsarray":"uOR/","pouchdb-collections":"vXuq","immediate":"EK2n","events":"wIHY","inherits":"oxw+","pouchdb-errors":"eFvv","uuid":"myOz","pouchdb-md5":"Xfmb","pouchdb-utils":"alES"}],"+SOi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbortController=exports.Headers=exports.fetch=void 0;var e="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}};exports.AbortController=e;var r=fetch;exports.fetch=r;var t=Headers;exports.Headers=t;
},{}],"xAsV":[function(require,module,exports) {
"use strict";function e(e,r,n){for(var t="",a=n-e.length;t.length<a;)t+=r;return t}function r(r,n,t){return e(r,n,t)+r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.collate=u,exports.normalizeKey=l,exports.toIndexableString=s,exports.parseIndexableString=f;var n=-324,t=3,a="";function u(e,r){if(e===r)return 0;e=l(e),r=l(r);var n=v(e),t=v(r);if(n-t!=0)return n-t;switch(typeof e){case"number":return e-r;case"boolean":return e<r?-1:1;case"string":return h(e,r)}return Array.isArray(e)?p(e,r):g(e,r)}function l(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var r=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var t=0;t<n;t++)e[t]=l(r[t])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var a in e={},r)if(r.hasOwnProperty(a)){var u=r[a];void 0!==u&&(e[a]=l(u))}}}return e}function i(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return b(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var r=Array.isArray(e),n=r?e:Object.keys(e),t=-1,a=n.length,u="";if(r)for(;++t<a;)u+=s(n[t]);else for(;++t<a;){var l=n[t];u+=s(l)+s(e[l])}return u}return""}function s(e){return v(e=l(e))+a+i(e)+"\0"}function o(e,r){var a,u=r;if("1"===e[r])a=0,r++;else{var l="0"===e[r];r++;var i="",s=e.substring(r,r+t),o=parseInt(s,10)+n;for(l&&(o=-o),r+=t;;){var c=e[r];if("\0"===c)break;i+=c,r++}a=1===(i=i.split(".")).length?parseInt(i,10):parseFloat(i[0]+"."+i[1]),l&&(a-=10),0!==o&&(a=parseFloat(a+"e"+o))}return{num:a,length:r-u}}function c(e,r){var n=e.pop();if(r.length){var t=r[r.length-1];n===t.element&&(r.pop(),t=r[r.length-1]);var a=t.element,u=t.index;if(Array.isArray(a))a.push(n);else if(u===e.length-2){a[e.pop()]=n}else e.push(n)}}function f(e){for(var r=[],n=[],t=0;;){var a=e[t++];if("\0"!==a)switch(a){case"1":r.push(null);break;case"2":r.push("1"===e[t]),t++;break;case"3":var u=o(e,t);r.push(u.num),t+=u.length;break;case"4":for(var l="";;){var i=e[t];if("\0"===i)break;l+=i,t++}l=l.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(l);break;case"5":var s={element:[],index:r.length};r.push(s.element),n.push(s);break;case"6":var f={element:{},index:r.length};r.push(f.element),n.push(f);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+a)}else{if(1===r.length)return r.pop();c(r,n)}}}function p(e,r){for(var n=Math.min(e.length,r.length),t=0;t<n;t++){var a=u(e[t],r[t]);if(0!==a)return a}return e.length===r.length?0:e.length>r.length?1:-1}function h(e,r){return e===r?0:e>r?1:-1}function g(e,r){for(var n=Object.keys(e),t=Object.keys(r),a=Math.min(n.length,t.length),l=0;l<a;l++){var i=u(n[l],t[l]);if(0!==i)return i;if(0!==(i=u(e[n[l]],r[t[l]])))return i}return n.length===t.length?0:n.length>t.length?1:-1}function v(e){var r=["boolean","number","string","object"].indexOf(typeof e);return~r?null===e?1:Array.isArray(e)?5:r<3?r+2:r+3:Array.isArray(e)?5:void 0}function b(e){if(0===e)return"1";var u=e.toExponential().split(/e\+?/),l=parseInt(u[1],10),i=e<0,s=i?"0":"2",o=r(((i?-l:l)-n).toString(),"0",t);s+=a+o;var c=Math.abs(parseFloat(u[0]));i&&(c=10-c);var f=c.toFixed(20);return f=f.replace(/\.?0+$/,""),s+=a+f}
},{}],"U1U9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.massageSelector=p,exports.matchesSelector=S,exports.filterInMemoryFields=v,exports.createFieldSorter=y,exports.rowFilter=b,exports.isCombinationalField=c,exports.getKey=l,exports.getValue=f,exports.getFieldFromDoc=n,exports.setFieldInDoc=r,exports.compare=o,exports.parseField=u;var e=require("pouchdb-utils"),t=require("pouchdb-collate");function n(e,t){for(var n=e,r=0,o=t.length;r<o;r++){if(!(n=n[t[r]]))break}return n}function r(e,t,n){for(var r=0,o=t.length;r<o-1;r++){e=e[t[r]]={}}e[t[o-1]]=n}function o(e,t){return e<t?-1:e>t?1:0}function u(e){for(var t=[],n="",r=0,o=e.length;r<o;r++){var u=e[r];"."===u?r>0&&"\\"===e[r-1]?n=n.substring(0,n.length-1)+".":(t.push(n),n=""):n+=u}return t.push(n),t}var i=["$or","$nor","$not"];function c(e){return i.indexOf(e)>-1}function l(e){return Object.keys(e)[0]}function f(e){return e[l(e)]}function a(e){var t={};return e.forEach(function(e){Object.keys(e).forEach(function(n){var r=e[n];if("object"!=typeof r&&(r={$eq:r}),c(n))r instanceof Array?t[n]=r.map(function(e){return a([e])}):t[n]=a([r]);else{var o=t[n]=t[n]||{};Object.keys(r).forEach(function(e){var t=r[e];return"$gt"===e||"$gte"===e?s(e,t,o):"$lt"===e||"$lte"===e?$(e,t,o):"$ne"===e?d(t,o):"$eq"===e?g(t,o):void(o[e]=t)})}})}),t}function s(e,t,n){void 0===n.$eq&&(void 0!==n.$gte?"$gte"===e?t>n.$gte&&(n.$gte=t):t>=n.$gte&&(delete n.$gte,n.$gt=t):void 0!==n.$gt?"$gte"===e?t>n.$gt&&(delete n.$gt,n.$gte=t):t>n.$gt&&(n.$gt=t):n[e]=t)}function $(e,t,n){void 0===n.$eq&&(void 0!==n.$lte?"$lte"===e?t<n.$lte&&(n.$lte=t):t<=n.$lte&&(delete n.$lte,n.$lt=t):void 0!==n.$lt?"$lte"===e?t<n.$lt&&(delete n.$lt,n.$lte=t):t<n.$lt&&(n.$lt=t):n[e]=t)}function d(e,t){"$ne"in t?t.$ne.push(e):t.$ne=[e]}function g(e,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=e}function p(t){var n=(0,e.clone)(t),r=!1;"$and"in n&&(n=a(n.$and),r=!0),["$or","$nor"].forEach(function(e){e in n&&n[e].forEach(function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n],o=e[r];"object"==typeof o&&null!==o||(e[r]={$eq:o})}})}),"$not"in n&&(n.$not=a([n.$not]));for(var o=Object.keys(n),u=0;u<o.length;u++){var i=o[u],c=n[i];"object"!=typeof c||null===c?c={$eq:c}:"$ne"in c&&!r&&(c.$ne=[c.$ne]),n[i]=c}return n}function y(e){function r(t){return e.map(function(e){var r=u(l(e));return n(t,r)})}return function(e,n){var u=r(e.doc),i=r(n.doc),c=(0,t.collate)(u,i);return 0!==c?c:o(e.doc._id,n.doc._id)}}function v(e,t,n){if(e=e.filter(function(e){return b(e.doc,t.selector,n)}),t.sort){var r=y(t.sort);e=e.sort(r),"string"!=typeof t.sort[0]&&"desc"===f(t.sort[0])&&(e=e.reverse())}if("limit"in t||"skip"in t){var o=t.skip||0,u=("limit"in t?t.limit:e.length)+o;e=e.slice(o,u)}return e}function b(e,t,r){return r.every(function(r){var o=t[r],i=u(r),l=n(e,i);return c(r)?j(r,o,e):h(o,e,i,l)})}function h(e,t,n,r){return!e||Object.keys(e).every(function(o){var u=e[o];return m(o,t,u,n,r)})}function j(e,t,n){return"$or"===e?t.some(function(e){return b(n,e,Object.keys(e))}):"$not"===e?!b(n,t,Object.keys(t)):!t.find(function(e){return b(n,e,Object.keys(e))})}function m(e,t,n,r,o){if(!M[e])throw new Error('unknown operator "'+e+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return M[e](t,n,r,o)}function x(e){return null!=e}function O(e){return void 0!==e}function k(e,t){var n=t[0],r=t[1];if(0===n)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(n,10)!==n)throw new Error("Divisor is not an integer");if(parseInt(r,10)!==r)throw new Error("Modulus is not an integer");return parseInt(e,10)===e&&e%n===r}function w(e,t){return t.some(function(t){return e instanceof Array?e.indexOf(t)>-1:e===t})}function E(e,t){return t.every(function(t){return e.indexOf(t)>-1})}function q(e,t){return e.length===t}function A(e,t){return new RegExp(t).test(e)}function F(e,t){switch(t){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e)}throw new Error(t+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var M={$elemMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.some(function(e){return b(e,t,Object.keys(t))}):r.some(function(r){return h(t,e,n,r)})))},$allMatch:function(e,t,n,r){return!!Array.isArray(r)&&(0!==r.length&&("object"==typeof r[0]?r.every(function(e){return b(e,t,Object.keys(t))}):r.every(function(r){return h(t,e,n,r)})))},$eq:function(e,n,r,o){return O(o)&&0===(0,t.collate)(o,n)},$gte:function(e,n,r,o){return O(o)&&(0,t.collate)(o,n)>=0},$gt:function(e,n,r,o){return O(o)&&(0,t.collate)(o,n)>0},$lte:function(e,n,r,o){return O(o)&&(0,t.collate)(o,n)<=0},$lt:function(e,n,r,o){return O(o)&&(0,t.collate)(o,n)<0},$exists:function(e,t,n,r){return t?O(r):!O(r)},$mod:function(e,t,n,r){return x(r)&&k(r,t)},$ne:function(e,n,r,o){return n.every(function(e){return 0!==(0,t.collate)(o,e)})},$in:function(e,t,n,r){return x(r)&&w(r,t)},$nin:function(e,t,n,r){return x(r)&&!w(r,t)},$size:function(e,t,n,r){return x(r)&&q(r,t)},$all:function(e,t,n,r){return Array.isArray(r)&&E(r,t)},$regex:function(e,t,n,r){return x(r)&&A(r,t)},$type:function(e,t,n,r){return F(r,t)}};function S(e,t){if("object"!=typeof t)throw new Error("Selector error: expected a JSON object");var n=v([{doc:e}],{selector:t=p(t)},Object.keys(t));return n&&1===n.length}
},{"pouchdb-utils":"alES","pouchdb-collate":"xAsV"}],"wTud":[function(require,module,exports) {
var e,r,o=require("./lib/rng"),s=require("./lib/bytesToUuid"),i=0,n=0;function c(c,l,u){var v=l&&u||0,a=l||[],d=(c=c||{}).node||e,t=void 0!==c.clockseq?c.clockseq:r;if(null==d||null==t){var m=o();null==d&&(d=e=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==t&&(t=r=16383&(m[6]<<8|m[7]))}var q=void 0!==c.msecs?c.msecs:(new Date).getTime(),f=void 0!==c.nsecs?c.nsecs:n+1,b=q-i+(f-n)/1e4;if(b<0&&void 0===c.clockseq&&(t=t+1&16383),(b<0||q>i)&&void 0===c.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=q,n=f,r=t;var k=(1e4*(268435455&(q+=122192928e5))+f)%4294967296;a[v++]=k>>>24&255,a[v++]=k>>>16&255,a[v++]=k>>>8&255,a[v++]=255&k;var w=q/4294967296*1e4&268435455;a[v++]=w>>>8&255,a[v++]=255&w,a[v++]=w>>>24&15|16,a[v++]=w>>>16&255,a[v++]=t>>>8|128,a[v++]=255&t;for(var g=0;g<6;++g)a[v+g]=d[g];return l||s(a)}module.exports=c;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"L8Zr":[function(require,module,exports) {
var r=require("./lib/rng"),n=require("./lib/bytesToUuid");function e(e,i,u){var a=i&&u||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,i)for(var o=0;o<16;++o)i[a+o]=l[o];return i||n(l)}module.exports=e;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"uyBm":[function(require,module,exports) {
var e=require("./v1"),r=require("./v4"),v=r;v.v1=e,v.v4=r,module.exports=v;
},{"./v1":"wTud","./v4":"L8Zr"}],"UScm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.adapterFun=x,exports.bulkGetShim=j,exports.changesHandler=k,exports.clone=y,exports.defaultBackOff=L,exports.explainError=B,exports.filterChange=N,exports.flatten=F,exports.guardedConsole=A,exports.hasLocalStorage=I,exports.invalidIdError=G,exports.isRemote=V,exports.listenerCount=W,exports.normalizeDdocFunctionName=J,exports.once=g,exports.parseDdocFunctionName=H,exports.parseUri=Y,exports.pick=b,exports.rev=re,exports.scopeEval=Z,exports.toPromise=m,exports.upsert=ee,Object.defineProperty(exports,"nextTick",{enumerable:!0,get:function(){return r.default}}),exports.uuid=exports.functionName=exports.assign=void 0;var e=s(require("argsarray")),t=require("pouchdb-collections"),r=s(require("immediate")),n=require("events"),o=s(require("inherits")),i=require("pouchdb-errors"),u=s(require("uuid")),a=require("pouchdb-md5"),c=require("pouchdb-utils");function s(e){return e&&e.__esModule?e:{default:e}}function f(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function l(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}function p(e){if(e instanceof ArrayBuffer)return l(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}var d=Function.prototype.toString,h=d.call(Object);function v(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&d.call(r)==h}function y(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=y(e[r]);return t}if(e instanceof Date)return e.toISOString();if(f(e))return p(e);if(!v(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=y(e[r]);void 0!==o&&(t[r]=o)}return t}function g(t){var r=!1;return(0,e.default)(function(e){if(r)throw new Error("once called more than once");r=!0,t.apply(this,e)})}function m(t){return(0,e.default)(function(e){e=y(e);var r=this,n="function"==typeof e[e.length-1]&&e.pop(),o=new Promise(function(n,o){var i;try{var u=g(function(e,t){e?o(e):n(t)});e.push(u),(i=t.apply(r,e))&&"function"==typeof i.then&&n(i)}catch(a){o(a)}});return n&&o.then(function(e){n(null,e)},n),o})}function _(e,t,r){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,t],o=0;o<r.length-1;o++)n.push(r[o]);e.constructor.emit("debug",n);var i=r[r.length-1];r[r.length-1]=function(r,n){var o=["api",e.name,t];o=o.concat(r?["error",r]:["success",n]),e.constructor.emit("debug",o),i(r,n)}}}function x(t,r){return m((0,e.default)(function(e){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return _(n,t,e),this.taskqueue.isReady?r.apply(this,e):new Promise(function(r,o){n.taskqueue.addTask(function(i){i?o(i):r(n[t].apply(n,e))})})}))}function b(e,t){for(var r={},n=0,o=t.length;n<o;n++){var i=t[n];i in e&&(r[i]=e[i])}return r}var w,E,q=6;function O(e){return e}function S(e){return[{ok:e}]}function j(e,r,n){var o=r.docs,i=new t.Map;o.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var u=i.size,a=0,c=new Array(u);function s(){var e;++a===u&&(e=[],c.forEach(function(t){t.docs.forEach(function(r){e.push({id:t.id,docs:[r]})})}),n(null,{results:e}))}var f=[];i.forEach(function(e,t){f.push(t)});var l=0;function p(){if(!(l>=f.length)){var t=Math.min(l+q,f.length),n=f.slice(l,t);!function(t,n){t.forEach(function(t,o){var u=n+o,a=i.get(t),f=b(a[0],["atts_since","attachments"]);f.open_revs=a.map(function(e){return e.rev}),f.open_revs=f.open_revs.filter(O);var l=O;0===f.open_revs.length&&(delete f.open_revs,l=S),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in r&&(f[e]=r[e])}),e.get(t,f,function(e,r){var n,o,i;n=e?[{error:e}]:l(r),o=t,i=n,c[u]={id:o,docs:i},s(),p()})})}(n,l),l+=n.length}}p()}try{localStorage.setItem("_pouch_check_localstorage",1),w=!!localStorage.getItem("_pouch_check_localstorage")}catch(oe){w=!1}function I(){return w}function P(e){I()&&addEventListener("storage",function(t){e.emit(t.key)})}function k(){n.EventEmitter.call(this),this._listeners={},P(this)}function A(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function D(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function L(e){var t=0;return e||(t=2e3),D(e,t)}function B(e,t){A("info","The above "+e+" is totally normal. "+t)}(0,o.default)(k,n.EventEmitter),k.prototype.addListener=function(e,t,n,o){if(!this._listeners[t]){var i=this,u=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(i._listeners[t])if(u)u="waiting";else{u=!0;var e=b(o,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>o.since&&!o.cancelled&&(o.since=e.seq,o.onChange(e))}).on("complete",function(){"waiting"===u&&(0,r.default)(a),u=!1}).on("error",function(){u=!1})}}},k.prototype.removeListener=function(e,t){t in this._listeners&&(n.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},k.prototype.notifyLocalWindows=function(e){I()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},k.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var C=E="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function M(e,t,r){try{return!e(t,r)}catch(o){var n="Filter function threw: "+o.toString();return(0,i.createError)(i.BAD_REQUEST,n)}}function N(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&M(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in n.doc._attachments)n.doc._attachments.hasOwnProperty(i)&&(n.doc._attachments[i].stub=!0)}else delete n.doc;return!0}}function F(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t}function R(){}exports.assign=C;var U,T=R.name,z=U=T?function(e){return e.name}:function(e){var t=e.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""};function G(e){var t;if(e?"string"!=typeof e?t=(0,i.createError)(i.INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=(0,i.createError)(i.RESERVED_ID)):t=(0,i.createError)(i.MISSING_ID),t)throw t}function V(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(A("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function W(e,t){return"listenerCount"in e?e.listenerCount(t):n.EventEmitter.listenerCount(e,t)}function H(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function J(e){var t=H(e);return t?t.join("/"):null}exports.functionName=z;var K=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Q="queryKey",$=/(?:^|&)([^&=]*)=?([^&]*)/g,X=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Y(e){for(var t=X.exec(e),r={},n=14;n--;){var o=K[n],i=t[n]||"",u=-1!==["user","password"].indexOf(o);r[o]=u?decodeURIComponent(i):i}return r[Q]={},r[K[12]].replace($,function(e,t,n){t&&(r[Q][t]=n)}),r}function Z(e,t){var r=[],n=[];for(var o in t)t.hasOwnProperty(o)&&(r.push(o),n.push(t[o]));return r.push(e),Function.apply(null,r).apply(null,n)}function ee(e,t,r){return new Promise(function(n,o){e.get(t,function(i,u){if(i){if(404!==i.status)return o(i);u={}}var a=u._rev,c=r(u);if(!c)return n({updated:!1,rev:a});c._id=t,c._rev=a,n(te(e,c,r))})})}function te(e,t,r){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return ee(e,t._id,r)})}function re(e,t){var r=(0,c.clone)(e);return t?(delete r._rev_tree,(0,a.stringMd5)(JSON.stringify(r))):u.default.v4().replace(/-/g,"").toLowerCase()}var ne=u.default.v4;exports.uuid=ne;
},{"argsarray":"uOR/","pouchdb-collections":"vXuq","immediate":"EK2n","events":"wIHY","inherits":"oxw+","pouchdb-errors":"eFvv","uuid":"uyBm","pouchdb-md5":"Xfmb","pouchdb-utils":"UScm"}],"Rk7c":[function(require,module,exports) {
var e,r,o=require("./lib/rng"),s=require("./lib/bytesToUuid"),i=0,n=0;function c(c,l,u){var v=l&&u||0,a=l||[],d=(c=c||{}).node||e,t=void 0!==c.clockseq?c.clockseq:r;if(null==d||null==t){var m=o();null==d&&(d=e=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==t&&(t=r=16383&(m[6]<<8|m[7]))}var q=void 0!==c.msecs?c.msecs:(new Date).getTime(),f=void 0!==c.nsecs?c.nsecs:n+1,b=q-i+(f-n)/1e4;if(b<0&&void 0===c.clockseq&&(t=t+1&16383),(b<0||q>i)&&void 0===c.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=q,n=f,r=t;var k=(1e4*(268435455&(q+=122192928e5))+f)%4294967296;a[v++]=k>>>24&255,a[v++]=k>>>16&255,a[v++]=k>>>8&255,a[v++]=255&k;var w=q/4294967296*1e4&268435455;a[v++]=w>>>8&255,a[v++]=255&w,a[v++]=w>>>24&15|16,a[v++]=w>>>16&255,a[v++]=t>>>8|128,a[v++]=255&t;for(var g=0;g<6;++g)a[v+g]=d[g];return l||s(a)}module.exports=c;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"Keaw":[function(require,module,exports) {
var r=require("./lib/rng"),n=require("./lib/bytesToUuid");function e(e,i,u){var a=i&&u||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,i)for(var o=0;o<16;++o)i[a+o]=l[o];return i||n(l)}module.exports=e;
},{"./lib/rng":"Ukxk","./lib/bytesToUuid":"Dtnm"}],"/rUy":[function(require,module,exports) {
var e=require("./v1"),r=require("./v4"),v=r;v.v1=e,v.v4=r,module.exports=v;
},{"./v1":"Rk7c","./v4":"Keaw"}],"F8fV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.adapterFun=x,exports.bulkGetShim=j,exports.changesHandler=k,exports.clone=y,exports.defaultBackOff=L,exports.explainError=B,exports.filterChange=N,exports.flatten=F,exports.guardedConsole=A,exports.hasLocalStorage=I,exports.invalidIdError=G,exports.isRemote=V,exports.listenerCount=W,exports.normalizeDdocFunctionName=J,exports.once=g,exports.parseDdocFunctionName=H,exports.parseUri=Y,exports.pick=b,exports.rev=re,exports.scopeEval=Z,exports.toPromise=m,exports.upsert=ee,Object.defineProperty(exports,"nextTick",{enumerable:!0,get:function(){return r.default}}),exports.uuid=exports.functionName=exports.assign=void 0;var e=s(require("argsarray")),t=require("pouchdb-collections"),r=s(require("immediate")),n=require("events"),o=s(require("inherits")),i=require("pouchdb-errors"),u=s(require("uuid")),a=require("pouchdb-md5"),c=require("pouchdb-utils");function s(e){return e&&e.__esModule?e:{default:e}}function f(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function l(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}function p(e){if(e instanceof ArrayBuffer)return l(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}var d=Function.prototype.toString,h=d.call(Object);function v(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&d.call(r)==h}function y(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=y(e[r]);return t}if(e instanceof Date)return e.toISOString();if(f(e))return p(e);if(!v(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=y(e[r]);void 0!==o&&(t[r]=o)}return t}function g(t){var r=!1;return(0,e.default)(function(e){if(r)throw new Error("once called more than once");r=!0,t.apply(this,e)})}function m(t){return(0,e.default)(function(e){e=y(e);var r=this,n="function"==typeof e[e.length-1]&&e.pop(),o=new Promise(function(n,o){var i;try{var u=g(function(e,t){e?o(e):n(t)});e.push(u),(i=t.apply(r,e))&&"function"==typeof i.then&&n(i)}catch(a){o(a)}});return n&&o.then(function(e){n(null,e)},n),o})}function _(e,t,r){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,t],o=0;o<r.length-1;o++)n.push(r[o]);e.constructor.emit("debug",n);var i=r[r.length-1];r[r.length-1]=function(r,n){var o=["api",e.name,t];o=o.concat(r?["error",r]:["success",n]),e.constructor.emit("debug",o),i(r,n)}}}function x(t,r){return m((0,e.default)(function(e){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return _(n,t,e),this.taskqueue.isReady?r.apply(this,e):new Promise(function(r,o){n.taskqueue.addTask(function(i){i?o(i):r(n[t].apply(n,e))})})}))}function b(e,t){for(var r={},n=0,o=t.length;n<o;n++){var i=t[n];i in e&&(r[i]=e[i])}return r}var w,E,q=6;function O(e){return e}function S(e){return[{ok:e}]}function j(e,r,n){var o=r.docs,i=new t.Map;o.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var u=i.size,a=0,c=new Array(u);function s(){var e;++a===u&&(e=[],c.forEach(function(t){t.docs.forEach(function(r){e.push({id:t.id,docs:[r]})})}),n(null,{results:e}))}var f=[];i.forEach(function(e,t){f.push(t)});var l=0;function p(){if(!(l>=f.length)){var t=Math.min(l+q,f.length),n=f.slice(l,t);!function(t,n){t.forEach(function(t,o){var u=n+o,a=i.get(t),f=b(a[0],["atts_since","attachments"]);f.open_revs=a.map(function(e){return e.rev}),f.open_revs=f.open_revs.filter(O);var l=O;0===f.open_revs.length&&(delete f.open_revs,l=S),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in r&&(f[e]=r[e])}),e.get(t,f,function(e,r){var n,o,i;n=e?[{error:e}]:l(r),o=t,i=n,c[u]={id:o,docs:i},s(),p()})})}(n,l),l+=n.length}}p()}try{localStorage.setItem("_pouch_check_localstorage",1),w=!!localStorage.getItem("_pouch_check_localstorage")}catch(oe){w=!1}function I(){return w}function P(e){I()&&addEventListener("storage",function(t){e.emit(t.key)})}function k(){n.EventEmitter.call(this),this._listeners={},P(this)}function A(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function D(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function L(e){var t=0;return e||(t=2e3),D(e,t)}function B(e,t){A("info","The above "+e+" is totally normal. "+t)}(0,o.default)(k,n.EventEmitter),k.prototype.addListener=function(e,t,n,o){if(!this._listeners[t]){var i=this,u=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(i._listeners[t])if(u)u="waiting";else{u=!0;var e=b(o,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>o.since&&!o.cancelled&&(o.since=e.seq,o.onChange(e))}).on("complete",function(){"waiting"===u&&(0,r.default)(a),u=!1}).on("error",function(){u=!1})}}},k.prototype.removeListener=function(e,t){t in this._listeners&&(n.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},k.prototype.notifyLocalWindows=function(e){I()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},k.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var C=E="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function M(e,t,r){try{return!e(t,r)}catch(o){var n="Filter function threw: "+o.toString();return(0,i.createError)(i.BAD_REQUEST,n)}}function N(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&M(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in n.doc._attachments)n.doc._attachments.hasOwnProperty(i)&&(n.doc._attachments[i].stub=!0)}else delete n.doc;return!0}}function F(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t}function R(){}exports.assign=C;var U,T=R.name,z=U=T?function(e){return e.name}:function(e){var t=e.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""};function G(e){var t;if(e?"string"!=typeof e?t=(0,i.createError)(i.INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=(0,i.createError)(i.RESERVED_ID)):t=(0,i.createError)(i.MISSING_ID),t)throw t}function V(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(A("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function W(e,t){return"listenerCount"in e?e.listenerCount(t):n.EventEmitter.listenerCount(e,t)}function H(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function J(e){var t=H(e);return t?t.join("/"):null}exports.functionName=z;var K=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Q="queryKey",$=/(?:^|&)([^&=]*)=?([^&]*)/g,X=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Y(e){for(var t=X.exec(e),r={},n=14;n--;){var o=K[n],i=t[n]||"",u=-1!==["user","password"].indexOf(o);r[o]=u?decodeURIComponent(i):i}return r[Q]={},r[K[12]].replace($,function(e,t,n){t&&(r[Q][t]=n)}),r}function Z(e,t){var r=[],n=[];for(var o in t)t.hasOwnProperty(o)&&(r.push(o),n.push(t[o]));return r.push(e),Function.apply(null,r).apply(null,n)}function ee(e,t,r){return new Promise(function(n,o){e.get(t,function(i,u){if(i){if(404!==i.status)return o(i);u={}}var a=u._rev,c=r(u);if(!c)return n({updated:!1,rev:a});c._id=t,c._rev=a,n(te(e,c,r))})})}function te(e,t,r){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return ee(e,t._id,r)})}function re(e,t){var r=(0,c.clone)(e);return t?(delete r._rev_tree,(0,a.stringMd5)(JSON.stringify(r))):u.default.v4().replace(/-/g,"").toLowerCase()}var ne=u.default.v4;exports.uuid=ne;
},{"argsarray":"uOR/","pouchdb-collections":"vXuq","immediate":"EK2n","events":"wIHY","inherits":"oxw+","pouchdb-errors":"eFvv","uuid":"/rUy","pouchdb-md5":"Xfmb","pouchdb-utils":"F8fV"}],"n12y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.uniq=p,exports.sequentialize=h,exports.fin=f,exports.callbackify=c,exports.promisedCallback=a,exports.mapToKeysArray=l,exports.QueryParseError=o,exports.NotFoundError=i,exports.BuiltInError=s;var r=u(require("inherits")),t=require("pouchdb-collections"),e=u(require("argsarray")),n=require("pouchdb-utils");function u(r){return r&&r.__esModule?r:{default:r}}function o(r){this.status=400,this.name="query_parse_error",this.message=r,this.error=!0;try{Error.captureStackTrace(this,o)}catch(t){}}function i(r){this.status=404,this.name="not_found",this.message=r,this.error=!0;try{Error.captureStackTrace(this,i)}catch(t){}}function s(r){this.status=500,this.name="invalid_value",this.message=r,this.error=!0;try{Error.captureStackTrace(this,s)}catch(t){}}function a(r,t){return t&&r.then(function(r){(0,n.nextTick)(function(){t(null,r)})},function(r){(0,n.nextTick)(function(){t(r)})}),r}function c(r){return(0,e.default)(function(t){var e=t.pop(),n=r.apply(this,t);return"function"==typeof e&&a(n,e),n})}function f(r,t){return r.then(function(r){return t().then(function(){return r})},function(r){return t().then(function(){throw r})})}function h(r,t){return function(){var e=arguments,n=this;return r.add(function(){return t.apply(n,e)})}}function p(r){var e=new t.Set(r),n=new Array(e.size),u=-1;return e.forEach(function(r){n[++u]=r}),n}function l(r){var t=new Array(r.size),e=-1;return r.forEach(function(r,n){t[++e]=n}),t}(0,r.default)(o,Error),(0,r.default)(i,Error),(0,r.default)(s,Error);
},{"inherits":"oxw+","pouchdb-collections":"vXuq","argsarray":"uOR/","pouchdb-utils":"F8fV"}],"1Z6H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("pouchdb-utils"),n=require("pouchdb-md5"),r=require("pouchdb-collections"),t=require("pouchdb-binary-utils"),o=require("pouchdb-collate"),u=require("pouchdb-errors"),i=require("pouchdb-fetch"),a=require("pouchdb-mapreduce-utils");function c(){this.promise=new Promise(function(e){e()})}function s(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e)}}function d(e,n){return s(e)+s(n)+"undefined"}function f(r,t,o,u,i,a){var c,s=d(o,u);if(!i&&(c=r._cachedViews=r._cachedViews||{})[s])return c[s];var f=r.info().then(function(d){var f=d.db_name+"-mrview-"+(i?"temp":(0,n.stringMd5)(s));return(0,e.upsert)(r,"_local/"+a,function(e){e.views=e.views||{};var n=t;-1===n.indexOf("/")&&(n=t+"/"+t);var r=e.views[n]=e.views[n]||{};if(!r[f])return r[f]=!0,e}).then(function(){return r.registerDependentDatabase(f).then(function(e){var n=e.db;n.auto_compaction=!0;var t={name:f,db:n,sourceDB:r,adapter:r.adapter,mapFun:o,reduceFun:u};return t.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return t.seq=e?e.seq:0,c&&t.db.once("destroyed",function(){delete c[s]}),t})})})});return c&&(c[s]=f),f}c.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},c.prototype.finish=function(){return this.promise};var l={},v=new c,y=50;function h(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function p(e){return 1===e.length&&/^1-/.test(e[0].rev)}function k(n,r){try{n.emit("error",r)}catch(t){(0,e.guardedConsole)("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),(0,e.guardedConsole)("error",r)}}function _(n,s,d,_){function g(e,n,r){try{n(r)}catch(t){k(e,t)}}function m(e,n,r,t,o){try{return{output:n(r,t,o)}}catch(u){return k(e,u),{error:u}}}function w(e,n){var r=(0,o.collate)(e.key,n.key);return 0!==r?r:(0,o.collate)(e.value,n.value)}function b(e){var n=e.value;return n&&"object"==typeof n&&n._id||e.id}function q(e){return function(n){return e.include_docs&&e.attachments&&e.binary&&function(e){e.rows.forEach(function(e){var n=e.doc&&e.doc._attachments;n&&Object.keys(n).forEach(function(e){var r=n[e];n[e].data=(0,t.base64StringToBlobOrBuffer)(r.data,r.content_type)})})}(n),n}}function S(e,n,r,t){var o=n[e];void 0!==o&&(t&&(o=encodeURIComponent(JSON.stringify(o))),r.push(e+"="+o))}function E(e){if(void 0!==e){var n=Number(e);return isNaN(n)||n!==parseInt(e,10)?e:n}}function I(e,n){var r=e.descending?"endkey":"startkey",t=e.descending?"startkey":"endkey";if(void 0!==e[r]&&void 0!==e[t]&&(0,o.collate)(e[r],e[t])>0)throw new a.QueryParseError("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(n.reduce&&!1!==e.reduce){if(e.include_docs)throw new a.QueryParseError("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new a.QueryParseError("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(n){var r=function(e){if(e){if("number"!=typeof e)return new a.QueryParseError('Invalid value for integer: "'+e+'"');if(e<0)return new a.QueryParseError('Invalid value for positive integer: "'+e+'"')}}(e[n]);if(r)throw r})}function P(e){return function(n){if(404===n.status)return e;throw n}}function O(e,n,t){var o="_local/doc_"+e,u={_id:o,keys:[]},i=t.get(e),c=i[0];return(p(i[1])?Promise.resolve(u):n.db.get(o).catch(P(u))).then(function(e){return function(e){return e.keys.length?n.db.allDocs({keys:e.keys,include_docs:!0}):Promise.resolve({rows:[]})}(e).then(function(n){return function(e,n){for(var t=[],o=new r.Set,u=0,i=n.rows.length;u<i;u++){var s=n.rows[u].doc;if(s&&(t.push(s),o.add(s._id),s._deleted=!c.has(s._id),!s._deleted)){var d=c.get(s._id);"value"in d&&(s.value=d.value)}}var f=(0,a.mapToKeysArray)(c);return f.forEach(function(e){if(!o.has(e)){var n={_id:e},r=c.get(e);"value"in r&&(n.value=r.value),t.push(n)}}),e.keys=(0,a.uniq)(f.concat(e.keys)),t.push(e),t}(e,n)})})}function j(e){var n="string"==typeof e?e:e.name,r=l[n];return r||(r=l[n]=new c),r}function x(n){return(0,a.sequentialize)(j(n),function(){return function(n){var t,u;var i=s(n.mapFun,function(e,n){var r={id:u._id,key:(0,o.normalizeKey)(e)};null!=n&&(r.value=(0,o.normalizeKey)(n));t.push(r)}),d=n.seq||0;function f(r,t){return function(){return function(n,r,t){return n.db.get("_local/lastSeq").catch(P({_id:"_local/lastSeq",seq:0})).then(function(o){var u=(0,a.mapToKeysArray)(r);return Promise.all(u.map(function(e){return O(e,n,r)})).then(function(r){var u=(0,e.flatten)(r);return o.seq=t,u.push(o),n.db.bulkDocs({docs:u})})})}(n,r,t)}}var l=new c;function v(){return n.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:d,limit:y}).then(h)}function h(e){var o=e.results;if(o.length){var a=function(e){for(var o=new r.Map,a=0,c=e.length;a<c;a++){var s=e[a];if("_"!==s.doc._id[0]){t=[],(u=s.doc)._deleted||g(n.sourceDB,i,u),t.sort(w);var f=p(t);o.set(s.doc._id,[f,s.changes])}d=s.seq}return o}(o);if(l.add(f(a,d)),!(o.length<y))return v()}}function p(e){for(var n,t=new r.Map,u=0,i=e.length;u<i;u++){var a=e[u],c=[a.key,a.id];u>0&&0===(0,o.collate)(a.key,n)&&c.push(u),t.set((0,o.toIndexableString)(c),a),n=a.key}return t}return v().then(function(){return l.finish()}).then(function(){n.seq=d})}(n)})()}function N(n,t){return(0,a.sequentialize)(j(n),function(){return function(n,t){var u,i=n.reduceFun&&!1!==t.reduce,c=t.skip||0;void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys);function s(e){return e.include_docs=!0,n.db.allDocs(e).then(function(e){return u=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var n=Object.keys(e.doc.value).sort(),r=["id","key","value"];if(!(n<r||n>r))return e.doc.value}var t=(0,o.parseIndexableString)(e.doc._id);return{key:t[0],id:t[1],value:"value"in e.doc?e.doc.value:null}})})}function f(e){var s;if(s=i?function(e,n,r){0===r.group_level&&delete r.group_level;var t=r.group||r.group_level,u=d(e.reduceFun),i=[],c=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;n.forEach(function(e){var n=i[i.length-1],r=t?e.key:null;if(t&&Array.isArray(r)&&(r=r.slice(0,c)),n&&0===(0,o.collate)(n.groupKey,r))return n.keys.push([e.key,e.id]),void n.values.push(e.value);i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:r})}),n=[];for(var s=0,f=i.length;s<f;s++){var l=i[s],v=m(e.sourceDB,u,l.keys,l.values,!1);if(v.error&&v.error instanceof a.BuiltInError)throw v.error;n.push({value:v.error?null:v.output,key:l.groupKey})}return{rows:function(e,n,r){return r=r||0,"number"==typeof n?e.slice(r,n+r):r>0?e.slice(r):e}(n,r.limit,r.skip)}}(n,e,t):{total_rows:u,offset:c,rows:e},t.update_seq&&(s.update_seq=n.seq),t.include_docs){var f=(0,a.uniq)(e.map(b));return n.sourceDB.allDocs({keys:f,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(n){var t=new r.Map;return n.rows.forEach(function(e){t.set(e.id,e.doc)}),e.forEach(function(e){var n=b(e),r=t.get(n);r&&(e.doc=r)}),s})}return s}if(void 0!==t.keys){var l=t.keys,v=l.map(function(e){var n={startkey:(0,o.toIndexableString)([e]),endkey:(0,o.toIndexableString)([e,{}])};return t.update_seq&&(n.update_seq=!0),s(n)});return Promise.all(v).then(e.flatten).then(f)}var y,h,p={descending:t.descending};if(t.update_seq&&(p.update_seq=!0),"start_key"in t&&(y=t.start_key),"startkey"in t&&(y=t.startkey),"end_key"in t&&(h=t.end_key),"endkey"in t&&(h=t.endkey),void 0!==y&&(p.startkey=t.descending?(0,o.toIndexableString)([y,{}]):(0,o.toIndexableString)([y])),void 0!==h){var k=!1!==t.inclusive_end;t.descending&&(k=!k),p.endkey=(0,o.toIndexableString)(k?[h,{}]:[h])}if(void 0!==t.key){var _=(0,o.toIndexableString)([t.key]),g=(0,o.toIndexableString)([t.key,{}]);p.descending?(p.endkey=_,p.startkey=g):(p.startkey=_,p.endkey=g)}return i||("number"==typeof t.limit&&(p.limit=t.limit),p.skip=c),s(p).then(f)}(n,t)})()}function T(r,t,o){if("function"==typeof r._query)return function(e,n,r){return new Promise(function(t,o){e._query(n,r,function(e,n){if(e)return o(e);t(n)})})}(r,t,o);if((0,e.isRemote)(r))return function(e,n,r){var t,o,a,c=[],s="GET";if(S("reduce",r,c),S("include_docs",r,c),S("attachments",r,c),S("limit",r,c),S("descending",r,c),S("group",r,c),S("group_level",r,c),S("skip",r,c),S("stale",r,c),S("conflicts",r,c),S("startkey",r,c,!0),S("start_key",r,c,!0),S("endkey",r,c,!0),S("end_key",r,c,!0),S("inclusive_end",r,c),S("key",r,c,!0),S("update_seq",r,c),c=""===(c=c.join("&"))?"":"?"+c,void 0!==r.keys){var d="keys="+encodeURIComponent(JSON.stringify(r.keys));d.length+c.length+1<=2e3?c+=("?"===c[0]?"&":"?")+d:(s="POST","string"==typeof n?t={keys:r.keys}:n.keys=r.keys)}if("string"==typeof n){var f=h(n);return e.fetch("_design/"+f[0]+"/_view/"+f[1]+c,{headers:new i.Headers({"Content-Type":"application/json"}),method:s,body:JSON.stringify(t)}).then(function(e){return o=e.ok,a=e.status,e.json()}).then(function(e){if(!o)throw e.status=a,(0,u.generateErrorFromResponse)(e);return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(q(r))}return t=t||{},Object.keys(n).forEach(function(e){Array.isArray(n[e])?t[e]=n[e]:t[e]=n[e].toString()}),e.fetch("_temp_view"+c,{headers:new i.Headers({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(t)}).then(function(e){return o=e.ok,a=e.status,e.json()}).then(function(e){if(!o)throw e.status=a,(0,u.generateErrorFromResponse)(e);return e}).then(q(r))}(r,t,o);if("string"!=typeof t)return I(o,t),v.add(function(){return f(r,"temp_view/temp_view",t.map,t.reduce,!0,n).then(function(e){return(0,a.fin)(x(e).then(function(){return N(e,o)}),function(){return e.db.destroy()})})}),v.finish();var c=t,s=h(c),d=s[0],l=s[1];return r.get("_design/"+d).then(function(t){var u=t.views&&t.views[l];if(!u)throw new a.NotFoundError("ddoc "+t._id+" has no view named "+l);return _(t,l),I(o,u),f(r,c,u.map,u.reduce,!1,n).then(function(n){return"ok"===o.stale||"update_after"===o.stale?("update_after"===o.stale&&(0,e.nextTick)(function(){x(n)}),N(n,o)):x(n).then(function(){return N(n,o)})})})}return{query:function(e,n,r){var t=this;"function"==typeof n&&(r=n,n={}),n=n?function(e){return e.group_level=E(e.group_level),e.limit=E(e.limit),e.skip=E(e.skip),e}(n):{},"function"==typeof e&&(e={map:e});var o=Promise.resolve().then(function(){return T(t,e,n)});return(0,a.promisedCallback)(o,r),o},viewCleanup:(0,a.callbackify)(function(){var t=this;return"function"==typeof t._viewCleanup?function(e){return new Promise(function(n,r){e._viewCleanup(function(e,t){if(e)return r(e);n(t)})})}(t):(0,e.isRemote)(t)?function(e){return e.fetch("_view_cleanup",{headers:new i.Headers({"Content-Type":"application/json"}),method:"POST"}).then(function(e){return e.json()})}(t):function(e){return e.get("_local/"+n).then(function(n){var t=new r.Map;Object.keys(n.views).forEach(function(e){var n=h(e),o="_design/"+n[0],u=n[1],i=t.get(o);i||(i=new r.Set,t.set(o,i)),i.add(u)});var o={keys:(0,a.mapToKeysArray)(t),include_docs:!0};return e.allDocs(o).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);t.get(e.key).forEach(function(t){var u=r+"/"+t;n.views[u]||(u=t);var i=Object.keys(n.views[u]),a=e.doc&&e.doc.views&&e.doc.views[t];i.forEach(function(e){o[e]=o[e]||a})})});var u=Object.keys(o).filter(function(e){return!o[e]}).map(function(n){return(0,a.sequentialize)(j(n),function(){return new e.constructor(n,e.__opts).destroy()})()});return Promise.all(u).then(function(){return{ok:!0}})})},P({ok:!0}))}(t)})}}var g=_;exports.default=g;
},{"pouchdb-utils":"UScm","pouchdb-md5":"Xfmb","pouchdb-collections":"vXuq","pouchdb-binary-utils":"84bl","pouchdb-collate":"xAsV","pouchdb-errors":"eFvv","pouchdb-fetch":"+SOi","pouchdb-mapreduce-utils":"n12y"}],"3+KE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("pouchdb-utils"),n=require("pouchdb-errors"),t=require("pouchdb-fetch"),r=require("pouchdb-selector-core"),i=s(require("pouchdb-abstract-mapreduce")),o=require("pouchdb-collate"),u=require("pouchdb-md5");function s(e){return e&&e.__esModule?e:{default:e}}function d(n){return(n=(0,e.clone)(n)).index||(n.index={}),["type","name","ddoc"].forEach(function(e){n.index[e]&&(n[e]=n.index[e],delete n.index[e])}),n.fields&&(n.index.fields=n.fields,delete n.fields),n.type||(n.type="json"),n}function c(e,r,i,o){var u,s;i.headers=new t.Headers({"Content-type":"application/json"}),e.fetch(r,i).then(function(e){return u=e.status,s=e.ok,e.json()}).then(function(e){if(s)o(null,e);else{e.status=u;var t=(0,n.generateErrorFromResponse)(e);o(t)}}).catch(o)}function a(e,n,t){n=d(n),c(e,"_index",{method:"POST",body:JSON.stringify(n)},t)}function f(e,n,t){c(e,"_find",{method:"POST",body:JSON.stringify(n)},t)}function l(e,n,t){c(e,"_explain",{method:"POST",body:JSON.stringify(n)},t)}function y(e,n){c(e,"_index",{method:"GET"},n)}function v(e,n,t){var r=n.ddoc,i=n.type||"json",o=n.name;return r?o?void c(e,"_index/"+[r,i,o].map(encodeURIComponent).join("/"),{method:"DELETE"},t):t(new Error("you must provide an index's name")):t(new Error("you must provide an index's ddoc"))}function h(e){return function(){for(var n=arguments.length,t=new Array(n),r=-1;++r<n;)t[r]=arguments[r];return e.call(this,t)}}function p(e){return h(function(n){var t=n.pop(),r=e.apply(this,n);return g(r,t),r})}function g(n,t){return n.then(function(n){(0,e.nextTick)(function(){t(null,n)})},function(n){(0,e.nextTick)(function(){t(n)})}),n}var m=h(function(e){for(var n=[],t=0,r=e.length;t<r;t++){var i=e[t];Array.isArray(i)?n=n.concat(m.apply(null,i)):n.push(i)}return n});function k(n){for(var t={},r=0,i=n.length;r<i;r++)t=(0,e.assign)(t,n[r]);return t}function x(e,n){for(var t={},i=0,o=n.length;i<o;i++){var u=(0,r.parseField)(n[i]),s=(0,r.getFieldFromDoc)(e,u);void 0!==s&&(0,r.setFieldInDoc)(t,u,s)}return t}function _(e,n){for(var t=0,r=Math.min(e.length,n.length);t<r;t++)if(e[t]!==n[t])return!1;return!0}function w(e,n){return!(e.length>n.length)&&_(e,n)}function b(e,n){e=e.slice();for(var t=0,r=n.length;t<r;t++){var i=n[t];if(!e.length)break;var o=e.indexOf(i);if(-1===o)return!1;e.splice(o,1)}return!0}function O(e){for(var n={},t=0,r=e.length;t<r;t++)n[e[t]]=!0;return n}function j(e,n){for(var t=null,r=-1,i=0,o=e.length;i<o;i++){var u=e[i],s=n(u);s>r&&(r=s,t=u)}return t}function q(e,n){if(e.length!==n.length)return!1;for(var t=0,r=e.length;t<r;t++)if(e[t]!==n[t])return!1;return!0}function E(e){for(var n={},t=0;t<e.length;t++)n["$"+e[t]]=!0;return Object.keys(n).map(function(e){return e.substring(1)})}function $(e,n){return function(t){for(var i=[],o=0,u=e.length;o<u;o++){for(var s=(0,r.parseField)(e[o]),d=t,c=0,a=s.length;c<a;c++){if(void 0===(d=d[s[c]]))return}i.push(d)}n(i)}}function M(e,n){var t=(0,r.parseField)(e);return function(e){for(var r=e,i=0,o=t.length;i<o;i++){if(void 0===(r=r[t[i]]))return}n(r)}}function F(e,n){return function(t){n(t[e])}}function A(e,n){return function(t){for(var r=[],i=0,o=e.length;i<o;i++)r.push(t[e[i]]);n(r)}}function K(e){for(var n=0,t=e.length;n<t;n++){if(-1!==e[n].indexOf("."))return!1}return!0}function P(e,n){var t=K(e),r=1===e.length;return t?r?F(e[0],n):A(e,n):r?M(e[0],n):$(e,n)}function U(e,n){return P(Object.keys(e.fields),n)}function N(){throw new Error("reduce not supported")}function S(e,n){var t=e.views[n];if(!t.map||!t.map.fields)throw new Error("ddoc "+e._id+" with view "+n+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}var T=(0,i.default)("indexes",U,N,S);function R(e){if(!Array.isArray(e))throw new Error("invalid sort json - should be an array");return e.map(function(e){if("string"==typeof e){var n={};return n[e]="asc",n}return e})}function I(e){var n=[];return"string"==typeof e?n.push(e):n=e,n.map(function(e){return e.replace("_design/","")})}function V(e){return e.fields=e.fields.map(function(e){if("string"==typeof e){var n={};return n[e]="asc",n}return e}),e}function C(e,n){for(var t=[],i=0;i<n.def.fields.length;i++){var o=(0,r.getKey)(n.def.fields[i]);t.push(e[o])}return t}function D(e,n,t){for(var r=t.def.fields,i=0,u=e.length;i<u;i++){var s=C(e[i].doc,t);if(1===r.length)s=s[0];else for(;s.length>n.length;)s.pop();if(Math.abs((0,o.collate)(s,n))>0)break}return i>0?e.slice(i):e}function L(n){var t=(0,e.clone)(n);return delete t.startkey,delete t.endkey,delete t.inclusive_start,delete t.inclusive_end,"endkey"in n&&(t.startkey=n.endkey),"startkey"in n&&(t.endkey=n.startkey),"inclusive_start"in n&&(t.inclusive_end=n.inclusive_start),"inclusive_end"in n&&(t.inclusive_start=n.inclusive_end),t}function J(e){var n=e.fields.filter(function(e){return"asc"===(0,r.getValue)(e)});if(0!==n.length&&n.length!==e.fields.length)throw new Error("unsupported mixed sorting")}function X(e,n){if(n.defaultUsed&&e.sort){var t=e.sort.filter(function(e){return"_id"!==Object.keys(e)[0]}).map(function(e){return Object.keys(e)[0]});if(t.length>0)throw new Error('Cannot sort on field(s) "'+t.join(",")+'" when using the default index')}n.defaultUsed}function z(e){if("object"!=typeof e.selector)throw new Error("you must provide a selector when you find()")}function G(e,n){var t,i=Object.keys(e),o=n?n.map(r.getKey):[];return t=i.length>=o.length?i:o,0===o.length?{fields:t}:{fields:t=t.sort(function(e,n){var t=o.indexOf(e);-1===t&&(t=Number.MAX_VALUE);var r=o.indexOf(n);return-1===r&&(r=Number.MAX_VALUE),t<r?-1:t>r?1:0}),sortOrder:n.map(r.getKey)}}function H(n,t){t=d(t);var r,i=(0,e.clone)(t.index);function o(){return r||(r=(0,u.stringMd5)(JSON.stringify(t)))}t.index=V(t.index),J(t.index);var s=t.name||"idx-"+o(),c=t.ddoc||"idx-"+o(),a="_design/"+c,f=!1,l=!1;return n.constructor.emit("debug",["find","creating index",a]),(0,e.upsert)(n,a,function(e){return e._rev&&"query"!==e.language&&(f=!0),e.language="query",e.views=e.views||{},!(l=!!e.views[s])&&(e.views[s]={map:{fields:k(t.index.fields)},reduce:"_count",options:{def:i}},e)}).then(function(){if(f)throw new Error('invalid language for ddoc with id "'+a+'" (should be "query")')}).then(function(){var e=c+"/"+s;return T.query.call(n,e,{limit:0,reduce:!1}).then(function(){return{id:a,name:s,result:l?"exists":"created"}})})}function B(e){return e.allDocs({startkey:"_design/",endkey:"_design/",include_docs:!0}).then(function(e){var n={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return n.indexes=m(n.indexes,e.rows.filter(function(e){return"query"===e.doc.language}).map(function(e){return(void 0!==e.doc.views?Object.keys(e.doc.views):[]).map(function(n){var t=e.doc.views[n];return{ddoc:e.id,name:n,type:"json",def:V(t.options.def)}})})),n.indexes.sort(function(e,n){return(0,r.compare)(e.name,n.name)}),n.total_rows=n.indexes.length,n})}var Q=null,W={"":{}};function Y(e,n){for(var t=e.def.fields.map(r.getKey),i=0,o=t.length;i<o;i++){if(n===t[i])return!0}return!1}function Z(e,n){var t=e[n];return"$eq"!==(0,r.getKey)(t)}function ee(e,n){var t=n.def.fields.map(r.getKey);return e.slice().sort(function(e,n){var i=t.indexOf(e),o=t.indexOf(n);return-1===i&&(i=Number.MAX_VALUE),-1===o&&(o=Number.MAX_VALUE),(0,r.compare)(i,o)})}function ne(e,n,t){for(var r=!1,i=0,o=(t=ee(t,e)).length;i<o;i++){var u=t[i];if(r||!Y(e,u))return t.slice(i);i<o-1&&Z(n,u)&&(r=!0)}return[]}function te(e){var n=[];return Object.keys(e).forEach(function(t){var r=e[t];Object.keys(r).forEach(function(e){"$ne"===e&&n.push(t)})}),n}function re(e,n,t,r){return ee(E(m(e,ne(n,t,r),te(t))),n)}function ie(e,n,t){if(n){var r=w(n,e),i=_(t,e);return r&&i}return b(t,e)}var oe=["$eq","$gt","$gte","$lt","$lte"];function ue(e){return-1===oe.indexOf(e)}function se(e,n){var t=n[e[0]];return void 0===t||!!Object.keys(t).some(function(e){return!ue(e)})&&!(1===Object.keys(t).length&&"$ne"===(0,r.getKey)(t))}function de(e,n,t,i){var o=e.def.fields.map(r.getKey);return!!ie(o,n,t)&&se(o,i)}function ce(e,n,t,r){return r.reduce(function(r,i){return de(i,t,n,e)&&r.push(i),r},[])}function ae(e,n,t,i,o){var u=ce(e,n,t,i);if(0===u.length){if(o)throw{error:"no_usable_index",message:"There is no index available for this selector."};var s=i[0];return s.defaultUsed=!0,s}if(1===u.length&&!o)return u[0];var d=O(n);if(o){var c="_design/"+o[0],a=2===o.length&&o[1],f=u.find(function(e){return!(!a||e.ddoc!==c||a!==e.name)||e.ddoc===c});if(!f)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return f}return j(u,function(e){for(var n=e.def.fields.map(r.getKey),t=0,i=0,o=n.length;i<o;i++){var u=n[i];d[u]&&t++}return t})}function fe(e,n){switch(e){case"$eq":return{key:n};case"$lte":return{endkey:n};case"$gte":return{startkey:n};case"$lt":return{endkey:n,inclusive_end:!1};case"$gt":return{startkey:n,inclusive_start:!1}}}function le(e,n){var t,i=(0,r.getKey)(n.def.fields[0]),o=e[i]||{},u=[];return Object.keys(o).forEach(function(e){if(ue(e))u.push(i);else{var n=fe(e,o[e]);t=t?k([t,n]):n}}),{queryOpts:t,inMemoryFields:u}}function ye(e,n){switch(e){case"$eq":return{startkey:n,endkey:n};case"$lte":return{endkey:n};case"$gte":return{startkey:n};case"$lt":return{endkey:n,inclusive_end:!1};case"$gt":return{startkey:n,inclusive_start:!1}}}function ve(e,n){var t,i,o=n.def.fields.map(r.getKey),u=[],s=[],d=[];function c(e){!1!==t&&s.push(Q),!1!==i&&d.push(W),u=o.slice(e)}for(var a=0,f=o.length;a<f;a++){var l=e[o[a]];if(!l||!Object.keys(l).length){c(a);break}if(a>0){if(Object.keys(l).some(ue)){c(a);break}var y="$gt"in l||"$gte"in l||"$lt"in l||"$lte"in l,v=Object.keys(e[o[a-1]]),h=q(v,["$eq"]),p=q(v,Object.keys(l));if(y&&!h&&!p){c(a);break}}for(var g=Object.keys(l),m=null,x=0;x<g.length;x++){var _=g[x],w=ye(_,l[_]);m=m?k([m,w]):w}s.push("startkey"in m?m.startkey:Q),d.push("endkey"in m?m.endkey:W),"inclusive_start"in m&&(t=m.inclusive_start),"inclusive_end"in m&&(i=m.inclusive_end)}var b={startkey:s,endkey:d};return void 0!==t&&(b.inclusive_start=t),void 0!==i&&(b.inclusive_end=i),{queryOpts:b,inMemoryFields:u}}function he(e){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(e)]}}function pe(e,n){return n.defaultUsed?he(e,n):1===n.def.fields.length?le(e,n):ve(e,n)}function ge(e,n){var t=e.selector,r=G(t,e.sort),i=r.fields,o=ae(t,i,r.sortOrder,n,e.use_index),u=pe(t,o);return{queryOpts:u.queryOpts,index:o,inMemoryFields:re(u.inMemoryFields,o,t,i)}}function me(e){return e.ddoc.substring(8)+"/"+e.name}function ke(n,t){var r=(0,e.clone)(t);return r.descending?("endkey"in r&&"string"!=typeof r.endkey&&(r.endkey=""),"startkey"in r&&"string"!=typeof r.startkey&&(r.limit=0)):("startkey"in r&&"string"!=typeof r.startkey&&(r.startkey=""),"endkey"in r&&"string"!=typeof r.endkey&&(r.limit=0)),"key"in r&&"string"!=typeof r.key&&(r.limit=0),n.allDocs(r).then(function(e){return e.rows=e.rows.filter(function(e){return!/^_design\//.test(e.id)}),e})}function xe(n,t,i){return t.selector&&(t.selector=(0,r.massageSelector)(t.selector)),t.sort&&(t.sort=R(t.sort)),t.use_index&&(t.use_index=I(t.use_index)),z(t),B(n).then(function(u){n.constructor.emit("debug",["find","planning query",t]);var s=ge(t,u.indexes);n.constructor.emit("debug",["find","query plan",s]);var d=s.index;X(t,d);var c=(0,e.assign)({include_docs:!0,reduce:!1},s.queryOpts);return"startkey"in c&&"endkey"in c&&(0,o.collate)(c.startkey,c.endkey)>0?{docs:[]}:(t.sort&&"string"!=typeof t.sort[0]&&"desc"===(0,r.getValue)(t.sort[0])&&(c.descending=!0,c=L(c)),s.inMemoryFields.length||("limit"in t&&(c.limit=t.limit),"skip"in t&&(c.skip=t.skip)),i?Promise.resolve(s,c):Promise.resolve().then(function(){if("_all_docs"===d.name)return ke(n,c);var e=me(d);return T.query.call(n,e,c)}).then(function(e){!1===c.inclusive_start&&(e.rows=D(e.rows,c.startkey,d)),s.inMemoryFields.length&&(e.rows=(0,r.filterInMemoryFields)(e.rows,t,s.inMemoryFields));var n={docs:e.rows.map(function(e){var n=e.doc;return t.fields?x(n,t.fields):n})};return d.defaultUsed&&(n.warning="no matching index found, create an index to optimize query time"),n}))})}function _e(e,n){return xe(e,n,!0).then(function(t){return{dbname:e.name,index:t.index,selector:n.selector,range:{start_key:t.queryOpts.startkey,end_key:t.queryOpts.endkey},opts:{use_index:n.use_index||[],bookmark:"nil",limit:n.limit,skip:n.skip,sort:n.sort||{},fields:n.fields,conflicts:!1,r:[49]},limit:n.limit,skip:n.skip||0,fields:n.fields}})}function we(n,t){if(!t.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!t.name)throw new Error("you must supply an index.name when deleting");var r=t.ddoc,i=t.name;return(0,e.upsert)(n,r,function(e){return 1===Object.keys(e.views).length&&e.views[i]?{_id:r,_deleted:!0}:(delete e.views[i],e)}).then(function(){return T.viewCleanup.apply(n)}).then(function(){return{ok:!0}})}var be=p(H),Oe=p(xe),je=p(_e),qe=p(B),Ee=p(we),$e={};$e.createIndex=(0,e.toPromise)(function(n,t){if("object"!=typeof n)return t(new Error("you must provide an index to create"));((0,e.isRemote)(this)?a:be)(this,n,t)}),$e.find=(0,e.toPromise)(function(n,t){if(void 0===t&&(t=n,n=void 0),"object"!=typeof n)return t(new Error("you must provide search parameters to find()"));((0,e.isRemote)(this)?f:Oe)(this,n,t)}),$e.explain=(0,e.toPromise)(function(n,t){if(void 0===t&&(t=n,n=void 0),"object"!=typeof n)return t(new Error("you must provide search parameters to explain()"));((0,e.isRemote)(this)?l:je)(this,n,t)}),$e.getIndexes=(0,e.toPromise)(function(n){((0,e.isRemote)(this)?y:qe)(this,n)}),$e.deleteIndex=(0,e.toPromise)(function(n,t){if("object"!=typeof n)return t(new Error("you must provide an index to delete"));((0,e.isRemote)(this)?v:Ee)(this,n,t)});var Me=$e;exports.default=Me;
},{"pouchdb-utils":"alES","pouchdb-errors":"eFvv","pouchdb-fetch":"+SOi","pouchdb-selector-core":"U1U9","pouchdb-abstract-mapreduce":"1Z6H","pouchdb-collate":"xAsV","pouchdb-md5":"Xfmb"}],"NMrU":[function(require,module,exports) {
var process = require("process");
var t=require("process");try{var n=require("events").EventEmitter;if(!n)throw new Error}catch(s){var r=require("emitter")}var e=void 0!==t&&t&&"function"==typeof t.nextTick?t.nextTick:function(t){setTimeout(t)};function i(){}function o(){if(!(this instanceof o))return new o;this.fns=[],this.concurrency(1/0),this.throws(!0);for(var t=0,n=arguments.length;t<n;++t)this.push(arguments[t])}module.exports=o,n?o.prototype.__proto__=n.prototype:r(o.prototype),o.prototype.concurrency=function(t){return this.n=t,this},o.prototype.push=function(t){return this.fns.push(t),this},o.prototype.throws=function(t){return this.e=!!t,this},o.prototype.end=function(t){var n,r=this,o=this.fns.length,u=o,c=[],h=[],f=(t=t||i,this.fns),p=this.n,a=this.e,v=0;if(!f.length)return e(function(){t(null,c)});function l(){var i=v++,p=f[i];if(p){var y=new Date;try{p(d)}catch(s){d(s)}}function d(s,f){if(!n){if(s&&a)return n=!0,e(function(){t(s)});var p=o-u+1,v=new Date;c[i]=f,h[i]=s,r.emit("progress",{index:i,value:f,error:s,pending:u,total:o,complete:p,percent:p/o*100|0,start:y,end:v,duration:v-y}),--u?l():e(function(){t(a?null:h,c)})}}}for(var y=0;y<f.length&&y!=p;y++)l();return this};
},{"events":"wIHY","emitter":"wIHY","process":"g5I+"}],"vHKL":[function(require,module,exports) {
var r=function(r,n){return r.put(n).then(function(r){return{updated:!0,rev:r.rev,id:n._id}},function(e){if(409!==e.status)throw e;return t(r,n._id,n)})},t=function(t,n,e){if("string"!=typeof n)throw new Error("doc id is required");return t.get(n).catch(function(r){if(404!==r.status)throw r;return{}}).then(function(u){var i=u._rev;return e._id=n,e._rev=i,r(t,e)})};module.exports.upsert=t;
},{}],"k682":[function(require,module,exports) {
"use strict";var e=r(require("@babel/runtime/regenerator")),t=r(require("@babel/runtime/helpers/asyncToGenerator")),n=r(require("@babel/runtime/helpers/objectSpread"));function r(e){return e&&e.__esModule?e:{default:e}}var a="";a="https://api.cd.italia.it/api/v1";var o=function(){var e=window.localStorage.getItem("serviceEndpoint");return e||a};module.exports.getUrl=o;var u=function(e){return{headers:{"Content-Type":"application/json","Ocp-Apim-Subscription-Key":e||localStorage.getItem("serviceKey")}}};module.exports.DEFAULT_URL=a;var s=function r(a){var s=a.dbName,i=a.url,d=a.path,p=a.options;return fetch("".concat(i||o(),"/").concat(d),(0,n.default)({},u(s),p,{method:"GET"})).then(function(e){return e.json()}).then(function(n){return 429===n.statusCode?new Promise(function(a){setTimeout((0,t.default)(e.default.mark(function t(){var n;return e.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({dbName:s,url:i,path:d,options:p});case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}},t,this)})),c(n.message))}):n})};module.exports.get=s;var i=function r(a){var s=a.dbName,i=a.url,d=a.path,p=a.options;return fetch("".concat(i||o(),"/").concat(d),(0,n.default)({},u(s),p,{method:"POST",body:JSON.stringify(p.body)})).then(function(e){return e.json()}).then(function(n){return 429===n.statusCode?new Promise(function(a){setTimeout((0,t.default)(e.default.mark(function t(){var n;return e.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({dbName:s,url:i,path:d,options:p});case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}},t,this)})),c(n.message))}):n})};module.exports.post=i;var c=function(e){var t=e.match(/\d+ seconds/g)[0].match(/\d+/)[0];return isFinite(t)?1e3*t:1e3};
},{"@babel/runtime/regenerator":"8m4e","@babel/runtime/helpers/asyncToGenerator":"2fws","@babel/runtime/helpers/objectSpread":"HEvq"}],"AltX":[function(require,module,exports) {
"use strict";var e=i(require("@babel/runtime/regenerator")),r=i(require("@babel/runtime/helpers/objectSpread")),t=i(require("@babel/runtime/helpers/asyncToGenerator")),n=i(require("pouchdb-browser")),a=i(require("pouchdb-find")),u=i(require("batch")),s=require("../utils/db"),c=require("../utils/api");function i(e){return e&&e.__esModule?e:{default:e}}n.default.plugin(a.default),self.addEventListener("message",function(){var a=(0,t.default)(e.default.mark(function a(i){var o,d,f,l,p,b;return e.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i){a.next=2;break}return a.abrupt("return");case 2:return o=i.data,o.action,d=o.dbName,f=o.url,l=new n.default(d),a.next=6,l.find({selector:{type:"message",status:{$nin:["FAILED","NOTSENT"]},retrieved:{$ne:!0}}});case 6:p=a.sent,(b=new u.default).concurrency(1),b.on("progress",function(e){}),p.docs.forEach(function(n){b.push(function(){var a=(0,t.default)(e.default.mark(function t(a){var u,i,o,p,b;return e.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.message,i=u.id,o=u.fiscal_code,p="messages/".concat(o,"/").concat(i),e.next=4,(0,c.get)({dbName:d,url:f,path:p});case 4:if(!(b=e.sent).statusCode){e.next=9;break}console.error(i),e.next=12;break;case 9:return e.next=11,(0,s.upsert)(l,n._id,(0,r.default)({},n,b,{retrieved:!0}));case 11:e.sent;case 12:a();case 13:case"end":return e.stop()}},t,this)}));return function(e){return a.apply(this,arguments)}}())}),b.end(function(e,t){e||postMessage((0,r.default)({},i.data,{completed:!0}))});case 12:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}());
},{"@babel/runtime/regenerator":"8m4e","@babel/runtime/helpers/objectSpread":"HEvq","@babel/runtime/helpers/asyncToGenerator":"2fws","pouchdb-browser":"v5fJ","pouchdb-find":"3+KE","batch":"NMrU","../utils/db":"vHKL","../utils/api":"k682"}]},{},["AltX"], null)
//# sourceMappingURL=getMessage.c8fac2f6.map